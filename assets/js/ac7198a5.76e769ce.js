"use strict";(self.webpackChunknpipeline=self.webpackChunknpipeline||[]).push([[9826],{1862:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"architecture/design-principles","title":"Design Principles","description":"Core principles guiding NPipeline\'s architecture.","source":"@site/docs/architecture/design-principles.md","sourceDirName":"architecture","slug":"/architecture/design-principles","permalink":"/docs/architecture/design-principles","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"title":"Design Principles","description":"Core principles guiding NPipeline\'s architecture.","sidebar_position":10},"sidebar":"docsSidebar","previous":{"title":"Extension Points","permalink":"/docs/architecture/extension-points"},"next":{"title":"Optimization Principles - How NPipeline Achieves High Performance","permalink":"/docs/architecture/optimization-principles"}}');var s=i(4848),t=i(8453);const a={title:"Design Principles",description:"Core principles guiding NPipeline's architecture.",sidebar_position:10},l="Design Principles",o={},d=[{value:"1. Separation of Concerns",id:"1-separation-of-concerns",level:2},{value:"2. Lazy Evaluation",id:"2-lazy-evaluation",level:2},{value:"3. Streaming First",id:"3-streaming-first",level:2},{value:"4. Composability",id:"4-composability",level:2},{value:"5. Testability",id:"5-testability",level:2},{value:"6. Observability",id:"6-observability",level:2},{value:"Design Trade-offs",id:"design-trade-offs",level:2},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"design-principles",children:"Design Principles"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"This page explains WHY NPipeline is designed the way it is."})," For HOW TO build pipelines using these principles, see ",(0,s.jsx)(n.a,{href:"/docs/core-concepts",children:"Core Concepts"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"NPipeline is built on six core principles that guide its design and evolution:"}),"\n",(0,s.jsx)(n.h2,{id:"1-separation-of-concerns",children:"1. Separation of Concerns"}),"\n",(0,s.jsx)(n.p,{children:"Each component has a single, well-defined responsibility:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Nodes"})," handle data transformation logic"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Builders"})," handle pipeline composition"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Runners"})," handle execution"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Context"})," handles state management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Observability"})," handles diagnostics"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"// Good: Each node focused on one thing\r\n.AddSourceNode<CustomerSourceNode>()      // Only reads from database\r\n.AddTransformNode<ValidationTransform>()  // Only validates\r\n.AddTransformNode<EnrichmentTransform>()  // Only enriches\r\n.AddSinkNode<AuditLogSink>()              // Only logs\n"})}),"\n",(0,s.jsx)(n.p,{children:"This makes nodes testable, reusable, and easy to understand."}),"\n",(0,s.jsx)(n.h2,{id:"2-lazy-evaluation",children:"2. Lazy Evaluation"}),"\n",(0,s.jsx)(n.p,{children:"Data is only processed when explicitly consumed:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"var pipe = await source.Initialize(context, cancellationToken);\r\n// No processing happens here - pipe exists but empty\r\n\r\nvar wrappedPipe = new TransformPipe(pipe, transform);\r\n// Still no processing\r\n\r\nawait foreach (var item in wrappedPipe) // Processing happens HERE\r\n{\r\n    // Items flow through now\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Benefits:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Memory efficient - only what's needed stays in memory"}),"\n",(0,s.jsx)(n.li,{children:"Responsive - results available immediately"}),"\n",(0,s.jsx)(n.li,{children:"Cancellable - can stop at any point without wasting computation"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"3-streaming-first",children:"3. Streaming First"}),"\n",(0,s.jsx)(n.p,{children:"NPipeline treats all data as streams, not arrays:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"// :x: Wrong - breaks streaming model\r\npublic async IAsyncEnumerable<Output> ProcessAsync(...)\r\n{\r\n    var allItems = await _source.ToListAsync(); // Materializes!\r\n    foreach (var item in allItems)\r\n    {\r\n        yield return item;\r\n    }\r\n}\r\n\r\n// :heavy_check_mark: Right - maintains streaming model\r\npublic async IAsyncEnumerable<Output> ProcessAsync(...)\r\n{\r\n    await foreach (var item in _source)\r\n    {\r\n        yield return ProcessItem(item);\r\n    }\r\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["All data flows as ",(0,s.jsx)(n.code,{children:"IAsyncEnumerable<T>"}),", enabling true streaming composition."]}),"\n",(0,s.jsx)(n.h2,{id:"4-composability",children:"4. Composability"}),"\n",(0,s.jsx)(n.p,{children:"Complex pipelines are built by composing simple, focused nodes:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"// Start simple\r\nvar pipeline = PipelineBuilder\r\n    .AddSourceNode<SourceNode>()\r\n    .AddTransformNode<TransformNode>()\r\n    .AddSinkNode<SinkNode>()\r\n    .BuildPipeline();\r\n\r\n// Extend by adding more nodes\r\nvar extendedPipeline = PipelineBuilder\r\n    .AddSourceNode<SourceNode>()\r\n    .AddTransformNode<ValidationNode>()     // New validation step\r\n    .AddTransformNode<EnrichmentNode>()     // New enrichment step\r\n    .AddTransformNode<TransformNode>()      // Original transform\r\n    .AddSinkNode<SinkNode>()\r\n    .BuildPipeline();\n"})}),"\n",(0,s.jsx)(n.p,{children:"Each node remains simple; complexity emerges from composition."}),"\n",(0,s.jsx)(n.h2,{id:"5-testability",children:"5. Testability"}),"\n",(0,s.jsx)(n.p,{children:"Nodes are designed to be testable in isolation:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"// Nodes are testable without a full pipeline\r\n[Fact]\r\npublic async Task Transform_ValidInput_ProducesCorrectOutput()\r\n{\r\n    // Arrange\r\n    var transform = new OrderValidationTransform();\r\n    var testInput = new Order { Amount = 100 };\r\n\r\n    // Act\r\n    var results = new List<ValidatedOrder>();\r\n    await foreach (var result in transform.ProcessAsync(testInput, CancellationToken.None))\r\n    {\r\n        results.Add(result);\r\n    }\r\n\r\n    // Assert\r\n    Assert.Single(results);\r\n    Assert.True(results[0].IsValid);\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"No mocking pipelines or runners needed - test the node directly."}),"\n",(0,s.jsx)(n.h2,{id:"6-observability",children:"6. Observability"}),"\n",(0,s.jsx)(n.p,{children:"Built-in diagnostics for understanding and troubleshooting:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'// Track execution\r\nvar context = PipelineContext.Default;\r\ncontext.StartTracking();\r\n\r\nawait runner.ExecuteAsync(pipeline, context);\r\n\r\nvar stats = context.GetExecutionStatistics();\r\nConsole.WriteLine($"Items processed: {stats.ItemsProcessed}");\r\nConsole.WriteLine($"Processing time: {stats.TotalTime}");\r\nConsole.WriteLine($"Items per second: {stats.Throughput}");\r\n\r\n// Access lineage for debugging\r\nvar lineage = context.Lineage.Items;\r\nforeach (var item in lineage)\r\n{\r\n    Console.WriteLine($"Processed by: {item.NodeName}");\r\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"No external logging frameworks needed for core diagnostics."}),"\n",(0,s.jsx)(n.h2,{id:"design-trade-offs",children:"Design Trade-offs"}),"\n",(0,s.jsx)(n.p,{children:"These principles guide decisions when trade-offs arise:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Trade-off"}),(0,s.jsx)(n.th,{children:"Principle"}),(0,s.jsx)(n.th,{children:"Decision"}),(0,s.jsx)(n.th,{children:"Reason"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Memory vs Latency"}),(0,s.jsx)(n.td,{children:"Streaming First"}),(0,s.jsx)(n.td,{children:"Stream items immediately"}),(0,s.jsx)(n.td,{children:"Responsive to user, better memory profile"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Composition vs Simplicity"}),(0,s.jsx)(n.td,{children:"Composability"}),(0,s.jsx)(n.td,{children:"Allow many nodes"}),(0,s.jsx)(n.td,{children:"Flexibility pays for itself in reuse"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Strictness vs Flexibility"}),(0,s.jsx)(n.td,{children:"Separation of Concerns"}),(0,s.jsx)(n.td,{children:"Strict node contracts"}),(0,s.jsx)(n.td,{children:"Enables testing and optimization"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Features vs Performance"}),(0,s.jsx)(n.td,{children:"Lazy Evaluation"}),(0,s.jsx)(n.td,{children:"Don't materialize"}),(0,s.jsx)(n.td,{children:"Supports large datasets"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Review ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/docs/architecture/core-concepts",children:"Core Concepts"})})," to understand fundamentals"]}),"\n",(0,s.jsxs)(n.li,{children:["Explore ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/docs/architecture/extension-points",children:"Extension Points"})})," to build custom components"]}),"\n",(0,s.jsxs)(n.li,{children:["Start with ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/docs/getting-started/quick-start",children:"Getting Started - Quick Start"})})]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>l});var r=i(6540);const s={},t=r.createContext(s);function a(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);