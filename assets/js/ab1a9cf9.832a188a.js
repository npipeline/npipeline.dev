"use strict";(self.webpackChunknpipeline=self.webpackChunknpipeline||[]).push([[4203],{28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>o});var r=i(96540);const s={},t=r.createContext(s);function a(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(t.Provider,{value:n},e.children)}},72957:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"analyzers/data-processing","title":"Data Processing Analyzers","description":"Ensure proper input consumption and streaming patterns in pipeline nodes.","source":"@site/docs/analyzers/data-processing.md","sourceDirName":"analyzers","slug":"/analyzers/data-processing","permalink":"/docs/analyzers/data-processing","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Data Processing Analyzers","description":"Ensure proper input consumption and streaming patterns in pipeline nodes.","sidebar_position":4},"sidebar":"docsSidebar","previous":{"title":"Reliability Analyzers","permalink":"/docs/analyzers/reliability"},"next":{"title":"Best Practice Analyzers","permalink":"/docs/analyzers/best-practices"}}');var s=i(74848),t=i(28453);const a={title:"Data Processing Analyzers",description:"Ensure proper input consumption and streaming patterns in pipeline nodes.",sidebar_position:4},o=void 0,l={},c=[{value:"Data Processing Analyzers",id:"data-processing-analyzers",level:2},{value:"NP9205: Non-Streaming Patterns in SourceNode",id:"np9205-non-streaming-patterns-in-sourcenode",level:3},{value:"Performance Impact",id:"performance-impact",level:4},{value:"Solution: Use Streaming Patterns",id:"solution-use-streaming-patterns",level:4},{value:"NP9302: Input Parameter Not Consumed",id:"np9302-input-parameter-not-consumed",level:3},{value:"Why This Matters",id:"why-this-matters",level:4},{value:"Solution: Always Consume Input",id:"solution-always-consume-input",level:4},{value:"Configuration",id:"configuration",level:2},{value:"See Also",id:"see-also",level:2}];function d(e){const n={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"data-processing-analyzers",children:"Data Processing Analyzers"}),"\n",(0,s.jsx)(n.p,{children:"Data processing analyzers protect the integrity of data flow through your pipelines. They detect patterns that cause data loss, memory bloat, or improper stream handling."}),"\n",(0,s.jsx)(n.h3,{id:"np9205-non-streaming-patterns-in-sourcenode",children:"NP9205: Non-Streaming Patterns in SourceNode"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"ID:"})," ",(0,s.jsx)(n.code,{children:"NP9205"}),"\n",(0,s.jsx)(n.strong,{children:"Severity:"})," Warning",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Category:"})," Performance"]}),"\n",(0,s.jsx)(n.p,{children:"This analyzer detects non-streaming patterns in SourceNode implementations that can lead to memory issues and poor performance. The analyzer identifies the following problematic patterns:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"List and Array allocation and population"})," in Initialize methods"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:".ToAsyncEnumerable()"})," calls on materialized collections"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Synchronous I/O operations"})," like File.ReadAllText, File.WriteAllBytes, etc."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:".ToList() and .ToArray()"})," calls that materialize collections in memory"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"performance-impact",children:"Performance Impact"}),"\n",(0,s.jsx)(n.p,{children:"Non-streaming patterns in SourceNode implementations cause:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"High Memory Usage"}),": Loading entire datasets into memory can cause OutOfMemoryException with large files"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Poor Startup Performance"}),": Applications must wait for all data to be loaded before processing begins"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Increased GC Pressure"}),": Large collections create more garbage collection work"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Reduced Scalability"}),": Memory requirements grow linearly with data size"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Blocking I/O"}),": Synchronous operations block threads and reduce throughput"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"solution-use-streaming-patterns",children:"Solution: Use Streaming Patterns"}),"\n",(0,s.jsx)(n.p,{children:"For SourceNode implementations, use IAsyncEnumerable with yield return for proper streaming:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'// CORRECT: Using IAsyncEnumerable with yield return\npublic class GoodSourceNode : SourceNode<string>\n{\n    public override IDataPipe<string> Initialize(PipelineContext context, CancellationToken cancellationToken)\n    {\n        return new StreamingDataPipe<string>(ReadLines("large-file.txt", cancellationToken));\n    }\n    \n    // Helper method that yields lines one at a time\n    private async IAsyncEnumerable<string> ReadLines(string filePath, [EnumeratorCancellation] CancellationToken cancellationToken)\n    {\n        using var reader = new StreamReader(\n            new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read, bufferSize: 4096, useAsync: true));\n        \n        string? line;\n        while ((line = await reader.ReadLineAsync()) != null)\n        {\n            cancellationToken.ThrowIfCancellationRequested();\n            yield return line;\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"np9302-input-parameter-not-consumed",children:"NP9302: Input Parameter Not Consumed"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"ID:"})," ",(0,s.jsx)(n.code,{children:"NP9302"}),"\n",(0,s.jsx)(n.strong,{children:"Severity:"})," Error",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Category:"})," Data Processing"]}),"\n",(0,s.jsx)(n.p,{children:"This analyzer detects when a SinkNode implementation overrides ExecuteAsync but doesn't consume the input parameter. Sink nodes are designed to process all items from the input data pipe, but your implementation ignores the input."}),"\n",(0,s.jsx)(n.h4,{id:"why-this-matters",children:"Why This Matters"}),"\n",(0,s.jsx)(n.p,{children:"SinkNode is the terminal component in a pipeline that processes all data flowing through it. When a SinkNode doesn't consume its input:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Data Loss"}),": Items in the input pipe are never processed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Pipeline Inefficiency"}),": The pipeline moves data but the sink doesn't handle it"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Resource Waste"}),": Memory and processing are used to move data that's never consumed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Unexpected Behavior"}),": Applications may appear to work but silently ignore data"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"solution-always-consume-input",children:"Solution: Always Consume Input"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'// CORRECT: Process all items from input\npublic class MySinkNode : SinkNode<string>\n{\n    public override async Task ExecuteAsync(IDataPipe<string> input, PipelineContext context, CancellationToken cancellationToken)\n    {\n        await foreach (var item in input.WithCancellation(cancellationToken))\n        {\n            Console.WriteLine($"Processing: {item}");\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["Adjust analyzer severity in ",(0,s.jsx)(n.code,{children:".editorconfig"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"# Treat non-streaming patterns as errors\ndotnet_diagnostic.NP9205.severity = error\n\n# Treat unconsumed input as errors\ndotnet_diagnostic.NP9302.severity = error\n"})}),"\n",(0,s.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../../core-concepts/streaming-vs-buffering",children:"Streaming vs Buffering"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../../core-concepts/data-pipes",children:"Data Pipes"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../../architecture/performance-characteristics",children:"Performance Characteristics"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);