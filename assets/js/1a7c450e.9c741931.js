"use strict";(self.webpackChunknpipeline=self.webpackChunknpipeline||[]).push([[6831],{22450:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>g,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"extensions/lineage/configuration","title":"Lineage Configuration","description":"Detailed guide to configuring NPipeline Lineage extension with sampling, redaction, and overflow policies.","source":"@site/docs/extensions/lineage/configuration.md","sourceDirName":"extensions/lineage","slug":"/extensions/lineage/configuration","permalink":"/docs/extensions/lineage/configuration","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Lineage Configuration","description":"Detailed guide to configuring NPipeline Lineage extension with sampling, redaction, and overflow policies."},"sidebar":"docsSidebar","previous":{"title":"Lineage Architecture","permalink":"/docs/extensions/lineage/architecture"},"next":{"title":"Getting Started with Lineage","permalink":"/docs/extensions/lineage/getting-started"}}');var l=i(74848),a=i(28453);const r={title:"Lineage Configuration",description:"Detailed guide to configuring NPipeline Lineage extension with sampling, redaction, and overflow policies."},t="Lineage Configuration",o={},c=[{value:"LineageOptions",id:"lineageoptions",level:2},{value:"Sampling Configuration",id:"sampling-configuration",level:2},{value:"Deterministic Sampling",id:"deterministic-sampling",level:3},{value:"Random Sampling",id:"random-sampling",level:3},{value:"Sampling Rate Guidelines",id:"sampling-rate-guidelines",level:3},{value:"Data Redaction",id:"data-redaction",level:2},{value:"Overflow Policies",id:"overflow-policies",level:2},{value:"Materialization Cap",id:"materialization-cap",level:3},{value:"Overflow Policy Options",id:"overflow-policy-options",level:3},{value:"Materialize",id:"materialize",level:4},{value:"Degrade (Default)",id:"degrade-default",level:4},{value:"Drop",id:"drop",level:4},{value:"Choosing an Overflow Policy",id:"choosing-an-overflow-policy",level:3},{value:"Custom Sink Registration",id:"custom-sink-registration",level:2},{value:"Built-in Logging Sink",id:"built-in-logging-sink",level:3},{value:"Custom ILineageSink",id:"custom-ilineagesink",level:3},{value:"Custom IPipelineLineageSink",id:"custom-ipipelinelineagesink",level:3},{value:"Register Custom Sinks via DI",id:"register-custom-sinks-via-di",level:3},{value:"Dependency Injection Configuration",id:"dependency-injection-configuration",level:2},{value:"Default Registration",id:"default-registration",level:3},{value:"Custom Sink Registration",id:"custom-sink-registration-1",level:3},{value:"Factory-Based Registration",id:"factory-based-registration",level:3},{value:"Custom Collector Registration",id:"custom-collector-registration",level:3},{value:"Configuration Examples",id:"configuration-examples",level:2},{value:"Production-Ready Configuration",id:"production-ready-configuration",level:3},{value:"Development Configuration",id:"development-configuration",level:3},{value:"High-Volume Monitoring Configuration",id:"high-volume-monitoring-configuration",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Start with Conservative Sampling",id:"1-start-with-conservative-sampling",level:3},{value:"2. Use Deterministic Sampling for Debugging",id:"2-use-deterministic-sampling-for-debugging",level:3},{value:"3. Enable Redaction for Sensitive Data",id:"3-enable-redaction-for-sensitive-data",level:3},{value:"4. Use Degrade Policy in Production",id:"4-use-degrade-policy-in-production",level:3},{value:"5. Implement Async Sinks",id:"5-implement-async-sinks",level:3},{value:"Related Topics",id:"related-topics",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"lineage-configuration",children:"Lineage Configuration"})}),"\n",(0,l.jsx)(n.p,{children:"This guide covers all configuration options for the NPipeline Lineage extension, including sampling strategies, data redaction, overflow policies, and custom sink registration."}),"\n",(0,l.jsx)(n.h2,{id:"lineageoptions",children:"LineageOptions"}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.a,{href:"../../../src/NPipeline.Extensions.Lineage/LineageOptions.cs",children:(0,l.jsx)(n.code,{children:"LineageOptions"})})," class controls item-level lineage tracking behavior:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"public sealed record LineageOptions\n{\n    /// Sample every Nth item (1 = sample all items)\n    int SampleEvery { get; init; } = 1;\n    \n    /// Use deterministic (hash-based) sampling vs random sampling\n    bool DeterministicSampling { get; init; } = true;\n    \n    /// Redact actual data from lineage records (store only metadata)\n    bool RedactData { get; init; } = false;\n    \n    /// Maximum number of items to materialize in memory\n    int MaterializationCap { get; init; } = 10000;\n    \n    /// Behavior when materialization cap is reached\n    LineageOverflowPolicy OverflowPolicy { get; init; } = LineageOverflowPolicy.Degrade;\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"sampling-configuration",children:"Sampling Configuration"}),"\n",(0,l.jsx)(n.h3,{id:"deterministic-sampling",children:"Deterministic Sampling"}),"\n",(0,l.jsx)(n.p,{children:"Deterministic sampling uses a hash-based approach to select items consistently across runs:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"builder.EnableItemLevelLineage(options =>\n{\n    options.SampleEvery = 100;  // Sample 1% of items\n    options.DeterministicSampling = true;\n});\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Debugging specific issues (same items sampled across runs)"}),"\n",(0,l.jsx)(n.li,{children:"Compliance scenarios requiring consistent tracking"}),"\n",(0,l.jsx)(n.li,{children:"Reproducible testing"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"How It Works:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Computes hash of item's lineage ID"}),"\n",(0,l.jsx)(n.li,{children:"Items with hash % SampleEvery == 0 are sampled"}),"\n",(0,l.jsx)(n.li,{children:"Same items always selected across multiple runs"}),"\n",(0,l.jsx)(n.li,{children:"Provides predictable, repeatable behavior"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"random-sampling",children:"Random Sampling"}),"\n",(0,l.jsx)(n.p,{children:"Random sampling selects items at the specified rate without consistency across runs:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"builder.EnableItemLevelLineage(options =>\n{\n    options.SampleEvery = 100;  // Sample 1% of items\n    options.DeterministicSampling = false;\n});\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Monitoring and analytics (representative samples)"}),"\n",(0,l.jsx)(n.li,{children:"High-volume pipelines where consistency isn't required"}),"\n",(0,l.jsx)(n.li,{children:"Reducing overhead with minimal bias"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"How It Works:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Uses random number generator for each item"}),"\n",(0,l.jsx)(n.li,{children:"Items selected with probability 1/SampleEvery"}),"\n",(0,l.jsx)(n.li,{children:"Different items may be sampled across runs"}),"\n",(0,l.jsx)(n.li,{children:"Provides statistically representative samples"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"sampling-rate-guidelines",children:"Sampling Rate Guidelines"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Scenario"}),(0,l.jsx)(n.th,{children:"Recommended Rate"}),(0,l.jsx)(n.th,{children:"Reasoning"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Production compliance"}),(0,l.jsx)(n.td,{children:"100% (SampleEvery = 1)"}),(0,l.jsx)(n.td,{children:"Complete audit trails required"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Production monitoring"}),(0,l.jsx)(n.td,{children:"1-10% (SampleEvery = 10-100)"}),(0,l.jsx)(n.td,{children:"Balance visibility and overhead"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Development/debugging"}),(0,l.jsx)(n.td,{children:"10-50% (SampleEvery = 2-10)"}),(0,l.jsx)(n.td,{children:"Good visibility with manageable overhead"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"High-volume analytics"}),(0,l.jsx)(n.td,{children:"0.1-1% (SampleEvery = 100-1000)"}),(0,l.jsx)(n.td,{children:"Representative samples, minimal overhead"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"data-redaction",children:"Data Redaction"}),"\n",(0,l.jsx)(n.p,{children:"Redaction excludes actual data from lineage records, storing only metadata:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"builder.EnableItemLevelLineage(options =>\n{\n    options.RedactData = true;\n});\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Sensitive data (PII, financial data, health records)"}),"\n",(0,l.jsx)(n.li,{children:"Large data objects (reduces memory usage)"}),"\n",(0,l.jsx)(n.li,{children:"Focus on flow patterns rather than data values"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Impact:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"LineageInfo.Data"})," field will be ",(0,l.jsx)(n.code,{children:"null"})]}),"\n",(0,l.jsx)(n.li,{children:"All other lineage metadata preserved"}),"\n",(0,l.jsx)(n.li,{children:"Reduces memory usage by not storing actual data"}),"\n",(0,l.jsx)(n.li,{children:"No impact on tracking accuracy"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"// Without redaction\nvar lineageInfo = collector.GetLineageInfo(lineageId);\nConsole.WriteLine(lineageInfo.Data);  // Outputs actual data\n\n// With redaction\nvar lineageInfo = collector.GetLineageInfo(lineageId);\nConsole.WriteLine(lineageInfo.Data);  // Outputs: null\nConsole.WriteLine(lineageInfo.LineageId);  // Still available\nConsole.WriteLine(lineageInfo.TraversalPath);  // Still available\n"})}),"\n",(0,l.jsx)(n.h2,{id:"overflow-policies",children:"Overflow Policies"}),"\n",(0,l.jsx)(n.p,{children:"Overflow policies control behavior when the materialization cap is reached:"}),"\n",(0,l.jsx)(n.h3,{id:"materialization-cap",children:"Materialization Cap"}),"\n",(0,l.jsx)(n.p,{children:"The default cap limits memory usage by materializing only a subset of items:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"builder.EnableItemLevelLineage(options =>\n{\n    options.MaterializationCap = 10000;  // Default\n});\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Adjust Based On:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Available memory"}),"\n",(0,l.jsx)(n.li,{children:"Pipeline throughput"}),"\n",(0,l.jsx)(n.li,{children:"Required visibility"}),"\n",(0,l.jsx)(n.li,{children:"Sampling rate"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"overflow-policy-options",children:"Overflow Policy Options"}),"\n",(0,l.jsx)(n.h4,{id:"materialize",children:"Materialize"}),"\n",(0,l.jsx)(n.p,{children:"Continues collecting all lineage data in memory:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"options.OverflowPolicy = LineageOverflowPolicy.Materialize;\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Characteristics:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"No limit on in-memory lineage storage"}),"\n",(0,l.jsx)(n.li,{children:"Complete lineage visibility"}),"\n",(0,l.jsx)(n.li,{children:"Risk of out-of-memory errors on large datasets"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Development and debugging"}),"\n",(0,l.jsx)(n.li,{children:"Small datasets"}),"\n",(0,l.jsx)(n.li,{children:"Memory-constrained environments with guaranteed capacity"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"degrade-default",children:"Degrade (Default)"}),"\n",(0,l.jsx)(n.p,{children:"Switches to streaming mode when cap is reached:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"options.OverflowPolicy = LineageOverflowPolicy.Degrade;  // Default\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Characteristics:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"New items beyond cap are streamed to sinks"}),"\n",(0,l.jsx)(n.li,{children:"Older items may be removed from in-memory collection"}),"\n",(0,l.jsx)(n.li,{children:"Lineage is complete but older items not queryable"}),"\n",(0,l.jsx)(n.li,{children:"Best balance of visibility and memory safety"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Production pipelines with sampling"}),"\n",(0,l.jsx)(n.li,{children:"Compliance scenarios requiring persistence"}),"\n",(0,l.jsx)(n.li,{children:"Most production use cases"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"drop",children:"Drop"}),"\n",(0,l.jsx)(n.p,{children:"Stops collecting lineage when cap is reached:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"options.OverflowPolicy = LineageOverflowPolicy.Drop;\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Characteristics:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"No lineage for items beyond cap"}),"\n",(0,l.jsx)(n.li,{children:"Minimal memory footprint"}),"\n",(0,l.jsx)(n.li,{children:"Partial visibility"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"High-volume monitoring only"}),"\n",(0,l.jsx)(n.li,{children:"Memory-constrained environments"}),"\n",(0,l.jsx)(n.li,{children:"Scenarios where complete lineage isn't required"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"choosing-an-overflow-policy",children:"Choosing an Overflow Policy"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Scenario"}),(0,l.jsx)(n.th,{children:"Policy"}),(0,l.jsx)(n.th,{children:"Reasoning"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Production pipelines with sampling"}),(0,l.jsx)(n.td,{children:"Degrade"}),(0,l.jsx)(n.td,{children:"Safe default, maintains visibility"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Development/debugging"}),(0,l.jsx)(n.td,{children:"Materialize"}),(0,l.jsx)(n.td,{children:"Complete information useful for investigation"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"High-volume monitoring"}),(0,l.jsx)(n.td,{children:"Drop"}),(0,l.jsx)(n.td,{children:"Prevents memory issues with sampling"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Memory-constrained environments"}),(0,l.jsx)(n.td,{children:"Drop"}),(0,l.jsx)(n.td,{children:"Minimal memory footprint"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Compliance/audit scenarios"}),(0,l.jsx)(n.td,{children:"Degrade"}),(0,l.jsx)(n.td,{children:"Ensures records are persisted to sinks"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"custom-sink-registration",children:"Custom Sink Registration"}),"\n",(0,l.jsx)(n.p,{children:"Register custom lineage sinks to export data to external systems:"}),"\n",(0,l.jsx)(n.h3,{id:"built-in-logging-sink",children:"Built-in Logging Sink"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"builder.UseLoggingPipelineLineageSink();\n"})}),"\n",(0,l.jsx)(n.h3,{id:"custom-ilineagesink",children:"Custom ILineageSink"}),"\n",(0,l.jsx)(n.p,{children:"Implement for item-level lineage export:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'public sealed class DatabaseLineageSink : ILineageSink\n{\n    private readonly IDbConnection _connection;\n\n    public DatabaseLineageSink(IDbConnection connection)\n    {\n        _connection = connection;\n    }\n\n    public async Task RecordAsync(LineageInfo lineageInfo, CancellationToken cancellationToken)\n    {\n        const string sql = @"\n            INSERT INTO Lineage (LineageId, Data, TraversalPath, Timestamp)\n            VALUES (@LineageId, @Data, @TraversalPath, @Timestamp)";\n        \n        await _connection.ExecuteAsync(sql, new\n        {\n            LineageId = lineageInfo.LineageId,\n            Data = lineageInfo.Data?.ToString(),\n            TraversalPath = string.Join(",", lineageInfo.TraversalPath),\n            Timestamp = DateTime.UtcNow\n        }, cancellationToken);\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"custom-ipipelinelineagesink",children:"Custom IPipelineLineageSink"}),"\n",(0,l.jsx)(n.p,{children:"Implement for pipeline-level lineage export:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"public sealed class JsonFileLineageSink : IPipelineLineageSink\n{\n    private readonly string _filePath;\n\n    public JsonFileLineageSink(string filePath)\n    {\n        _filePath = filePath;\n    }\n\n    public async Task RecordAsync(PipelineLineageReport report, CancellationToken cancellationToken)\n    {\n        var json = JsonSerializer.Serialize(report, new JsonSerializerOptions\n        {\n            WriteIndented = true\n        });\n        \n        await File.WriteAllTextAsync(_filePath, json, cancellationToken);\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"register-custom-sinks-via-di",children:"Register Custom Sinks via DI"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:'// Register with custom sink type\nservices.AddNPipelineLineage<DatabaseLineageSink>();\n\n// Register with factory delegate\nservices.AddNPipelineLineage(sp =>\n{\n    var connectionString = sp.GetRequiredService<IConfiguration>()["ConnectionStrings:Lineage"];\n    var connection = new SqlConnection(connectionString);\n    return new DatabaseLineageSink(connection);\n});\n\n// Register both item and pipeline sinks\nservices.AddNPipelineLineage<DatabaseLineageSink, JsonFileLineageSink>();\n'})}),"\n",(0,l.jsx)(n.h2,{id:"dependency-injection-configuration",children:"Dependency Injection Configuration"}),"\n",(0,l.jsx)(n.h3,{id:"default-registration",children:"Default Registration"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"services.AddNPipelineLineage();\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Registers:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ILineageCollector"})," (scoped)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ILineageSink"})," \u2192 ",(0,l.jsx)(n.code,{children:"LoggingPipelineLineageSink"})," (transient)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"IPipelineLineageSink"})," \u2192 ",(0,l.jsx)(n.code,{children:"LoggingPipelineLineageSink"})," (transient)"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"custom-sink-registration-1",children:"Custom Sink Registration"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"services.AddNPipelineLineage<CustomLineageSink>();\n"})}),"\n",(0,l.jsx)(n.h3,{id:"factory-based-registration",children:"Factory-Based Registration"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"services.AddNPipelineLineage(sp =>\n{\n    var logger = sp.GetRequiredService<ILogger<CustomLineageSink>>();\n    var config = sp.GetRequiredService<IConfiguration>();\n    return new CustomLineageSink(logger, config);\n});\n"})}),"\n",(0,l.jsx)(n.h3,{id:"custom-collector-registration",children:"Custom Collector Registration"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"services.AddNPipelineLineage<CustomCollector, LoggingPipelineLineageSink, LoggingPipelineLineageSink>();\n"})}),"\n",(0,l.jsx)(n.h2,{id:"configuration-examples",children:"Configuration Examples"}),"\n",(0,l.jsx)(n.h3,{id:"production-ready-configuration",children:"Production-Ready Configuration"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"services.AddNPipelineLineage<DatabaseLineageSink, JsonFileLineageSink>();\n\n// In pipeline\nbuilder.EnableItemLevelLineage(options =>\n{\n    options.SampleEvery = 100;  // 1% sampling\n    options.DeterministicSampling = true;\n    options.RedactData = true;  // Don't store sensitive data\n    options.MaterializationCap = 10000;\n    options.OverflowPolicy = LineageOverflowPolicy.Degrade;\n});\n"})}),"\n",(0,l.jsx)(n.h3,{id:"development-configuration",children:"Development Configuration"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"services.AddNPipelineLineage();  // Use logging sink\n\n// In pipeline\nbuilder.EnableItemLevelLineage(options =>\n{\n    options.SampleEvery = 1;  // Track everything\n    options.DeterministicSampling = true;\n    options.RedactData = false;  // Keep data for debugging\n    options.MaterializationCap = int.MaxValue;  // No cap\n    options.OverflowPolicy = LineageOverflowPolicy.Materialize;\n});\n"})}),"\n",(0,l.jsx)(n.h3,{id:"high-volume-monitoring-configuration",children:"High-Volume Monitoring Configuration"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"services.AddNPipelineLineage<PrometheusLineageSink>();\n\n// In pipeline\nbuilder.EnableItemLevelLineage(options =>\n{\n    options.SampleEvery = 1000;  // 0.1% sampling\n    options.DeterministicSampling = false;  // Random sampling\n    options.RedactData = true;  // Minimal memory\n    options.MaterializationCap = 1000;  // Small cap\n    options.OverflowPolicy = LineageOverflowPolicy.Drop;  // Drop excess\n});\n"})}),"\n",(0,l.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,l.jsx)(n.h3,{id:"1-start-with-conservative-sampling",children:"1. Start with Conservative Sampling"}),"\n",(0,l.jsx)(n.p,{children:"Begin with 1-10% sampling in production:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"options.SampleEvery = 100;  // Conservative start\n"})}),"\n",(0,l.jsx)(n.p,{children:"Adjust based on requirements and performance impact."}),"\n",(0,l.jsx)(n.h3,{id:"2-use-deterministic-sampling-for-debugging",children:"2. Use Deterministic Sampling for Debugging"}),"\n",(0,l.jsx)(n.p,{children:"When investigating specific issues:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"options.DeterministicSampling = true;\noptions.SampleEvery = 1;  // Track all items temporarily\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-enable-redaction-for-sensitive-data",children:"3. Enable Redaction for Sensitive Data"}),"\n",(0,l.jsx)(n.p,{children:"Always redact PII, financial data, or health records:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"options.RedactData = true;\n"})}),"\n",(0,l.jsx)(n.h3,{id:"4-use-degrade-policy-in-production",children:"4. Use Degrade Policy in Production"}),"\n",(0,l.jsx)(n.p,{children:"Default policy provides best balance:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"options.OverflowPolicy = LineageOverflowPolicy.Degrade;\n"})}),"\n",(0,l.jsx)(n.h3,{id:"5-implement-async-sinks",children:"5. Implement Async Sinks"}),"\n",(0,l.jsx)(n.p,{children:"Use async operations in custom sinks:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-csharp",children:"public async Task RecordAsync(LineageInfo lineageInfo, CancellationToken cancellationToken)\n{\n    await _database.SaveChangesAsync(cancellationToken);\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"/docs/extensions/lineage/getting-started",children:"Getting Started"})})," - Installation and basic setup"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"/docs/extensions/lineage/architecture",children:"Architecture"})})," - Internal architecture and design decisions"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"/docs/extensions/lineage/performance",children:"Performance"})})," - Performance characteristics and optimization"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"/docs/extensions/lineage/use-cases",children:"Use Cases"})})," - Common use cases and examples"]}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>t});var s=i(96540);const l={},a=s.createContext(l);function r(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);