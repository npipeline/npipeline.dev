"use strict";(self.webpackChunknpipeline=self.webpackChunknpipeline||[]).push([[5789],{28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var t=i(96540);const r={},s=t.createContext(r);function o(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(s.Provider,{value:n},e.children)}},34822:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"extensions/composition/context-inheritance","title":"Context Inheritance","description":"Overview","source":"@site/docs/extensions/composition/context-inheritance.md","sourceDirName":"extensions/composition","slug":"/extensions/composition/context-inheritance","permalink":"/docs/extensions/composition/context-inheritance","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Pipeline Composition Extension","permalink":"/docs/extensions/composition/"},"next":{"title":"Error Handling in Composite Pipelines","permalink":"/docs/extensions/composition/error-handling"}}');var r=i(74848),s=i(28453);const o={},a="Context Inheritance",c={},l=[{value:"Overview",id:"overview",level:2},{value:"Context Components",id:"context-components",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Items",id:"items",level:3},{value:"Properties",id:"properties",level:3},{value:"Inheritance Strategies",id:"inheritance-strategies",level:2},{value:"No Inheritance (Default)",id:"no-inheritance-default",level:3},{value:"Full Inheritance",id:"full-inheritance",level:3},{value:"Selective Inheritance",id:"selective-inheritance",level:3},{value:"Custom Configuration with Action",id:"custom-configuration-with-action",level:3},{value:"Isolation and Safety",id:"isolation-and-safety",level:2},{value:"Parent Context is Always Isolated",id:"parent-context-is-always-isolated",level:3},{value:"Sub-Pipeline Gets Copies",id:"sub-pipeline-gets-copies",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Memory Overhead",id:"memory-overhead",level:3},{value:"Copy Timing",id:"copy-timing",level:3},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Pattern 1: Configuration Inheritance",id:"pattern-1-configuration-inheritance",level:3},{value:"Pattern 2: Service Injection",id:"pattern-2-service-injection",level:3},{value:"Pattern 3: Environment Context",id:"pattern-3-environment-context",level:3},{value:"Pattern 4: Isolated Testing",id:"pattern-4-isolated-testing",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Default to No Inheritance",id:"1-default-to-no-inheritance",level:3},{value:"2. Document Dependencies",id:"2-document-dependencies",level:3},{value:"3. Use Type-Safe Accessors",id:"3-use-type-safe-accessors",level:3},{value:"4. Test Both With and Without Inheritance",id:"4-test-both-with-and-without-inheritance",level:3},{value:"5. Avoid Implicit Dependencies",id:"5-avoid-implicit-dependencies",level:3},{value:"Summary",id:"summary",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"context-inheritance",children:"Context Inheritance"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Context inheritance controls what data from the parent pipeline's context is available to sub-pipelines. This is a critical design decision that affects isolation, testability, and behavior of your composite pipelines."}),"\n",(0,r.jsx)(n.h2,{id:"context-components",children:"Context Components"}),"\n",(0,r.jsx)(n.p,{children:"The PipelineContext has three main dictionaries:"}),"\n",(0,r.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(n.p,{children:"Used for pipeline input parameters and configuration:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'context.Parameters["DatabaseConnection"] = connectionString;\ncontext.Parameters["BatchSize"] = 100;\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Typical Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Configuration values"}),"\n",(0,r.jsx)(n.li,{children:"Connection strings"}),"\n",(0,r.jsx)(n.li,{children:"Processing parameters"}),"\n",(0,r.jsx)(n.li,{children:"Input data for composite nodes"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"items",children:"Items"}),"\n",(0,r.jsx)(n.p,{children:"Used for request-scoped state and services:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'context.Items["Logger"] = myLogger;\ncontext.Items["RequestId"] = Guid.NewGuid();\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Typical Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Request-scoped services"}),"\n",(0,r.jsx)(n.li,{children:"Temporary state"}),"\n",(0,r.jsx)(n.li,{children:"Request identifiers"}),"\n",(0,r.jsx)(n.li,{children:"Cross-cutting concerns"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"properties",children:"Properties"}),"\n",(0,r.jsx)(n.p,{children:"Used for metadata and pipeline-level configuration:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'context.Properties["Environment"] = "Production";\ncontext.Properties["Version"] = "1.0.0";\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Typical Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Pipeline metadata"}),"\n",(0,r.jsx)(n.li,{children:"Environment settings"}),"\n",(0,r.jsx)(n.li,{children:"Feature flags"}),"\n",(0,r.jsx)(n.li,{children:"Global configuration"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"inheritance-strategies",children:"Inheritance Strategies"}),"\n",(0,r.jsx)(n.h3,{id:"no-inheritance-default",children:"No Inheritance (Default)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"builder.AddComposite<TIn, TOut, SubPipeline>(\n    contextConfiguration: CompositeContextConfiguration.Default);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sub-pipeline should be completely isolated"}),"\n",(0,r.jsx)(n.li,{children:"Testing sub-pipelines independently"}),"\n",(0,r.jsx)(n.li,{children:"Avoiding unintended dependencies"}),"\n",(0,r.jsx)(n.li,{children:"Maximum modularity"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Characteristics:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sub-pipeline has empty context dictionaries"}),"\n",(0,r.jsx)(n.li,{children:"No parent data accessible"}),"\n",(0,r.jsx)(n.li,{children:"Complete isolation"}),"\n",(0,r.jsx)(n.li,{children:"Easiest to test"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public class StandaloneValidationPipeline : IPipelineDefinition\n{\n    public void Define(PipelineBuilder builder, PipelineContext context)\n    {\n        // This pipeline doesn\'t need any parent context\n        var input = builder.AddSource<PipelineInputSource<Customer>, Customer>("input");\n        var validate = builder.AddTransform<BasicValidator, Customer, ValidatedCustomer>("validate");\n        var output = builder.AddSink<PipelineOutputSink<ValidatedCustomer>, ValidatedCustomer>("output");\n        \n        builder.Connect(input, validate);\n        builder.Connect(validate, output);\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"full-inheritance",children:"Full Inheritance"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"builder.AddComposite<TIn, TOut, SubPipeline>(\n    contextConfiguration: CompositeContextConfiguration.InheritAll);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sub-pipeline needs access to parent configuration"}),"\n",(0,r.jsx)(n.li,{children:"Sharing services across pipeline hierarchy"}),"\n",(0,r.jsx)(n.li,{children:"Consistent environment settings"}),"\n",(0,r.jsx)(n.li,{children:"Logging and tracing integration"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Characteristics:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All parent context data copied to sub-context"}),"\n",(0,r.jsx)(n.li,{children:"Parent context remains isolated from changes"}),"\n",(0,r.jsx)(n.li,{children:"Sub-pipeline can read parent values"}),"\n",(0,r.jsx)(n.li,{children:"More complex testing requirements"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public class ConfigAwareEnrichmentPipeline : IPipelineDefinition\n{\n    public void Define(PipelineBuilder builder, PipelineContext context)\n    {\n        // Access parent configuration\n        var apiKey = context.Parameters["ApiKey"]?.ToString() ?? "";\n        var logger = context.Items["Logger"] as ILogger;\n        \n        var input = builder.AddSource<PipelineInputSource<Customer>, Customer>("input");\n        var enrich = builder.AddTransform<ApiEnricher, Customer, EnrichedCustomer>("enrich");\n        var output = builder.AddSink<PipelineOutputSink<EnrichedCustomer>, EnrichedCustomer>("output");\n        \n        builder.Connect(input, enrich);\n        builder.Connect(enrich, output);\n    }\n}\n\n// Usage in parent\nvar context = new PipelineContext();\ncontext.Parameters["ApiKey"] = "secret-key";\ncontext.Items["Logger"] = myLogger;\n\nbuilder.AddComposite<Customer, EnrichedCustomer, ConfigAwareEnrichmentPipeline>(\n    contextConfiguration: CompositeContextConfiguration.InheritAll);\n'})}),"\n",(0,r.jsx)(n.h3,{id:"selective-inheritance",children:"Selective Inheritance"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"builder.AddComposite<TIn, TOut, SubPipeline>(\n    contextConfiguration: new CompositeContextConfiguration\n    {\n        InheritParentParameters = true,\n        InheritParentItems = false,\n        InheritParentProperties = true\n    });\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Need specific parent data only"}),"\n",(0,r.jsx)(n.li,{children:"Balance between isolation and access"}),"\n",(0,r.jsx)(n.li,{children:"Fine-grained control over dependencies"}),"\n",(0,r.jsx)(n.li,{children:"Performance optimization"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"// Sub-pipeline needs config but not services\nbuilder.AddComposite<Order, ProcessedOrder, OrderProcessingPipeline>(\n    contextConfiguration: new CompositeContextConfiguration\n    {\n        InheritParentParameters = true,  // Config values\n        InheritParentItems = false,      // No services\n        InheritParentProperties = true   // Metadata\n    });\n"})}),"\n",(0,r.jsx)(n.h3,{id:"custom-configuration-with-action",children:"Custom Configuration with Action"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"builder.AddComposite<TIn, TOut, SubPipeline>(\n    configureContext: config =>\n    {\n        config.InheritParentParameters = shouldInheritParams;\n        config.InheritParentItems = shouldInheritItems;\n        config.InheritParentProperties = shouldInheritProps;\n    });\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Dynamic configuration based on conditions"}),"\n",(0,r.jsx)(n.li,{children:"Configuration from external sources"}),"\n",(0,r.jsx)(n.li,{children:"Complex inheritance logic"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'var isDevelopment = Environment.GetEnvironmentVariable("ENVIRONMENT") == "Development";\n\nbuilder.AddComposite<TIn, TOut, SubPipeline>(\n    configureContext: config =>\n    {\n        config.InheritParentParameters = true;\n        config.InheritParentItems = isDevelopment;  // Only in dev\n        config.InheritParentProperties = true;\n    });\n'})}),"\n",(0,r.jsx)(n.h2,{id:"isolation-and-safety",children:"Isolation and Safety"}),"\n",(0,r.jsx)(n.h3,{id:"parent-context-is-always-isolated",children:"Parent Context is Always Isolated"}),"\n",(0,r.jsxs)(n.p,{children:["Changes in sub-pipeline context ",(0,r.jsx)(n.strong,{children:"never"})," affect parent context:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// Parent pipeline\nvar context = new PipelineContext();\ncontext.Parameters["SharedValue"] = "Original";\n\n// Run composite with inheritance\nawait runner.RunAsync<ParentPipeline>(context);\n\n// Parent value unchanged, even if sub-pipeline modified it\nAssert.Equal("Original", context.Parameters["SharedValue"]);\n'})}),"\n",(0,r.jsx)(n.h3,{id:"sub-pipeline-gets-copies",children:"Sub-Pipeline Gets Copies"}),"\n",(0,r.jsxs)(n.p,{children:["When inheritance is enabled, sub-pipeline receives ",(0,r.jsx)(n.strong,{children:"copies"})," of the dictionaries:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// In sub-pipeline transform\npublic override Task<T> ExecuteAsync(T input, PipelineContext context, ...)\n{\n    // This modifies the sub-pipeline\'s copy only\n    context.Parameters["SharedValue"] = "Modified";\n    \n    // Parent\'s value remains unchanged\n    return Task.FromResult(input);\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,r.jsx)(n.h3,{id:"memory-overhead",children:"Memory Overhead"}),"\n",(0,r.jsx)(n.p,{children:"Inheritance involves copying dictionaries:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Configuration"}),(0,r.jsx)(n.th,{children:"Memory Impact"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Default (no inheritance)"}),(0,r.jsx)(n.td,{children:"Minimal - empty dictionaries"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"InheritAll"}),(0,r.jsx)(n.td,{children:"Moderate - copies all three dictionaries"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Selective"}),(0,r.jsx)(n.td,{children:"Low to moderate - copies selected dictionaries"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Recommendation:"})," Only inherit what you need."]}),"\n",(0,r.jsx)(n.h3,{id:"copy-timing",children:"Copy Timing"}),"\n",(0,r.jsx)(n.p,{children:"Dictionaries are copied once per item when the composite node processes it:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"// For each item from source:\n//   1. Create sub-context (with copies if inheritance enabled)\n//   2. Execute sub-pipeline\n//   3. Retrieve output\n//   4. Discard sub-context\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Recommendation:"})," For high-throughput scenarios, prefer no inheritance."]}),"\n",(0,r.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,r.jsx)(n.h3,{id:"pattern-1-configuration-inheritance",children:"Pattern 1: Configuration Inheritance"}),"\n",(0,r.jsx)(n.p,{children:"Pass configuration to sub-pipelines:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// Parent sets up config\nvar context = new PipelineContext();\ncontext.Parameters["ApiEndpoint"] = "https://api.example.com";\ncontext.Parameters["Timeout"] = TimeSpan.FromSeconds(30);\n\n// Sub-pipeline reads config\nbuilder.AddComposite<TIn, TOut, ApiCallPipeline>(\n    contextConfiguration: new CompositeContextConfiguration\n    {\n        InheritParentParameters = true\n    });\n'})}),"\n",(0,r.jsx)(n.h3,{id:"pattern-2-service-injection",children:"Pattern 2: Service Injection"}),"\n",(0,r.jsx)(n.p,{children:"Share services across pipeline hierarchy:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// Parent sets up services\nvar context = new PipelineContext();\ncontext.Items["DatabaseConnection"] = dbConnection;\ncontext.Items["Cache"] = cache;\n\n// Sub-pipeline uses services\nbuilder.AddComposite<TIn, TOut, DatabasePipeline>(\n    contextConfiguration: new CompositeContextConfiguration\n    {\n        InheritParentItems = true\n    });\n'})}),"\n",(0,r.jsx)(n.h3,{id:"pattern-3-environment-context",children:"Pattern 3: Environment Context"}),"\n",(0,r.jsx)(n.p,{children:"Share environment settings:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// Parent sets environment\nvar context = new PipelineContext();\ncontext.Properties["Environment"] = "Production";\ncontext.Properties["Region"] = "US-West";\n\n// Sub-pipeline adapts to environment\nbuilder.AddComposite<TIn, TOut, AdaptivePipeline>(\n    contextConfiguration: new CompositeContextConfiguration\n    {\n        InheritParentProperties = true\n    });\n'})}),"\n",(0,r.jsx)(n.h3,{id:"pattern-4-isolated-testing",children:"Pattern 4: Isolated Testing"}),"\n",(0,r.jsx)(n.p,{children:"Test sub-pipelines independently:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'[Fact]\npublic async Task SubPipeline_WithTestData_ShouldProcess()\n{\n    // Test sub-pipeline directly with test context\n    var context = new PipelineContext();\n    context.Parameters["TestMode"] = true;\n    \n    var runner = PipelineRunner.Create();\n    await runner.RunAsync<MySubPipeline>(context);\n    \n    // Verify behavior\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"1-default-to-no-inheritance",children:"1. Default to No Inheritance"}),"\n",(0,r.jsx)(n.p,{children:"Start with no inheritance and add it only when needed:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"\u2705 Good: Start simple\nbuilder.AddComposite<TIn, TOut, SubPipeline>();  // Uses Default\n\n// Add inheritance only if needed\nbuilder.AddComposite<TIn, TOut, SubPipeline>(\n    contextConfiguration: new CompositeContextConfiguration\n    {\n        InheritParentParameters = true  // Only what's needed\n    });\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-document-dependencies",children:"2. Document Dependencies"}),"\n",(0,r.jsx)(n.p,{children:"Clearly document what context data a sub-pipeline needs:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'/// <summary>\n/// Processes orders using external API.\n/// </summary>\n/// <remarks>\n/// Required Parameters:\n/// - "ApiKey" (string): API authentication key\n/// - "Timeout" (TimeSpan): Request timeout\n/// \n/// Required Items:\n/// - "Logger" (ILogger): Logging service\n/// </remarks>\npublic class ApiOrderProcessingPipeline : IPipelineDefinition\n{\n    // ...\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"3-use-type-safe-accessors",children:"3. Use Type-Safe Accessors"}),"\n",(0,r.jsx)(n.p,{children:"Create helper methods for accessing context:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public static class ContextExtensions\n{\n    public static string GetApiKey(this PipelineContext context)\n    {\n        return context.Parameters.TryGetValue("ApiKey", out var value)\n            ? value?.ToString() ?? throw new InvalidOperationException("ApiKey not found")\n            : throw new InvalidOperationException("ApiKey not found");\n    }\n    \n    public static ILogger GetLogger(this PipelineContext context)\n    {\n        return context.Items.TryGetValue("Logger", out var value)\n            ? value as ILogger ?? throw new InvalidOperationException("Logger not found")\n            : throw new InvalidOperationException("Logger not found");\n    }\n}\n\n// Usage\nvar apiKey = context.GetApiKey();\nvar logger = context.GetLogger();\n'})}),"\n",(0,r.jsx)(n.h3,{id:"4-test-both-with-and-without-inheritance",children:"4. Test Both With and Without Inheritance"}),"\n",(0,r.jsx)(n.p,{children:"Test sub-pipelines in both modes:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'[Fact]\npublic async Task SubPipeline_Standalone_ShouldWork()\n{\n    // Test without parent context\n    var context = new PipelineContext();\n    await runner.RunAsync<SubPipeline>(context);\n}\n\n[Fact]\npublic async Task SubPipeline_WithParentContext_ShouldInherit()\n{\n    // Test with parent context\n    var parentContext = new PipelineContext();\n    parentContext.Parameters["Config"] = "value";\n    \n    await runner.RunAsync<ParentPipeline>(parentContext);\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"5-avoid-implicit-dependencies",children:"5. Avoid Implicit Dependencies"}),"\n",(0,r.jsx)(n.p,{children:"Make dependencies explicit through parameters or constructor injection:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'\u274c Bad: Hidden dependency\npublic class MyTransform : TransformNode<T, T>\n{\n    public override Task<T> ExecuteAsync(T input, PipelineContext context, ...)\n    {\n        // Implicitly requires "Config" in context\n        var config = context.Parameters["Config"];\n        // ...\n    }\n}\n\n\u2705 Good: Explicit dependency\npublic class MyTransform : TransformNode<T, T>\n{\n    private readonly string _config;\n    \n    public MyTransform(PipelineContext context)\n    {\n        if (!context.Parameters.TryGetValue("Config", out var value))\n            throw new ArgumentException("Config parameter is required");\n        _config = value.ToString() ?? throw new ArgumentException("Config cannot be null");\n    }\n    \n    public override Task<T> ExecuteAsync(T input, PipelineContext context, ...)\n    {\n        // Use _config\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Strategy"}),(0,r.jsx)(n.th,{children:"Parameters"}),(0,r.jsx)(n.th,{children:"Items"}),(0,r.jsx)(n.th,{children:"Properties"}),(0,r.jsx)(n.th,{children:"Use Case"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Default"})}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"Isolated, testable sub-pipelines"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"InheritAll"})}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"Full integration with parent"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Parameters Only"})}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"Configuration inheritance"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Items Only"})}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"Service sharing"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Properties Only"})}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"Metadata/environment"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Custom"})}),(0,r.jsx)(n.td,{children:"\ud83d\udd27"}),(0,r.jsx)(n.td,{children:"\ud83d\udd27"}),(0,r.jsx)(n.td,{children:"\ud83d\udd27"}),(0,r.jsx)(n.td,{children:"Fine-grained control"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Choose the strategy that best balances isolation, functionality, and testability for your specific use case."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);