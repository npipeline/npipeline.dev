"use strict";(self.webpackChunknpipeline=self.webpackChunknpipeline||[]).push([[1956],{4137:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"reference/faq","title":"Frequently Asked Questions","description":"Answers to common questions about NPipeline.","source":"@site/docs/reference/faq.md","sourceDirName":"reference","slug":"/reference/faq","permalink":"/docs/reference/faq","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Frequently Asked Questions","description":"Answers to common questions about NPipeline.","sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Reference","permalink":"/docs/reference"},"next":{"title":"Troubleshooting Guide","permalink":"/docs/reference/troubleshooting"}}');var r=i(4848),t=i(8453);const l={title:"Frequently Asked Questions",description:"Answers to common questions about NPipeline.",sidebar_position:3},a="Frequently Asked Questions",o={},c=[{value:"General Questions",id:"general-questions",level:2},{value:"What is NPipeline?",id:"what-is-npipeline",level:3},{value:"When should I use NPipeline?",id:"when-should-i-use-npipeline",level:3},{value:"What makes NPipeline different from other pipeline libraries?",id:"what-makes-npipeline-different-from-other-pipeline-libraries",level:3},{value:"Does NPipeline support streaming data?",id:"does-npipeline-support-streaming-data",level:3},{value:"Installation &amp; Setup",id:"installation--setup",level:2},{value:"Which version of .NET is supported?",id:"which-version-of-net-is-supported",level:3},{value:"Do I need to install all the extensions?",id:"do-i-need-to-install-all-the-extensions",level:3},{value:"Can I use NPipeline with ASP.NET Core?",id:"can-i-use-npipeline-with-aspnet-core",level:3},{value:"How do I set up logging?",id:"how-do-i-set-up-logging",level:3},{value:"Architecture &amp; Concepts",id:"architecture--concepts",level:2},{value:"What&#39;s the difference between IPipeline and IPipelineDefinition?",id:"whats-the-difference-between-ipipeline-and-ipipelinedefinition",level:3},{value:"Can a pipeline have multiple sources?",id:"can-a-pipeline-have-multiple-sources",level:3},{value:"What&#39;s the purpose of PipelineContext?",id:"whats-the-purpose-of-pipelinecontext",level:3},{value:"How does data flow between nodes?",id:"how-does-data-flow-between-nodes",level:3},{value:"Core Concepts",id:"core-concepts",level:2},{value:"What&#39;s the difference between batching and aggregation?",id:"whats-the-difference-between-batching-and-aggregation",level:3},{value:"When should I use ValueTask vs Task in transforms?",id:"when-should-i-use-valuetask-vs-task-in-transforms",level:3},{value:"Do I need ResilientExecutionStrategy for retries?",id:"do-i-need-resilientexecutionstrategy-for-retries",level:3},{value:"Performance",id:"performance",level:2},{value:"How do I know if my pipeline is optimized?",id:"how-do-i-know-if-my-pipeline-is-optimized",level:3},{value:"What&#39;s the memory overhead of materialization?",id:"whats-the-memory-overhead-of-materialization",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"My node restarts aren&#39;t working",id:"my-node-restarts-arent-working",level:3},{value:"My parallel pipeline is slower than sequential",id:"my-parallel-pipeline-is-slower-than-sequential",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"What happens if a transform throws an exception?",id:"what-happens-if-a-transform-throws-an-exception",level:3},{value:"How do I implement retries?",id:"how-do-i-implement-retries",level:3},{value:"Error Codes Reference",id:"error-codes-reference",level:2},{value:"What do the error codes like [NP0101] mean?",id:"what-do-the-error-codes-like-np0101-mean",level:3},{value:"How do I handle invalid data?",id:"how-do-i-handle-invalid-data",level:3},{value:"Testing",id:"testing",level:2},{value:"How do I test a pipeline?",id:"how-do-i-test-a-pipeline",level:3},{value:"Can I test individual nodes?",id:"can-i-test-individual-nodes",level:3},{value:"How do I mock external dependencies?",id:"how-do-i-mock-external-dependencies",level:3},{value:"Integration",id:"integration",level:2},{value:"How do I use NPipeline with a database?",id:"how-do-i-use-npipeline-with-a-database",level:3},{value:"How do I use NPipeline with Message Queues (like RabbitMQ)?",id:"how-do-i-use-npipeline-with-message-queues-like-rabbitmq",level:3},{value:"Can I use NPipeline with dependency injection containers?",id:"can-i-use-npipeline-with-dependency-injection-containers",level:3},{value:"See Also",id:"see-also",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"frequently-asked-questions",children:"Frequently Asked Questions"})}),"\n",(0,r.jsx)(n.h2,{id:"general-questions",children:"General Questions"}),"\n",(0,r.jsx)(n.h3,{id:"what-is-npipeline",children:"What is NPipeline?"}),"\n",(0,r.jsx)(n.p,{children:"NPipeline is a high-performance, graph-based streaming data pipeline library for .NET. It allows you to build complex data processing workflows by defining interconnected nodes (sources, transforms, and sinks) that process data efficiently without loading entire datasets into memory."}),"\n",(0,r.jsx)(n.h3,{id:"when-should-i-use-npipeline",children:"When should I use NPipeline?"}),"\n",(0,r.jsx)(n.p,{children:"NPipeline is ideal for:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ETL (Extract, Transform, Load) pipelines"}),"\n",(0,r.jsx)(n.li,{children:"Real-time data processing"}),"\n",(0,r.jsx)(n.li,{children:"Batch file processing (CSV, JSON, XML)"}),"\n",(0,r.jsx)(n.li,{children:"Data validation and cleansing"}),"\n",(0,r.jsx)(n.li,{children:"API data integration"}),"\n",(0,r.jsx)(n.li,{children:"Any scenario requiring efficient data flow processing"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"what-makes-npipeline-different-from-other-pipeline-libraries",children:"What makes NPipeline different from other pipeline libraries?"}),"\n",(0,r.jsx)(n.p,{children:"NPipeline offers:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Graph-based architecture"})," for clear data flow visualization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"High performance"})," with minimal memory allocations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Type safety"})," with compile-time validation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Flexibility"})," to mix sequential and parallel execution"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Production-ready"})," error handling and resilience"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Testability"})," with built-in testing utilities"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"does-npipeline-support-streaming-data",children:"Does NPipeline support streaming data?"}),"\n",(0,r.jsxs)(n.p,{children:["Yes! NPipeline is designed around streaming data using ",(0,r.jsx)(n.code,{children:"IAsyncEnumerable<T>"}),". Data flows through the pipeline without loading everything into memory at once."]}),"\n",(0,r.jsx)(n.h2,{id:"installation--setup",children:"Installation & Setup"}),"\n",(0,r.jsx)(n.h3,{id:"which-version-of-net-is-supported",children:"Which version of .NET is supported?"}),"\n",(0,r.jsxs)(n.p,{children:["NPipeline requires ",(0,r.jsx)(n.strong,{children:".NET 8.0, 9.0, or 10.0"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"do-i-need-to-install-all-the-extensions",children:"Do I need to install all the extensions?"}),"\n",(0,r.jsxs)(n.p,{children:["No. The core ",(0,r.jsx)(n.code,{children:"NPipeline"})," package is all you need. Extensions are optional:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"DependencyInjection"})," - For managing dependencies"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parallelism"})," - For parallel execution"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Testing"})," - For unit testing pipelines"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Connectors"})," - For pre-built source/sink nodes"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"can-i-use-npipeline-with-aspnet-core",children:"Can I use NPipeline with ASP.NET Core?"}),"\n",(0,r.jsxs)(n.p,{children:["Yes! NPipeline integrates well with ASP.NET Core via dependency injection. See ",(0,r.jsx)(n.a,{href:"/docs/extensions/dependency-injection",children:"Dependency Injection"})," for details."]}),"\n",(0,r.jsx)(n.h3,{id:"how-do-i-set-up-logging",children:"How do I set up logging?"}),"\n",(0,r.jsx)(n.p,{children:"Integrate with Microsoft.Extensions.Logging:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"services.AddLogging(builder => builder.AddConsole());\nservices.AddNPipeline(Assembly.GetExecutingAssembly());\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Then inject ",(0,r.jsx)(n.code,{children:"ILogger<T>"})," into your nodes."]}),"\n",(0,r.jsx)(n.h2,{id:"architecture--concepts",children:"Architecture & Concepts"}),"\n",(0,r.jsx)(n.h3,{id:"whats-the-difference-between-ipipeline-and-ipipelinedefinition",children:"What's the difference between IPipeline and IPipelineDefinition?"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"IPipelineDefinition"})," - A blueprint that defines your pipeline structure"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"IPipeline"})," - The compiled, runnable instance created from a definition"]}),"\n",(0,r.jsxs)(n.li,{children:["You implement ",(0,r.jsx)(n.code,{children:"IPipelineDefinition"}),", then ",(0,r.jsx)(n.code,{children:"PipelineRunner"})," executes it"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"can-a-pipeline-have-multiple-sources",children:"Can a pipeline have multiple sources?"}),"\n",(0,r.jsxs)(n.p,{children:["Yes. Multiple source nodes can connect to the same transform or separate transforms. See ",(0,r.jsx)(n.a,{href:"/docs/core-concepts/common-patterns",children:"Common Patterns"})," for examples."]}),"\n",(0,r.jsx)(n.h3,{id:"whats-the-purpose-of-pipelinecontext",children:"What's the purpose of PipelineContext?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"PipelineContext"})," carries runtime information through the pipeline:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cancellation tokens"}),"\n",(0,r.jsx)(n.li,{children:"Shared state between nodes"}),"\n",(0,r.jsx)(n.li,{children:"Logging and observability services"}),"\n",(0,r.jsx)(n.li,{children:"Custom application data"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"how-does-data-flow-between-nodes",children:"How does data flow between nodes?"}),"\n",(0,r.jsxs)(n.p,{children:["Data flows through ",(0,r.jsx)(n.code,{children:"IDataPipe<T>"})," objects:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Source nodes produce an ",(0,r.jsx)(n.code,{children:"IDataPipe<T>"})]}),"\n",(0,r.jsxs)(n.li,{children:["Transforms consume it and produce a new ",(0,r.jsx)(n.code,{children:"IDataPipe<T>"})]}),"\n",(0,r.jsxs)(n.li,{children:["Sinks consume the final ",(0,r.jsx)(n.code,{children:"IDataPipe<T>"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,r.jsx)(n.h3,{id:"whats-the-difference-between-batching-and-aggregation",children:"What's the difference between batching and aggregation?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Batching"}),' groups items for operational efficiency - to optimize interactions with external systems like databases or APIs. It looks at the wall clock and says "every N items or every X seconds, send what we have."']}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Aggregation"})," groups items for data correctness - to handle out-of-order or late-arriving events in event-time windows. It uses event timestamps, not arrival times, and can wait for latecomers within a configured grace period."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use batching when:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"External systems work more efficiently with bulk operations"}),"\n",(0,r.jsx)(n.li,{children:"You need to reduce API call overhead"}),"\n",(0,r.jsx)(n.li,{children:"Order/timing of items doesn't affect correctness"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use aggregation when:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Events can arrive out of order or late"}),"\n",(0,r.jsx)(n.li,{children:"You need time-windowed summaries or counts"}),"\n",(0,r.jsx)(n.li,{children:"Results must be correct despite late-arriving data"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For a detailed comparison and decision framework, see ",(0,r.jsx)(n.a,{href:"/docs/core-concepts/grouping-strategies",children:"Grouping Strategies: Batching vs Aggregation"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"when-should-i-use-valuetask-vs-task-in-transforms",children:"When should I use ValueTask vs Task in transforms?"}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"ValueTask<T>"})," when your transform can complete synchronously in common cases (cache hits, simple calculations). Use ",(0,r.jsx)(n.code,{children:"Task<T>"})," when your transform is almost always asynchronous."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"ValueTask benefits:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Zero heap allocations for synchronous completions"}),"\n",(0,r.jsx)(n.li,{children:"Eliminates up to 90% of GC pressure in high-cache-hit scenarios"}),"\n",(0,r.jsx)(n.li,{children:"Seamlessly transitions to async when needed"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example pattern:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"public override ValueTask<UserData> ExecuteAsync(string userId, PipelineContext context, CancellationToken cancellationToken)\n{\n    // Fast path: cache hit - no Task allocation\n    if (_cache.TryGetValue(userId, out var cached))\n        return new ValueTask<UserData>(cached);\n    \n    // Slow path: async database call\n    return new ValueTask<UserData>(FetchAndCacheAsync(userId, cancellationToken));\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For complete implementation guidelines and performance impact analysis, see ",(0,r.jsx)(n.a,{href:"/docs/advanced-topics/synchronous-fast-paths",children:"Synchronous Fast Paths and ValueTask Optimization"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"do-i-need-resilientexecutionstrategy-for-retries",children:"Do I need ResilientExecutionStrategy for retries?"}),"\n",(0,r.jsxs)(n.p,{children:["No, ",(0,r.jsx)(n.code,{children:"ResilientExecutionStrategy"})," is specifically for ",(0,r.jsx)(n.strong,{children:"node-level restarts"}),", not basic item retries. There are two different retry mechanisms:"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Item-level retries"})," (no ResilientExecutionStrategy needed):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Retry individual failed items"}),"\n",(0,r.jsxs)(n.li,{children:["Configured via ",(0,r.jsx)(n.code,{children:"PipelineRetryOptions.MaxItemRetries"})]}),"\n",(0,r.jsxs)(n.li,{children:["Handled in node error handlers with ",(0,r.jsx)(n.code,{children:"NodeErrorDecision.Retry"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Node-level restarts"})," (requires ResilientExecutionStrategy):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Restart entire node streams on failure"}),"\n",(0,r.jsxs)(n.li,{children:["Configured via ",(0,r.jsx)(n.code,{children:"PipelineRetryOptions.MaxNodeRestartAttempts"})]}),"\n",(0,r.jsxs)(n.li,{children:["Requires three mandatory components:","\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Node wrapped with ",(0,r.jsx)(n.code,{children:"ResilientExecutionStrategy"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MaxNodeRestartAttempts > 0"})," in retry options"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"MaxMaterializedItems"})," set to a positive number (not null)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For detailed configuration requirements, see ",(0,r.jsx)(n.a,{href:"/docs/core-concepts/resilience/getting-started",children:"Getting Started with Resilience"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"performance",children:"Performance"}),"\n",(0,r.jsx)(n.h3,{id:"how-do-i-know-if-my-pipeline-is-optimized",children:"How do I know if my pipeline is optimized?"}),"\n",(0,r.jsx)(n.p,{children:"Use these approaches to verify pipeline optimization:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Enable build-time analyzers"})," to catch performance anti-patterns:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// In your .csproj\n<PackageReference Include="NPipeline.Analyzers" Version="*" />\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Check for common issues"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Blocking operations in async methods (NP9102)"}),"\n",(0,r.jsx)(n.li,{children:"Missing ValueTask optimizations (NP9209)"}),"\n",(0,r.jsx)(n.li,{children:"Non-streaming patterns in source nodes (NP9211)"}),"\n",(0,r.jsx)(n.li,{children:"Swallowed cancellation exceptions (NP9103)"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Benchmark critical paths"})," with BenchmarkDotNet:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"[MemoryDiagnoser]\npublic class MyTransformBenchmarks\n{\n    [Benchmark]\n    public async Task Transform() => await _transform.ProcessAsync(_data);\n}\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Monitor runtime metrics"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"GC pressure and allocation rates"}),"\n",(0,r.jsx)(n.li,{children:"Throughput vs. latency trade-offs"}),"\n",(0,r.jsx)(n.li,{children:"Memory usage patterns"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For comprehensive performance best practices, see ",(0,r.jsx)(n.a,{href:"/docs/advanced-topics/performance-hygiene",children:"Performance Hygiene"})," and ",(0,r.jsx)(n.a,{href:"/docs/tooling/analyzers/performance",children:"Performance Analyzers"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"whats-the-memory-overhead-of-materialization",children:"What's the memory overhead of materialization?"}),"\n",(0,r.jsx)(n.p,{children:"Materialization buffers items in memory to enable replay functionality during node restarts. The memory overhead depends on:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Item size"}),": Larger items consume more memory per buffered item"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Buffer limit"}),": ",(0,r.jsx)(n.code,{children:"MaxMaterializedItems"})," determines maximum items buffered"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Buffer duration"}),": How many seconds of data you need to replay"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example calculations:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Small objects (100 bytes): 10,000 items \u2248 1MB"}),"\n",(0,r.jsx)(n.li,{children:"Medium objects (1KB): 1,000 items \u2248 1MB"}),"\n",(0,r.jsx)(n.li,{children:"Large objects (10KB): 100 items \u2248 1MB"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration guidance:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"var options = new PipelineRetryOptions(\n    MaxItemRetries: 3,\n    MaxNodeRestartAttempts: 2,\n    MaxMaterializedItems: 1000  // Adjust based on item size and memory budget\n);\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For detailed memory calculations and configuration examples, see ",(0,r.jsx)(n.a,{href:"/docs/core-concepts/resilience/materialization",children:"Materialization & Buffering"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"my-node-restarts-arent-working",children:"My node restarts aren't working"}),"\n",(0,r.jsxs)(n.p,{children:["Node restarts require ",(0,r.jsx)(n.strong,{children:"three mandatory components"}),". If any are missing, restarts silently fail:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"ResilientExecutionStrategy not applied"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// REQUIRED\nvar nodeHandle = builder\n    .AddTransform<MyTransform, Input, Output>("myNode")\n    .WithExecutionStrategy(builder, \n        new ResilientExecutionStrategy(new SequentialExecutionStrategy()));\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"MaxNodeRestartAttempts not configured"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"// REQUIRED - must be > 0\nvar options = new PipelineRetryOptions(\n    MaxItemRetries: 3,\n    MaxNodeRestartAttempts: 2,  // \u2190 Must be set\n    MaxMaterializedItems: 1000\n);\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"MaxMaterializedItems is null"})," (most common issue):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"// REQUIRED - must be positive number, not null\nvar options = new PipelineRetryOptions(\n    MaxItemRetries: 3,\n    MaxNodeRestartAttempts: 2,\n    MaxMaterializedItems: 1000  // \u2190 CRITICAL: null disables restarts\n);\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Verification checklist:"})}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Node wrapped with ResilientExecutionStrategy"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","MaxNodeRestartAttempts > 0"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","MaxMaterializedItems is set to positive number"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Error handler returns PipelineErrorDecision.RestartNode"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For the complete checklist and troubleshooting guide, see ",(0,r.jsx)(n.a,{href:"/docs/core-concepts/resilience/getting-started",children:"Getting Started with Resilience"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"my-parallel-pipeline-is-slower-than-sequential",children:"My parallel pipeline is slower than sequential"}),"\n",(0,r.jsx)(n.p,{children:"Common parallelism anti-patterns that can make parallel pipelines slower:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resource contention"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Multiple threads competing for same database connection"}),"\n",(0,r.jsx)(n.li,{children:"Shared resources without proper synchronization"}),"\n",(0,r.jsx)(n.li,{children:"Too high degree of parallelism causing context switching overhead"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"I/O-bound work with excessive parallelism"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"// WRONG: Too much parallelism for I/O work\nnew ParallelOptions { MaxDegreeOfParallelism = 100 }\n\n// BETTER: Match to I/O capacity\nnew ParallelOptions { MaxDegreeOfParallelism = 4 }\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Unnecessary ordering preservation"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"// SLOWER: Preserves order (default)\nnew ParallelOptions { PreserveOrdering = true }\n\n// FASTER: When order doesn't matter\nnew ParallelOptions { PreserveOrdering = false }\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Improper queue configuration"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Unbounded queues causing memory pressure"}),"\n",(0,r.jsx)(n.li,{children:"Too small queues causing blocking"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Optimization steps:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Start with ",(0,r.jsx)(n.code,{children:"MaxDegreeOfParallelism = Environment.ProcessorCount"})]}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.code,{children:"PreserveOrdering = false"})," if order isn't required"]}),"\n",(0,r.jsxs)(n.li,{children:["Configure appropriate queue limits with ",(0,r.jsx)(n.code,{children:"MaxQueueLength"})]}),"\n",(0,r.jsx)(n.li,{children:"Profile to identify actual bottlenecks"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For detailed parallelism configuration and best practices, see ",(0,r.jsx)(n.a,{href:"/docs/extensions/parallelism",children:"Parallelism"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.h3,{id:"what-happens-if-a-transform-throws-an-exception",children:"What happens if a transform throws an exception?"}),"\n",(0,r.jsx)(n.p,{children:"By default, the exception propagates up and stops the pipeline. Handle errors explicitly:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'try\n{\n    return await ProcessAsync(item);\n}\ncatch (Exception ex)\n{\n    logger.LogError(ex, "Processing failed");\n    throw; // or handle gracefully\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"how-do-i-implement-retries",children:"How do I implement retries?"}),"\n",(0,r.jsx)(n.p,{children:"NPipeline provides several built-in retry mechanisms:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"1. Item-level retries"})," - Retry individual items that fail:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"// Configure max retries per item\nbuilder.WithRetryOptions(opt => opt.With(maxItemRetries: 3));\n\n// In your error handler, return Retry for transient failures\npublic Task<NodeErrorDecision> HandleAsync(...)\n{\n    if (exception is TransientException)\n        return Task.FromResult(NodeErrorDecision.Retry);\n\n    return Task.FromResult(NodeErrorDecision.Skip);\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"2. Node-level restarts"})," - Restart entire node streams on failure:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'// Enable resilience and configure restart limits\nvar myNode = builder\n    .AddTransform<MyTransform, Input, Output>("myTransform")\n    .WithResilience(builder)\n    .WithRetryOptions(builder, opt => opt.With(\n        maxNodeRestartAttempts: 3,\n        maxMaterializedItems: 5000\n    ));\n\n// In your pipeline error handler, return RestartNode\npublic Task<PipelineErrorDecision> HandleNodeFailureAsync(...)\n{\n    if (exception is TimeoutException)\n        return Task.FromResult(PipelineErrorDecision.RestartNode);\n\n    return Task.FromResult(PipelineErrorDecision.FailPipeline);\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"3. Circuit breaker"})," - Prevent cascading failures:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"// Configure circuit breaker through PipelineRetryOptions\nvar retryOptions = new PipelineRetryOptions(\n    MaxItemRetries: 3,\n    MaxNodeRestartAttempts: 2,\n    MaxSequentialNodeAttempts: 5,\n    CircuitBreakerOptions: new PipelineCircuitBreakerOptions(\n        failureThreshold: 5,\n        openDuration: TimeSpan.FromMinutes(1),\n        samplingWindow: TimeSpan.FromMinutes(5),\n        thresholdType: CircuitBreakerThresholdType.ConsecutiveFailures\n    )\n);\nvar context = PipelineContext.WithRetry(retryOptions);\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For advanced patterns beyond simple retry counts, integrate external libraries like ",(0,r.jsx)(n.a,{href:"https://github.com/App-vNext/Polly",children:"Polly"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"// Exponential backoff with Polly\nvar policy = Policy\n    .Handle<HttpRequestException>()\n    .WaitAndRetryAsync(3, attempt => TimeSpan.FromSeconds(Math.Pow(2, attempt)));\n\nawait policy.ExecuteAsync(async () => await CallServiceAsync());\n"})}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.a,{href:"/docs/core-concepts/resilience/error-handling#configuring-retries",children:"Configuring Retries"})," for detailed examples and best practices."]}),"\n",(0,r.jsx)(n.h2,{id:"error-codes-reference",children:"Error Codes Reference"}),"\n",(0,r.jsx)(n.h3,{id:"what-do-the-error-codes-like-np0101-mean",children:"What do the error codes like [NP0101] mean?"}),"\n",(0,r.jsx)(n.p,{children:"NPipeline uses standardized error codes (NP prefix) to help you quickly identify and resolve issues:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"NP01xx"})," - Graph Validation Errors"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"NP02xx"})," - Type Mismatch and Conversion Errors"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"NP03xx"})," - Execution Errors"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"NP04xx"})," - Configuration Errors"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"NP05xx"})," - Resource and Capacity Errors"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"/docs/reference/error-codes",children:"Error Codes Reference"})," for a complete list of all error codes, their causes, and solutions."]}),"\n",(0,r.jsx)(n.h3,{id:"how-do-i-handle-invalid-data",children:"How do I handle invalid data?"}),"\n",(0,r.jsx)(n.p,{children:"Route invalid data to a separate error stream or log it:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'public override Task<Order> ExecuteAsync(Order item, PipelineContext context, CancellationToken cancellationToken)\n{\n    if (item.Price < 0)\n    {\n        logger.LogWarning($"Invalid price: {item.Price}");\n        throw new ValidationException("Price cannot be negative");\n    }\n    return Task.FromResult(item);\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,r.jsx)(n.h3,{id:"how-do-i-test-a-pipeline",children:"How do I test a pipeline?"}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"InMemorySourceNode"})," and ",(0,r.jsx)(n.code,{children:"InMemorySinkNode"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"var context = new PipelineContext();\ncontext.Items[typeof(InMemorySourceNode<int>).FullName!] = new[] { 1, 2, 3 };\n\nvar runner = PipelineRunner.Create();\nawait runner.RunAsync<TestPipeline>(context);\n\n// Retrieve results\nvar sink = context.Items[typeof(InMemorySinkNode<int>).FullName!] as InMemorySinkNode<int>;\nvar results = await sink!.Completion;\n"})}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.a,{href:"/docs/extensions/testing",children:"Testing Pipelines"})," for details."]}),"\n",(0,r.jsx)(n.h3,{id:"can-i-test-individual-nodes",children:"Can I test individual nodes?"}),"\n",(0,r.jsxs)(n.p,{children:["Yes. Call ",(0,r.jsx)(n.code,{children:"ExecuteAsync"})," directly with test data:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"var transform = new MyTransform();\nvar context = new PipelineContext();\nvar result = await transform.ExecuteAsync(testData, context, CancellationToken.None);\nAssert.Equal(expected, result);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"how-do-i-mock-external-dependencies",children:"How do I mock external dependencies?"}),"\n",(0,r.jsx)(n.p,{children:"Use dependency injection with mock services:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"var mockService = new Mock<IMyService>();\nvar node = new MyNode(mockService.Object);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"integration",children:"Integration"}),"\n",(0,r.jsx)(n.h3,{id:"how-do-i-use-npipeline-with-a-database",children:"How do I use NPipeline with a database?"}),"\n",(0,r.jsx)(n.p,{children:"Implement custom source and sink nodes:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"public class DatabaseSource : SourceNode<Customer>\n{\n    private readonly string _connectionString;\n\n    public override IDataPipe<Customer> ExecuteAsync(PipelineContext context, CancellationToken cancellationToken)\n    {\n        static IAsyncEnumerable<Customer> ReadAsync(string connStr, CancellationToken ct)\n        {\n            return Read();\n\n            async IAsyncEnumerable<Customer> Read()\n            {\n                using var connection = new SqlConnection(connStr);\n                await connection.OpenAsync(ct);\n                // Read and yield customers\n            }\n        }\n\n        return new StreamingDataPipe<Customer>(ReadAsync(_connectionString, cancellationToken));\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"how-do-i-use-npipeline-with-message-queues-like-rabbitmq",children:"How do I use NPipeline with Message Queues (like RabbitMQ)?"}),"\n",(0,r.jsx)(n.p,{children:"Implement a source node that reads from the queue:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"public class QueueSource : SourceNode<Message>\n{\n    private readonly IQueueClient _client;\n\n    public override IDataPipe<Message> ExecuteAsync(PipelineContext context, CancellationToken cancellationToken)\n    {\n        static IAsyncEnumerable<Message> ReadAsync(IQueueClient client, CancellationToken ct)\n        {\n            return Read();\n\n            async IAsyncEnumerable<Message> Read()\n            {\n                while (!ct.IsCancellationRequested)\n                {\n                    var message = await client.ReceiveAsync(ct);\n                    if (message != null)\n                    {\n                        yield return message;\n                    }\n                }\n            }\n        }\n\n        return new StreamingDataPipe<Message>(ReadAsync(_client, cancellationToken));\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"can-i-use-npipeline-with-dependency-injection-containers",children:"Can I use NPipeline with dependency injection containers?"}),"\n",(0,r.jsxs)(n.p,{children:["Yes, with the ",(0,r.jsx)(n.code,{children:"NPipeline.Extensions.DependencyInjection"})," package:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"services.AddNPipeline(Assembly.GetExecutingAssembly());\n// Your nodes are automatically registered and resolved\n"})}),"\n",(0,r.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/docs/getting-started",children:"Getting Started"})})," - Installation and quick start"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/docs/core-concepts/common-patterns",children:"Common Patterns"})})," - See practical examples"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/docs/core-concepts/best-practices",children:"Best Practices"})})," - Design guidelines"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/docs/reference/troubleshooting",children:"Troubleshooting"})})," - Common issues and solutions"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var s=i(6540);const r={},t=s.createContext(r);function l(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);