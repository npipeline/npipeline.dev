"use strict";(self.webpackChunknpipeline=self.webpackChunknpipeline||[]).push([[2593],{28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>d});var r=i(96540);const t={},s=r.createContext(t);function l(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(s.Provider,{value:n},e.children)}},82373:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"extensions/nodes/filtering","title":"Filtering Nodes","description":"Filter items based on predicates and conditions.","source":"@site/docs/extensions/nodes/filtering.md","sourceDirName":"extensions/nodes","slug":"/extensions/nodes/filtering","permalink":"/docs/extensions/nodes/filtering","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Filtering Nodes","description":"Filter items based on predicates and conditions.","sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Data Validation Nodes","permalink":"/docs/extensions/nodes/validation"},"next":{"title":"Type Conversion Nodes","permalink":"/docs/extensions/nodes/conversion"}}');var t=i(74848),s=i(28453);const l={title:"Filtering Nodes",description:"Filter items based on predicates and conditions.",sidebar_position:3},d="Filtering Nodes",a={},o=[{value:"Basic Filtering",id:"basic-filtering",level:2},{value:"Constructor with Predicate",id:"constructor-with-predicate",level:2},{value:"Fluent Where Syntax",id:"fluent-where-syntax",level:2},{value:"Fixed Message Where",id:"fixed-message-where",level:2},{value:"Property-Based Filtering",id:"property-based-filtering",level:2},{value:"Complex Predicates",id:"complex-predicates",level:2},{value:"Filtering with Collections",id:"filtering-with-collections",level:2},{value:"Custom Error Messages",id:"custom-error-messages",level:2},{value:"Default Messages",id:"default-messages",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Node Error Decisions",id:"node-error-decisions",level:2},{value:"Filtering Pipeline Example",id:"filtering-pipeline-example",level:2},{value:"Performance Characteristics",id:"performance-characteristics",level:2},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Pre-filter Before Expensive Operations",id:"pre-filter-before-expensive-operations",level:3},{value:"Multi-stage Filtering",id:"multi-stage-filtering",level:3},{value:"Conditional Filtering",id:"conditional-filtering",level:3},{value:"Combining with Other Nodes",id:"combining-with-other-nodes",level:2},{value:"Testing Filtered Pipelines",id:"testing-filtered-pipelines",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"filtering-nodes",children:"Filtering Nodes"})}),"\n",(0,t.jsxs)(n.p,{children:["Filtering nodes selectively pass through or reject items based on predicates. When an item fails a filter, a ",(0,t.jsx)(n.code,{children:"FilteringException"})," is thrown with details about why the item was filtered."]}),"\n",(0,t.jsx)(n.h2,{id:"basic-filtering",children:"Basic Filtering"}),"\n",(0,t.jsx)(n.p,{children:"Filter items using a predicate:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"// Single filter\nbuilder.AddFiltering<Order>(x => x.Status == OrderStatus.Pending);\n\n// Multiple filters\nbuilder.AddFiltering<Product>()\n    .Where(x => x.Price > 0)\n    .Where(x => x.IsActive);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"constructor-with-predicate",children:"Constructor with Predicate"}),"\n",(0,t.jsx)(n.p,{children:"Specify the filter predicate in the constructor:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var activeOrders = builder.AddFiltering<Order>(x => x.Status == OrderStatus.Active);\n\nvar expensiveProducts = builder.AddFiltering<Product>(\n    x => x.Price > 100,\n    reason: "Price must exceed $100");\n'})}),"\n",(0,t.jsx)(n.h2,{id:"fluent-where-syntax",children:"Fluent Where Syntax"}),"\n",(0,t.jsx)(n.p,{children:"Chain multiple filter conditions:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'builder.AddFiltering<Order>()\n    .Where(x => x.Amount > 100, "Order amount must exceed $100")\n    .Where(x => x.Status != OrderStatus.Cancelled, "Order must not be cancelled")\n    .Where(x => x.CreatedDate >= DateTime.Today, "Order must be from today");\n'})}),"\n",(0,t.jsx)(n.h2,{id:"fixed-message-where",children:"Fixed Message Where"}),"\n",(0,t.jsx)(n.p,{children:"Use a string instead of a factory for simple messages:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// When you have a fixed message, this is cleaner than a factory\nbuilder.AddFiltering<Order>()\n    .Where(x => x.Amount > 100, "Order amount must exceed $100")\n    .Where(x => x.Status != OrderStatus.Cancelled, "Order must not be cancelled");\n'})}),"\n",(0,t.jsx)(n.h2,{id:"property-based-filtering",children:"Property-Based Filtering"}),"\n",(0,t.jsx)(n.p,{children:"Filter based on a specific property with built-in error messages:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Filter by property value\nbuilder.AddFiltering<Order>()\n    .WhereProperty(x => x.Status, status => status == OrderStatus.Active, "Status must be Active")\n    .WhereProperty(x => x.Amount, amount => amount > 100, "Amount must exceed $100");\n\n// Simpler than writing the full predicate\nbuilder.AddFiltering<Person>()\n    .WhereProperty(x => x.Age, age => age >= 18, "Must be 18 or older");\n'})}),"\n",(0,t.jsx)(n.h2,{id:"complex-predicates",children:"Complex Predicates"}),"\n",(0,t.jsx)(n.p,{children:"Use complex conditional logic:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Complex condition\nbuilder.AddFiltering<Person>(x => \n    (x.Age >= 18 && x.Status == "Active") || \n    x.IsVip == true);\n\n// With custom message\nbuilder.AddFiltering<Order>(\n    x => x.Amount > 1000 && x.Customer.CreditScore > 700,\n    reason: "Order amount must exceed $1000 and customer credit score must be above 700");\n\n// Multiple conditions\nbuilder.AddFiltering<Document>()\n    .Where(x => x.IsPublished, "Document must be published")\n    .Where(x => x.Status == "Approved", "Document must be approved")\n    .Where(x => !x.IsArchived, "Document must not be archived");\n'})}),"\n",(0,t.jsx)(n.h2,{id:"filtering-with-collections",children:"Filtering with Collections"}),"\n",(0,t.jsx)(n.p,{children:"Filter based on collection properties:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Item exists in collection\nbuilder.AddFiltering<Order>(x => x.Items.Count > 0, "Order must contain at least one item");\n\n// Collection contains specific value\nbuilder.AddFiltering<Category>(x => x.Tags.Contains("Featured"), "Category must be tagged as Featured");\n\n// All items satisfy condition\nbuilder.AddFiltering<Order>(x => x.Items.All(i => i.Quantity > 0), "All items must have positive quantity");\n\n// Any item satisfies condition\nbuilder.AddFiltering<Product>(x => x.Variants.Any(v => v.IsAvailable), "Product must have at least one available variant");\n'})}),"\n",(0,t.jsx)(n.h2,{id:"custom-error-messages",children:"Custom Error Messages"}),"\n",(0,t.jsx)(n.p,{children:"Provide descriptive messages when items are filtered:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Constructor\nvar filter = builder.AddFiltering<Order>(\n    x => x.Amount > 0,\n    reason: "Order amount must be greater than zero");\n\n// With Where method\nbuilder.AddFiltering<Product>()\n    .Where(x => x.Price > 0, "Price must be positive")\n    .Where(x => x.StockLevel > 0, "Stock level must be positive");\n'})}),"\n",(0,t.jsx)(n.h2,{id:"default-messages",children:"Default Messages"}),"\n",(0,t.jsx)(n.p,{children:"If no custom message is provided, a default message is used:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Default: "Item did not meet filtering criteria"\nbuilder.AddFiltering<Order>(x => x.Amount > 0);\n'})}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsxs)(n.p,{children:["Filtered items raise ",(0,t.jsx)(n.code,{children:"FilteringException"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'try\n{\n    await pipeline.ExecuteAsync();\n}\ncatch (FilteringException ex)\n{\n    Console.WriteLine($"Reason: {ex.Reason}");\n    Console.WriteLine($"Message: {ex.Message}");\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"node-error-decisions",children:"Node Error Decisions"}),"\n",(0,t.jsx)(n.p,{children:"Control what happens when an item is filtered:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"// Skip filtered items (default - no exception)\nbuilder.WithErrorDecision(filterHandle, NodeErrorDecision.Skip);\n\n// Throw exception on first filtered item\nbuilder.WithErrorDecision(filterHandle, NodeErrorDecision.Fail);\n\n// Retry with different criteria\nbuilder.WithErrorDecision(filterHandle, NodeErrorDecision.Retry);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"filtering-pipeline-example",children:"Filtering Pipeline Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var builder = new PipelineBuilder();\n\n// Define source\nvar source = builder.AddInMemorySource<Order>();\n\n// Filter 1: Only pending orders\nvar filterPending = builder.AddFiltering<Order>(\n    x => x.Status == OrderStatus.Pending,\n    reason: "Order must be pending");\n\n// Filter 2: Amount constraints\nvar filterAmount = builder.AddFiltering<Order>()\n    .Where(x => x.Amount > 50, "Order amount must exceed $50")\n    .Where(x => x.Amount <= 10000, "Order amount cannot exceed $10,000");\n\n// Filter 3: Customer validation\nvar filterCustomer = builder.AddFiltering<Order>(\n    x => x.Customer != null && !x.Customer.IsBlocked,\n    reason: "Customer must exist and not be blocked");\n\n// Define sink\nvar sink = builder.AddInMemorySink<Order>();\n\n// Connect filters in sequence\nbuilder.Connect(source, filterPending);\nbuilder.Connect(filterPending, filterAmount);\nbuilder.Connect(filterAmount, filterCustomer);\nbuilder.Connect(filterCustomer, sink);\n\n// Build and execute\nvar pipeline = builder.Build();\nvar result = await pipeline.ExecuteAsync();\n'})}),"\n",(0,t.jsx)(n.h2,{id:"performance-characteristics",children:"Performance Characteristics"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Predicate Evaluation"}),": Performed inline on each item (no compilation)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Exception Creation"}),": ",(0,t.jsx)(n.code,{children:"FilteringException"})," is created only when item fails"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Memory"}),": No additional allocations for filter state"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Thread Safety"}),": Stateless and thread-safe for parallel execution"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,t.jsx)(n.h3,{id:"pre-filter-before-expensive-operations",children:"Pre-filter Before Expensive Operations"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"var builder = new PipelineBuilder();\n\n// Fast filter first\nvar quickFilter = builder.AddFiltering<Product>(x => x.Price > 0);\n\n// Expensive operation after filtering\nvar enrichment = builder.AddEnrichment<Product>(x => x.Details = FetchExpensiveDetails());\n\nbuilder.Connect(quickFilter, enrichment);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"multi-stage-filtering",children:"Multi-stage Filtering"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Filter stage 1\nvar stage1 = builder.AddFiltering<Item>(x => x.Status == "Active");\n\n// Filter stage 2\nvar stage2 = builder.AddFiltering<Item>(x => x.Score >= 5)\n    .Where(x => x.IsApproved);\n\n// Filter stage 3\nvar stage3 = builder.AddFiltering<Item>(x => !x.IsExpired);\n\nbuilder.Connect(stage1, stage2);\nbuilder.Connect(stage2, stage3);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"conditional-filtering",children:"Conditional Filtering"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'// Only filter if condition met\nbool applyStrictFiltering = context.GetSetting("StrictMode");\n\nif (applyStrictFiltering)\n{\n    builder.AddFiltering<Product>(x => x.Quality >= 8);\n}\nelse\n{\n    builder.AddFiltering<Product>(x => x.Quality >= 5);\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"combining-with-other-nodes",children:"Combining with Other Nodes"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"var builder = new PipelineBuilder();\n\n// Cleanse first\nvar cleanse = builder.AddStringCleansing<Product>(x => x.Name)\n    .Trim()\n    .ToLower();\n\n// Validate\nvar validate = builder.AddStringValidation<Product>(x => x.Name)\n    .HasMinLength(3);\n\n// Filter\nvar filter = builder.AddFiltering<Product>(x => x.IsActive);\n\n// Connect in order\nbuilder.Connect(cleanse, validate);\nbuilder.Connect(validate, filter);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"testing-filtered-pipelines",children:"Testing Filtered Pipelines"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"[Fact]\npublic async Task FilterPipeline_ShouldFilterInactiveItems()\n{\n    // Arrange\n    var items = new[] { \n        new Order { Id = 1, IsActive = true },\n        new Order { Id = 2, IsActive = false },\n        new Order { Id = 3, IsActive = true }\n    };\n\n    var source = new InMemorySourceNode<Order>(items);\n    var filter = new FilteringNode<Order>(x => x.IsActive);\n    var sink = new InMemorySinkNode<Order>();\n\n    // Act\n    await filter.ExecuteAsync(source, context);\n    await sink.ExecuteAsync(filter, context);\n\n    // Assert\n    sink.Items.Should().HaveCount(2);\n    sink.Items.All(x => x.IsActive).Should().BeTrue();\n}\n"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);