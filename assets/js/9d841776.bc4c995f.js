"use strict";(self.webpackChunknpipeline=self.webpackChunknpipeline||[]).push([[371],{28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>t});var i=r(96540);const s={},l=i.createContext(s);function o(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(l.Provider,{value:n},e.children)}},83526:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"connectors/excel","title":"Excel Connector","description":"Read from and write to Excel files (XLS and XLSX) with NPipeline using the Excel connector.","source":"@site/docs/connectors/excel.md","sourceDirName":"connectors","slug":"/connectors/excel","permalink":"/docs/connectors/excel","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Excel Connector","description":"Read from and write to Excel files (XLS and XLSX) with NPipeline using the Excel connector.","sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"CSV Connector","permalink":"/docs/connectors/csv"},"next":{"title":"Storage Provider Interface","permalink":"/docs/connectors/storage-provider"}}');var s=r(74848),l=r(28453);const o={title:"Excel Connector",description:"Read from and write to Excel files (XLS and XLSX) with NPipeline using the Excel connector.",sidebar_position:2},t="Excel Connector",c={},d=[{value:"Installation",id:"installation",level:2},{value:"Storage Abstraction Layer",id:"storage-abstraction-layer",level:2},{value:"StorageUri",id:"storageuri",level:3},{value:"IStorageResolver",id:"istorageresolver",level:3},{value:"<code>ExcelSourceNode&lt;T&gt;</code>",id:"excelsourcenodet",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Example: Reading an Excel File",id:"example-reading-an-excel-file",level:3},{value:"<code>ExcelSinkNode&lt;T&gt;</code>",id:"excelsinknodet",level:2},{value:"Configuration",id:"configuration-1",level:3},{value:"Example: Writing to an Excel File",id:"example-writing-to-an-excel-file",level:3},{value:"Configuration Reference",id:"configuration-reference",level:2},{value:"ExcelConfiguration",id:"excelconfiguration",level:3},{value:"Properties",id:"properties",level:4},{value:"Advanced Configuration",id:"advanced-configuration",level:2},{value:"Buffer Size Configuration",id:"buffer-size-configuration",level:3},{value:"Sheet Selection",id:"sheet-selection",level:3},{value:"Type Detection Configuration",id:"type-detection-configuration",level:3},{value:"Fast Mode (Default)",id:"fast-mode-default",level:4},{value:"Accurate Mode",id:"accurate-mode",level:4},{value:"Encoding Configuration",id:"encoding-configuration",level:3},{value:"Example: Transforming and Writing to Excel",id:"example-transforming-and-writing-to-excel",level:3},{value:"Supported Data Types",id:"supported-data-types",level:2},{value:"Primitive Types",id:"primitive-types",level:3},{value:"String Types",id:"string-types",level:3},{value:"Date/Time Types",id:"datetime-types",level:3},{value:"GUID Types",id:"guid-types",level:3},{value:"Type Conversion Behavior",id:"type-conversion-behavior",level:3},{value:"Format Support",id:"format-support",level:2},{value:"Reading",id:"reading",level:3},{value:"Writing",id:"writing",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Reading Performance",id:"reading-performance",level:3},{value:"Writing Performance",id:"writing-performance",level:3},{value:"Performance Optimization Tips",id:"performance-optimization-tips",level:3},{value:"Limitations",id:"limitations",level:2},{value:"Format Limitations",id:"format-limitations",level:3},{value:"Memory Limitations",id:"memory-limitations",level:3},{value:"Type Mapping Limitations",id:"type-mapping-limitations",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"File Format",id:"file-format",level:3},{value:"Configuration",id:"configuration-2",level:3},{value:"Data Modeling",id:"data-modeling",level:3},{value:"Error Handling",id:"error-handling-1",level:3},{value:"Performance",id:"performance",level:3},{value:"Advanced Scenarios",id:"advanced-scenarios",level:2},{value:"Reading Multiple Sheets",id:"reading-multiple-sheets",level:3},{value:"Round-Trip Processing",id:"round-trip-processing",level:3},{value:"Working with Legacy XLS Files",id:"working-with-legacy-xls-files",level:3},{value:"Handling Mixed Data Types",id:"handling-mixed-data-types",level:3},{value:"Related Topics",id:"related-topics",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"excel-connector",children:"Excel Connector"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"NPipeline.Connectors.Excel"})," package provides specialized source and sink nodes for working with Excel files. This allows you to easily integrate Excel data into your pipelines as an input source or an output destination."]}),"\n",(0,s.jsxs)(n.p,{children:["This connector uses the ",(0,s.jsx)(n.a,{href:"https://github.com/ExcelDataReader/ExcelDataReader",children:"ExcelDataReader"})," library for reading both legacy XLS (binary) and modern XLSX (Open XML) formats, and the ",(0,s.jsx)(n.a,{href:"https://github.com/dotnet/Open-XML-SDK",children:"DocumentFormat.OpenXml"})," library for writing XLSX files."]}),"\n",(0,s.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,s.jsxs)(n.p,{children:["To use the Excel connector, install the ",(0,s.jsx)(n.code,{children:"NPipeline.Connectors.Excel"})," NuGet package:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"dotnet add package NPipeline.Connectors.Excel\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For the core NPipeline package and other available extensions, see the ",(0,s.jsx)(n.a,{href:"/docs/getting-started/installation",children:"Installation Guide"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"storage-abstraction-layer",children:"Storage Abstraction Layer"}),"\n",(0,s.jsx)(n.p,{children:"The Excel connector uses NPipeline's storage abstraction layer, which provides a unified way to work with different storage systems. This layer allows you to work with local files, cloud storage (like S3 or Azure Blob), and other storage systems using the same API."}),"\n",(0,s.jsx)(n.h3,{id:"storageuri",children:"StorageUri"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"StorageUri"}),' class represents a normalized storage location URI. It supports both absolute URIs (e.g., "s3://bucket/key") and local file paths. For local files, use the ',(0,s.jsx)(n.code,{children:"StorageUri.FromFilePath()"})," method:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'// For local files\nvar localFileUri = StorageUri.FromFilePath("data/input.xlsx");\n\n// For absolute URIs (e.g., cloud storage)\nvar cloudUri = StorageUri.Parse("s3://my-bucket/path/to/file.xlsx");\n'})}),"\n",(0,s.jsx)(n.h3,{id:"istorageresolver",children:"IStorageResolver"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"IStorageResolver"})," interface is responsible for discovering and resolving storage providers capable of handling a given ",(0,s.jsx)(n.code,{children:"StorageUri"}),". You must provide a resolver to both ",(0,s.jsx)(n.code,{children:"ExcelSourceNode"})," and ",(0,s.jsx)(n.code,{children:"ExcelSinkNode"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"To create a resolver for standard file system operations, use:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"var resolver = StorageProviderFactory.CreateResolver().Resolver;\n"})}),"\n",(0,s.jsx)(n.p,{children:"You may need a custom resolver when:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Working with cloud storage systems (S3, Azure, etc.)"}),"\n",(0,s.jsx)(n.li,{children:"Using custom storage providers"}),"\n",(0,s.jsx)(n.li,{children:"Needing to override default provider selection"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"excelsourcenodet",children:(0,s.jsx)(n.code,{children:"ExcelSourceNode<T>"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"ExcelSourceNode<T>"})," reads data from an Excel file and emits each row as an item of type ",(0,s.jsx)(n.code,{children:"T"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["The constructor for ",(0,s.jsx)(n.code,{children:"ExcelSourceNode<T>"})," takes the file path, a storage resolver, and optional configuration for parsing the Excel file."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"public ExcelSourceNode(\n    StorageUri uri,\n    IStorageResolver resolver,\n    ExcelConfiguration? configuration = null)\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"uri"})}),": The ",(0,s.jsx)(n.code,{children:"StorageUri"})," representing the location of the Excel file. Use ",(0,s.jsx)(n.code,{children:'StorageUri.FromFilePath("path/to/file.xlsx")'})," for local files."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"resolver"})}),": The ",(0,s.jsx)(n.code,{children:"IStorageResolver"})," to resolve storage providers. Create one using ",(0,s.jsx)(n.code,{children:"StorageProviderFactory.CreateResolver().Resolver"})," for standard file system support."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"configuration"})}),": An optional ",(0,s.jsx)(n.code,{children:"ExcelConfiguration"})," object to customize parsing (e.g., sheet selection, header handling, encoding)."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"example-reading-an-excel-file",children:"Example: Reading an Excel File"}),"\n",(0,s.jsxs)(n.p,{children:["Let's assume you have a ",(0,s.jsx)(n.code,{children:"products.xlsx"})," file with the following structure:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Id"}),(0,s.jsx)(n.th,{children:"Name"}),(0,s.jsx)(n.th,{children:"Price"}),(0,s.jsx)(n.th,{children:"Category"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"Widget"}),(0,s.jsx)(n.td,{children:"19.99"}),(0,s.jsx)(n.td,{children:"Electronics"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"2"}),(0,s.jsx)(n.td,{children:"Gadget"}),(0,s.jsx)(n.td,{children:"29.99"}),(0,s.jsx)(n.td,{children:"Electronics"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"3"}),(0,s.jsx)(n.td,{children:"Tool"}),(0,s.jsx)(n.td,{children:"9.99"}),(0,s.jsx)(n.td,{children:"Hardware"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"And a corresponding C# record:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"public sealed record Product(int Id, string Name, decimal Price, string Category);\n"})}),"\n",(0,s.jsx)(n.p,{children:"You can read this data into your pipeline as follows:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'using NPipeline;\nusing NPipeline.Connectors;\nusing NPipeline.Connectors.Excel;\nusing NPipeline.DataFlow.DataPipes;\nusing NPipeline.DataFlow;\nusing NPipeline.Execution;\nusing NPipeline.Nodes;\nusing NPipeline.Pipeline;\nusing NPipeline.Tracing;\n\npublic sealed record Product(int Id, string Name, decimal Price, string Category);\n\npublic sealed class ExcelReaderPipeline : IPipelineDefinition\n{\n    public void Define(PipelineBuilder builder, PipelineContext context)\n    {\n        var resolver = StorageProviderFactory.CreateResolver().Resolver;\n        var source = builder.AddSource("excel_source", new ExcelSourceNode<Product>(StorageUri.FromFilePath("products.xlsx"), resolver));\n        var sink = builder.AddSink<ConsoleSinkNode, Product>("console_sink");\n\n        builder.Connect(source, sink);\n    }\n}\n\npublic sealed class ConsoleSinkNode : SinkNode<Product>\n{\n    public override async Task ExecuteAsync(\n        IDataPipe<Product> input,\n        PipelineContext context,\n        IPipelineActivity parentActivity,\n        CancellationToken cancellationToken)\n    {\n        await foreach (var product in input.WithCancellation(cancellationToken))\n        {\n            Console.WriteLine($"Received: {product}");\n        }\n    }\n}\n\npublic static class Program\n{\n    public static async Task Main(string[] args)\n    {\n        // Create and run the pipeline\n        var runner = PipelineRunner.Create();\n        await runner.RunAsync<ExcelReaderPipeline>();\n\n        Console.WriteLine("Excel reading completed");\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Expected Output:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"Received: Product { Id = 1, Name = Widget, Price = 19.99, Category = Electronics }\nReceived: Product { Id = 2, Name = Gadget, Price = 29.99, Category = Electronics }\nReceived: Product { Id = 3, Name = Tool, Price = 9.99, Category = Hardware }\nExcel reading completed\n"})}),"\n",(0,s.jsx)(n.h2,{id:"excelsinknodet",children:(0,s.jsx)(n.code,{children:"ExcelSinkNode<T>"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"ExcelSinkNode<T>"})," writes items from the pipeline to an Excel file in XLSX format."]}),"\n",(0,s.jsx)(n.h3,{id:"configuration-1",children:"Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["The constructor for ",(0,s.jsx)(n.code,{children:"ExcelSinkNode<T>"})," takes the file path, a storage resolver, and optional configuration for writing the Excel file."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"public ExcelSinkNode(\n    StorageUri uri,\n    IStorageResolver resolver,\n    ExcelConfiguration? configuration = null)\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"uri"})}),": The ",(0,s.jsx)(n.code,{children:"StorageUri"})," representing the location of the output Excel file. Use ",(0,s.jsx)(n.code,{children:'StorageUri.FromFilePath("path/to/file.xlsx")'})," for local files."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"resolver"})}),": The ",(0,s.jsx)(n.code,{children:"IStorageResolver"})," to resolve storage providers. Create one using ",(0,s.jsx)(n.code,{children:"StorageProviderFactory.CreateResolver().Resolver"})," for standard file system support."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"configuration"})}),": An optional ",(0,s.jsx)(n.code,{children:"ExcelConfiguration"})," object to customize writing (e.g., sheet name, header handling)."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"example-writing-to-an-excel-file",children:"Example: Writing to an Excel File"}),"\n",(0,s.jsxs)(n.p,{children:["Let's take processed product data and write it to an ",(0,s.jsx)(n.code,{children:"output.xlsx"})," file."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'using NPipeline.Connectors;\nusing NPipeline.Connectors.Excel;\nusing NPipeline.Execution;\nusing NPipeline.Extensions.Testing;\nusing NPipeline.Nodes;\nusing NPipeline.Pipeline;\n\npublic sealed record ProcessedProduct(int Id, string FullName, decimal AdjustedPrice, string Status);\n\npublic sealed class ExcelWriterPipeline : IPipelineDefinition\n{\n    public void Define(PipelineBuilder builder, PipelineContext context)\n    {\n        var resolver = StorageProviderFactory.CreateResolver().Resolver;\n        var source = builder.AddSource<InMemorySourceNode<ProcessedProduct>, ProcessedProduct>("source");\n        var sink = builder.AddSink("excel_sink", new ExcelSinkNode<ProcessedProduct>(StorageUri.FromFilePath("output.xlsx"), resolver));\n\n        builder.Connect(source, sink);\n    }\n}\n\npublic static class Program\n{\n    public static async Task Main(string[] args)\n    {\n        var products = new List<ProcessedProduct>\n        {\n            new(1, "Widget Pro", 21.99m, "In Stock"),\n            new(2, "Gadget Ultra", 32.99m, "Low Stock"),\n            new(3, "Tool Basic", 10.99m, "Out of Stock")\n        };\n\n        // Set up test data\n        var context = PipelineContext.Default;\n        context.Items[typeof(InMemorySourceNode<ProcessedProduct>).FullName!] = products.ToArray();\n\n        var runner = PipelineRunner.Create();\n        await runner.RunAsync<ExcelWriterPipeline>(context);\n\n        Console.WriteLine("\\nExcel file created: output.xlsx");\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["Expected ",(0,s.jsx)(n.code,{children:"output.xlsx"})," Content:"]})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Id"}),(0,s.jsx)(n.th,{children:"FullName"}),(0,s.jsx)(n.th,{children:"AdjustedPrice"}),(0,s.jsx)(n.th,{children:"Status"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"Widget Pro"}),(0,s.jsx)(n.td,{children:"21.99"}),(0,s.jsx)(n.td,{children:"In Stock"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"2"}),(0,s.jsx)(n.td,{children:"Gadget Ultra"}),(0,s.jsx)(n.td,{children:"32.99"}),(0,s.jsx)(n.td,{children:"Low Stock"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"3"}),(0,s.jsx)(n.td,{children:"Tool Basic"}),(0,s.jsx)(n.td,{children:"10.99"}),(0,s.jsx)(n.td,{children:"Out of Stock"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"configuration-reference",children:"Configuration Reference"}),"\n",(0,s.jsx)(n.h3,{id:"excelconfiguration",children:"ExcelConfiguration"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"ExcelConfiguration"})," class provides comprehensive options for configuring Excel read and write operations."]}),"\n",(0,s.jsx)(n.h4,{id:"properties",children:"Properties"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"BufferSize"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"int"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"4096"})}),(0,s.jsx)(n.td,{children:"Buffer size for stream operations in bytes. Larger buffers improve I/O performance but use more memory."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"SheetName"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"string?"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsxs)(n.td,{children:["Name of the sheet to read from or write to. When ",(0,s.jsx)(n.code,{children:"null"}),', uses the first sheet for reading or creates a default sheet ("Sheet1") for writing.']})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"FirstRowIsHeader"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"bool"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsxs)(n.td,{children:["Indicates whether the first row contains column headers. When ",(0,s.jsx)(n.code,{children:"true"}),", the first row is used for property mapping."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"HasHeaderRow"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"bool"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsxs)(n.td,{children:["Convenience property that syncs with ",(0,s.jsx)(n.code,{children:"FirstRowIsHeader"}),"."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Encoding"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Encoding?"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"null"})}),(0,s.jsxs)(n.td,{children:["Encoding for reading legacy XLS files with text data. When ",(0,s.jsx)(n.code,{children:"null"}),", ExcelDataReader auto-detects encoding."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"AutodetectSeparators"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"bool"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsx)(n.td,{children:"Indicates whether to automatically detect separators in CSV-like data within Excel cells."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"AnalyzeAllColumns"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"bool"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"false"})}),(0,s.jsx)(n.td,{children:"Indicates whether to analyze the entire workbook to determine data types. Provides more accurate detection but is slower."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"AnalyzeInitialRowCount"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"int"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"30"})}),(0,s.jsxs)(n.td,{children:["Number of rows to analyze for data type detection when ",(0,s.jsx)(n.code,{children:"AnalyzeAllColumns"})," is ",(0,s.jsx)(n.code,{children:"false"}),"."]})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"advanced-configuration",children:"Advanced Configuration"}),"\n",(0,s.jsx)(n.h3,{id:"buffer-size-configuration",children:"Buffer Size Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"../../../src/NPipeline.Connectors.Excel/ExcelConfiguration.cs:42",children:(0,s.jsx)(n.code,{children:"BufferSize"})})," property controls the internal buffer size for Excel I/O operations:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Default value"}),": 4096 bytes (4KB)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Determines the size of the buffer used for stream operations when reading or writing Excel files"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Performance impact"}),": Larger buffers can improve I/O performance for large files but use more memory"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"When to adjust BufferSize:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Increase"})," (e.g., 8192, 16384) for:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Processing very large Excel files"}),"\n",(0,s.jsx)(n.li,{children:"High-throughput scenarios where I/O performance is critical"}),"\n",(0,s.jsx)(n.li,{children:"Systems with abundant memory resources"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Decrease"})," (e.g., 2048, 1024) for:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Memory-constrained environments"}),"\n",(0,s.jsx)(n.li,{children:"Processing many small Excel files concurrently"}),"\n",(0,s.jsx)(n.li,{children:"Scenarios where memory usage must be tightly controlled"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'// Example: Custom buffer size for large file processing\nvar largeFileConfig = new ExcelConfiguration\n{\n    BufferSize = 8192, // 8KB buffer for better performance with large files\n    SheetName = "LargeDataset",\n    FirstRowIsHeader = true\n};\n\nvar resolver = StorageProviderFactory.CreateResolver().Resolver;\nvar source = new ExcelSourceNode<Product>(StorageUri.FromFilePath("large_dataset.xlsx"), resolver, largeFileConfig);\n'})}),"\n",(0,s.jsx)(n.h3,{id:"sheet-selection",children:"Sheet Selection"}),"\n",(0,s.jsxs)(n.p,{children:["You can specify which sheet to read from or write to using the ",(0,s.jsx)(n.code,{children:"SheetName"})," property:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'// Read from a specific sheet\nvar readConfig = new ExcelConfiguration\n{\n    SheetName = "Q4Sales",\n    FirstRowIsHeader = true\n};\n\nvar resolver = StorageProviderFactory.CreateResolver().Resolver;\nvar source = new ExcelSourceNode<SalesRecord>(StorageUri.FromFilePath("sales_report.xlsx"), resolver, readConfig);\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'// Write to a specific sheet\nvar writeConfig = new ExcelConfiguration\n{\n    SheetName = "ProcessedData",\n    FirstRowIsHeader = true\n};\n\nvar resolver = StorageProviderFactory.CreateResolver().Resolver;\nvar sink = new ExcelSinkNode<ProcessedRecord>(StorageUri.FromFilePath("output.xlsx"), resolver, writeConfig);\n'})}),"\n",(0,s.jsx)(n.h3,{id:"type-detection-configuration",children:"Type Detection Configuration"}),"\n",(0,s.jsx)(n.p,{children:"ExcelDataReader provides two modes for data type detection:"}),"\n",(0,s.jsx)(n.h4,{id:"fast-mode-default",children:"Fast Mode (Default)"}),"\n",(0,s.jsx)(n.p,{children:"Analyzes only the first N rows to determine data types. Faster but may be less accurate if data types vary throughout the column."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"var fastConfig = new ExcelConfiguration\n{\n    AnalyzeAllColumns = false,\n    AnalyzeInitialRowCount = 50, // Analyze first 50 rows\n    FirstRowIsHeader = true\n};\n"})}),"\n",(0,s.jsx)(n.h4,{id:"accurate-mode",children:"Accurate Mode"}),"\n",(0,s.jsx)(n.p,{children:"Analyzes all rows in each column to determine the most appropriate data type. Slower but more accurate."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"var accurateConfig = new ExcelConfiguration\n{\n    AnalyzeAllColumns = true,\n    FirstRowIsHeader = true\n};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"encoding-configuration",children:"Encoding Configuration"}),"\n",(0,s.jsx)(n.p,{children:"For legacy XLS files with text data, you may need to specify an explicit encoding:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'using System.Text;\n\nvar encodingConfig = new ExcelConfiguration\n{\n    Encoding = Encoding.GetEncoding("Windows-1252"), // Western European encoding\n    FirstRowIsHeader = true\n};\n\nvar resolver = StorageProviderFactory.CreateResolver().Resolver;\nvar source = new ExcelSourceNode<LegacyRecord>(StorageUri.FromFilePath("legacy_data.xls"), resolver, encodingConfig);\n'})}),"\n",(0,s.jsx)(n.h3,{id:"example-transforming-and-writing-to-excel",children:"Example: Transforming and Writing to Excel"}),"\n",(0,s.jsx)(n.p,{children:"This pipeline transforms product data and writes the result to a new Excel file."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'using NPipeline.Connectors.Excel;\nusing NPipeline.Execution;\nusing NPipeline.Nodes;\nusing NPipeline.Pipeline;\n\npublic sealed record ProductSummary(string Name, string Category, string PriceRange);\n\npublic sealed class ProductSummarizer : TransformNode<Product, ProductSummary>\n{\n    public override Task<ProductSummary> ExecuteAsync(\n        Product item,\n        PipelineContext context,\n        CancellationToken cancellationToken)\n    {\n        var priceRange = item.Price switch\n        {\n            < 10 => "Low",\n            < 20 => "Medium",\n            _ => "High"\n        };\n        return Task.FromResult(new ProductSummary(item.Name, item.Category, priceRange));\n    }\n}\n\npublic sealed class ExcelTransformPipeline : IPipelineDefinition\n{\n    public void Define(PipelineBuilder builder, PipelineContext context)\n    {\n        var resolver = StorageProviderFactory.CreateResolver().Resolver;\n        var source = builder.AddSource("excel_source", new ExcelSourceNode<Product>(StorageUri.FromFilePath("products.xlsx"), resolver));\n        var transform = builder.AddTransform<ProductSummarizer, Product, ProductSummary>("summarizer");\n        var sink = builder.AddSink("excel_sink", new ExcelSinkNode<ProductSummary>(StorageUri.FromFilePath("summaries.xlsx"), resolver));\n\n        builder.Connect(source, transform);\n        builder.Connect(transform, sink);\n    }\n}\n\npublic class Program\n{\n    public static async Task Main(string[] args)\n    {\n        var runner = PipelineRunner.Create();\n        await runner.RunAsync<ExcelTransformPipeline>();\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["After running, this will create a ",(0,s.jsx)(n.code,{children:"summaries.xlsx"})," file with the following content:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Name"}),(0,s.jsx)(n.th,{children:"Category"}),(0,s.jsx)(n.th,{children:"PriceRange"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Widget"}),(0,s.jsx)(n.td,{children:"Electronics"}),(0,s.jsx)(n.td,{children:"Medium"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Gadget"}),(0,s.jsx)(n.td,{children:"Electronics"}),(0,s.jsx)(n.td,{children:"High"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Tool"}),(0,s.jsx)(n.td,{children:"Hardware"}),(0,s.jsx)(n.td,{children:"Low"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"supported-data-types",children:"Supported Data Types"}),"\n",(0,s.jsx)(n.p,{children:"The Excel connector supports automatic type conversion for the following .NET types:"}),"\n",(0,s.jsx)(n.h3,{id:"primitive-types",children:"Primitive Types"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"int"}),", ",(0,s.jsx)(n.code,{children:"long"}),", ",(0,s.jsx)(n.code,{children:"short"})," (and nullable variants)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"float"}),", ",(0,s.jsx)(n.code,{children:"double"}),", ",(0,s.jsx)(n.code,{children:"decimal"})," (and nullable variants)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"bool"})," (and nullable variant)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"string-types",children:"String Types"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"string"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"datetime-types",children:"Date/Time Types"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"DateTime"})," (and nullable variant)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"guid-types",children:"GUID Types"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Guid"})," (and nullable variant)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"type-conversion-behavior",children:"Type Conversion Behavior"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Reading"}),": ExcelDataReader attempts to convert cell values to the target type automatically. If conversion fails, the property is skipped."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Writing"}),": Values are written with appropriate Excel cell types (Number, String, Boolean, DateTime). Complex types default to string representation."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"format-support",children:"Format Support"}),"\n",(0,s.jsx)(n.h3,{id:"reading",children:"Reading"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Format"}),(0,s.jsx)(n.th,{children:"Extension"}),(0,s.jsx)(n.th,{children:"Library"}),(0,s.jsx)(n.th,{children:"Notes"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Legacy Excel"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:".xls"})}),(0,s.jsx)(n.td,{children:"ExcelDataReader"}),(0,s.jsx)(n.td,{children:"Binary format, supports encoding configuration"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Modern Excel"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:".xlsx"})}),(0,s.jsx)(n.td,{children:"ExcelDataReader"}),(0,s.jsx)(n.td,{children:"Open XML format, UTF-8 encoding"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"writing",children:"Writing"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Format"}),(0,s.jsx)(n.th,{children:"Extension"}),(0,s.jsx)(n.th,{children:"Library"}),(0,s.jsx)(n.th,{children:"Notes"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Modern Excel"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:".xlsx"})}),(0,s.jsx)(n.td,{children:"DocumentFormat.OpenXml"}),(0,s.jsx)(n.td,{children:"Open XML format only"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Legacy Excel"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:".xls"})}),(0,s.jsx)(n.td,{children:"Not supported"}),(0,s.jsx)(n.td,{children:"Use XLSX format instead"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Important"}),": The sink node only supports writing XLSX format. If you need to write legacy XLS files, convert them to XLSX first."]}),"\n",(0,s.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,s.jsx)(n.h3,{id:"reading-performance",children:"Reading Performance"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"ExcelSourceNode<T>"})," uses streaming access for memory-efficient processing of large Excel files:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Streaming"}),": Data is read row-by-row, minimizing memory usage"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Buffer Size"}),": Configure ",(0,s.jsx)(n.a,{href:"../../../src/NPipeline.Connectors.Excel/ExcelConfiguration.cs:42",children:(0,s.jsx)(n.code,{children:"BufferSize"})})," to optimize I/O performance"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Type Detection"}),": Use ",(0,s.jsx)(n.code,{children:"AnalyzeAllColumns = false"})," with appropriate ",(0,s.jsx)(n.code,{children:"AnalyzeInitialRowCount"})," for better performance with large files"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Sheet Selection"}),": Specify ",(0,s.jsx)(n.code,{children:"SheetName"})," explicitly to avoid unnecessary sheet traversal"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"writing-performance",children:"Writing Performance"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"ExcelSinkNode<T>"})," collects all items in memory before writing due to XLSX format requirements:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Memory Usage"}),": All items are collected in a list before writing to the Excel file"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Buffer Size"}),": Configure ",(0,s.jsx)(n.a,{href:"../../../src/NPipeline.Connectors.Excel/ExcelConfiguration.cs:42",children:(0,s.jsx)(n.code,{children:"BufferSize"})})," to optimize I/O performance"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Batching"}),": Consider batching large datasets to manage memory usage"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Sheet Creation"}),": Only creates one sheet per write operation"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"performance-optimization-tips",children:"Performance Optimization Tips"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use appropriate buffer sizes"}),": Increase ",(0,s.jsx)(n.code,{children:"BufferSize"})," for large files, decrease for memory-constrained environments"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Optimize type detection"}),": Use ",(0,s.jsx)(n.code,{children:"AnalyzeAllColumns = false"})," with ",(0,s.jsx)(n.code,{children:"AnalyzeInitialRowCount"})," set appropriately for your data"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Specify sheet names"}),": Avoid unnecessary sheet traversal by specifying ",(0,s.jsx)(n.code,{children:"SheetName"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Batch large writes"}),": For very large datasets, consider splitting into multiple files or batches"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use streaming for reading"}),": Leverage the streaming capability of ",(0,s.jsx)(n.code,{children:"ExcelSourceNode<T>"})," for large files"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"limitations",children:"Limitations"}),"\n",(0,s.jsx)(n.h3,{id:"format-limitations",children:"Format Limitations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"XLS writing not supported"}),": Legacy XLS (binary) format is not supported for writing. Use XLSX format instead."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Single sheet per write"}),": Each ",(0,s.jsx)(n.code,{children:"ExcelSinkNode<T>"})," operation creates a single sheet. Multi-sheet workbooks require multiple write operations."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"memory-limitations",children:"Memory Limitations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Writing requires all data in memory"}),": The sink node collects all items before writing, which may be a concern for very large datasets"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"No streaming write"}),": XLSX format requires all data to be available before writing the file structure"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"type-mapping-limitations",children:"Type Mapping Limitations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Header-less mapping"}),": When ",(0,s.jsx)(n.code,{children:"FirstRowIsHeader = false"}),", properties are mapped by column index using a hash-based approach, which may not be deterministic for all scenarios"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Complex type conversion"}),": Some complex type conversions may fail silently. Ensure your data types are compatible"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Nullable handling"}),": Null values are handled gracefully but may result in empty cells in the output"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Conversion errors"}),": Type conversion errors during reading are silently skipped, and the property is not populated"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Missing sheets"}),": If a specified sheet is not found, an ",(0,s.jsx)(n.code,{children:"InvalidOperationException"})," is thrown"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Missing files"}),": File not found errors are propagated through the storage provider"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsx)(n.h3,{id:"file-format",children:"File Format"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use XLSX format for new files"}),": XLSX is the modern standard and supports both reading and writing"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Convert legacy XLS to XLSX"}),": If you need to write legacy XLS files, convert them to XLSX first"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Specify file extensions"}),": Always include the file extension (",(0,s.jsx)(n.code,{children:".xlsx"})," or ",(0,s.jsx)(n.code,{children:".xls"}),") in your ",(0,s.jsx)(n.code,{children:"StorageUri"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"configuration-2",children:"Configuration"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Specify sheet names explicitly"}),": This improves code clarity and prevents errors when working with multi-sheet workbooks"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enable headers for structured data"}),": Set ",(0,s.jsx)(n.code,{children:"FirstRowIsHeader = true"})," for better property mapping"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Adjust buffer size for large files"}),": Increase ",(0,s.jsx)(n.code,{children:"BufferSize"})," for better I/O performance with large files"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Configure type detection"}),": Choose between fast and accurate type detection based on your data characteristics"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"data-modeling",children:"Data Modeling"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Validate data types"}),": Ensure your model properties match the data types in your Excel files"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use appropriate nullable types"}),": Handle missing or null data with nullable properties"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Keep property names simple"}),": Use property names that match Excel column headers when using header mapping"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Consider string conversion"}),": For complex types, consider converting to strings in your model"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"error-handling-1",children:"Error Handling"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Handle missing sheets"}),": Wrap source node creation in try-catch to handle missing sheet exceptions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Validate data before writing"}),": Ensure data is valid and complete before passing to the sink node"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Monitor memory usage"}),": Be aware of memory consumption when writing large datasets"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Log conversion errors"}),": Consider implementing logging to track type conversion issues"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"performance",children:"Performance"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use streaming for reading"}),": Leverage the streaming capability of ",(0,s.jsx)(n.code,{children:"ExcelSourceNode<T>"})," for large files"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Batch large datasets"}),": Split very large datasets into smaller batches to manage memory usage"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Optimize buffer sizes"}),": Tune ",(0,s.jsx)(n.code,{children:"BufferSize"})," based on your file sizes and system resources"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Profile your workload"}),": Test with representative data to identify performance bottlenecks"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"advanced-scenarios",children:"Advanced Scenarios"}),"\n",(0,s.jsx)(n.h3,{id:"reading-multiple-sheets",children:"Reading Multiple Sheets"}),"\n",(0,s.jsx)(n.p,{children:"To read from multiple sheets in a workbook, create multiple source nodes with different sheet configurations:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'var resolver = StorageProviderFactory.CreateResolver().Resolver;\n\nvar q1Source = new ExcelSourceNode<SalesRecord>(\n    StorageUri.FromFilePath("sales.xlsx"),\n    resolver,\n    new ExcelConfiguration { SheetName = "Q1", FirstRowIsHeader = true }\n);\n\nvar q2Source = new ExcelSourceNode<SalesRecord>(\n    StorageUri.FromFilePath("sales.xlsx"),\n    resolver,\n    new ExcelConfiguration { SheetName = "Q2", FirstRowIsHeader = true }\n);\n\n// Add both sources to your pipeline\nvar q1Node = builder.AddSource("q1_source", q1Source);\nvar q2Node = builder.AddSource("q2_source", q2Source);\n'})}),"\n",(0,s.jsx)(n.h3,{id:"round-trip-processing",children:"Round-Trip Processing"}),"\n",(0,s.jsx)(n.p,{children:"Read from an Excel file, process the data, and write back to a new Excel file:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'public sealed class RoundTripPipeline : IPipelineDefinition\n{\n    public void Define(PipelineBuilder builder, PipelineContext context)\n    {\n        var resolver = StorageProviderFactory.CreateResolver().Resolver;\n\n        // Read from input file\n        var source = builder.AddSource(\n            "excel_source",\n            new ExcelSourceNode<Product>(\n                StorageUri.FromFilePath("input.xlsx"),\n                resolver,\n                new ExcelConfiguration { SheetName = "RawData", FirstRowIsHeader = true }\n            )\n        );\n\n        // Process data\n        var transform = builder.AddTransform<ProductProcessor, Product, Product>("processor");\n\n        // Write to output file\n        var sink = builder.AddSink(\n            "excel_sink",\n            new ExcelSinkNode<Product>(\n                StorageUri.FromFilePath("output.xlsx"),\n                resolver,\n                new ExcelConfiguration { SheetName = "ProcessedData", FirstRowIsHeader = true }\n            )\n        );\n\n        builder.Connect(source, transform);\n        builder.Connect(transform, sink);\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"working-with-legacy-xls-files",children:"Working with Legacy XLS Files"}),"\n",(0,s.jsx)(n.p,{children:"Read legacy XLS files with explicit encoding:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'using System.Text;\n\nvar legacyConfig = new ExcelConfiguration\n{\n    Encoding = Encoding.GetEncoding("Windows-1252"),\n    FirstRowIsHeader = true,\n    AnalyzeInitialRowCount = 100\n};\n\nvar resolver = StorageProviderFactory.CreateResolver().Resolver;\nvar source = new ExcelSourceNode<LegacyRecord>(\n    StorageUri.FromFilePath("old_data.xls"),\n    resolver,\n    legacyConfig\n);\n'})}),"\n",(0,s.jsx)(n.h3,{id:"handling-mixed-data-types",children:"Handling Mixed Data Types"}),"\n",(0,s.jsx)(n.p,{children:"When columns contain mixed data types, use accurate type detection:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:'var mixedDataConfig = new ExcelConfiguration\n{\n    AnalyzeAllColumns = true, // Analyze all rows for accurate type detection\n    FirstRowIsHeader = true\n};\n\nvar resolver = StorageProviderFactory.CreateResolver().Resolver;\nvar source = new ExcelSourceNode<MixedDataRecord>(\n    StorageUri.FromFilePath("mixed_data.xlsx"),\n    resolver,\n    mixedDataConfig\n);\n'})}),"\n",(0,s.jsx)(n.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"../.",children:"NPipeline Extensions Index"})}),": Return to the extensions overview."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/docs/connectors/csv",children:"CSV Connector"})}),": Learn about working with CSV files."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"/docs/connectors/storage-provider",children:"Storage Provider Interface"})}),": Understand the storage layer architecture."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);