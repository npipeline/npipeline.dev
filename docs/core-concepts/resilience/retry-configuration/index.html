<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-core-concepts/resilience/retry-configuration" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Retry Configuration | NPipeline</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="robots" content="noindex, nofollow"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://npipeline.dev/docs/core-concepts/resilience/retry-configuration"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Retry Configuration | NPipeline"><meta data-rh="true" name="description" content="Learn how to configure retry behavior in NPipeline using PipelineRetryOptions to manage item retries and node restarts."><meta data-rh="true" property="og:description" content="Learn how to configure retry behavior in NPipeline using PipelineRetryOptions to manage item retries and node restarts."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://npipeline.dev/docs/core-concepts/resilience/retry-configuration"><link data-rh="true" rel="alternate" href="https://npipeline.dev/docs/core-concepts/resilience/retry-configuration" hreflang="en"><link data-rh="true" rel="alternate" href="https://npipeline.dev/docs/core-concepts/resilience/retry-configuration" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Core Concepts","item":"https://npipeline.dev/docs/core-concepts"},{"@type":"ListItem","position":2,"name":"Resilience","item":"https://npipeline.dev/docs/core-concepts/resilience/"},{"@type":"ListItem","position":3,"name":"Retry Configuration","item":"https://npipeline.dev/docs/core-concepts/resilience/retry-configuration"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="NPipeline RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="NPipeline Atom Feed"><link rel="stylesheet" href="/assets/css/styles.a2968c5d.css">
<script src="/assets/js/runtime~main.b24054ed.js" defer="defer"></script>
<script src="/assets/js/main.e01f4df8.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="NPipeline logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="NPipeline logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">NPipeline</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/npipeline/npipeline" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/"><span title="Welcome to NPipeline" class="linkLabel_WmDU">Welcome to NPipeline</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/introduction"><span title="Introduction" class="categoryLinkLabel_W154">Introduction</span></a><button aria-label="Expand sidebar category &#x27;Introduction&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/learning-paths"><span title="Learning Paths" class="linkLabel_WmDU">Learning Paths</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/getting-started"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/docs/core-concepts"><span title="Core Concepts" class="categoryLinkLabel_W154">Core Concepts</span></a><button aria-label="Collapse sidebar category &#x27;Core Concepts&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/grouping-strategies"><span title="Grouping Strategies - Batching vs Aggregation" class="linkLabel_WmDU">Grouping Strategies - Batching vs Aggregation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/ipipeline"><span title="Pipeline" class="linkLabel_WmDU">Pipeline</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/data-pipes"><span title="Data Pipes (IDataPipe)" class="linkLabel_WmDU">Data Pipes (IDataPipe)</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/core-concepts/nodes/"><span title="Nodes" class="categoryLinkLabel_W154">Nodes</span></a><button aria-label="Collapse sidebar category &#x27;Nodes&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/nodes/source-nodes"><span title="Source Nodes" class="linkLabel_WmDU">Source Nodes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/nodes/transform-nodes"><span title="Transform Nodes" class="linkLabel_WmDU">Transform Nodes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/nodes/sink-nodes"><span title="Sink Nodes" class="linkLabel_WmDU">Sink Nodes</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/core-concepts/resilience/"><span title="Resilience" class="categoryLinkLabel_W154">Resilience</span></a><button aria-label="Collapse sidebar category &#x27;Resilience&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/resilience/error-handling-guide"><span title="Error Handling in NPipeline" class="linkLabel_WmDU">Error Handling in NPipeline</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/resilience/execution-with-resilience"><span title="Execution with Resilience" class="linkLabel_WmDU">Execution with Resilience</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/resilience/node-restart-quickstart"><span title="Node Restart - Quick Start Checklist" class="linkLabel_WmDU">Node Restart - Quick Start Checklist</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/resilience/circuit-breaker-advanced-configuration"><span title="Circuit Breaker Advanced Configuration" class="linkLabel_WmDU">Circuit Breaker Advanced Configuration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/resilience/materialization-and-buffering"><span title="Materialization and Buffering" class="linkLabel_WmDU">Materialization and Buffering</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/resilience/dependency-chains"><span title="Dependency Chains" class="linkLabel_WmDU">Dependency Chains</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/resilience/configuration-guide"><span title="Configuration Guide" class="linkLabel_WmDU">Configuration Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/resilience/troubleshooting"><span title="Troubleshooting" class="linkLabel_WmDU">Troubleshooting</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/core-concepts/resilience/retry-configuration"><span title="Retry Configuration" class="linkLabel_WmDU">Retry Configuration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/resilience/circuit-breaker-configuration"><span title="Circuit Breaker Configuration" class="linkLabel_WmDU">Circuit Breaker Configuration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/resilience/dead-letter-queues"><span title="Dead-Letter Queues" class="linkLabel_WmDU">Dead-Letter Queues</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/core-concepts/advanced-nodes"><span title="Advanced Nodes" class="categoryLinkLabel_W154">Advanced Nodes</span></a><button aria-label="Expand sidebar category &#x27;Advanced Nodes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/pipeline-definition"><span title="Pipeline Definition (IPipelineDefinition, PipelineBuilder)" class="linkLabel_WmDU">Pipeline Definition (IPipelineDefinition, PipelineBuilder)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/pipelinebuilder"><span title="PipelineBuilder" class="linkLabel_WmDU">PipelineBuilder</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/core-concepts/pipeline-execution"><span title="Pipeline Execution" class="categoryLinkLabel_W154">Pipeline Execution</span></a><button aria-label="Expand sidebar category &#x27;Pipeline Execution&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/pipeline-context"><span title="Pipeline Context (PipelineContext)" class="linkLabel_WmDU">Pipeline Context (PipelineContext)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/common-patterns"><span title="Common Patterns" class="linkLabel_WmDU">Common Patterns</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/streaming-vs-buffering"><span title="Streaming vs. Buffering" class="linkLabel_WmDU">Streaming vs. Buffering</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/best-practices"><span title="Best Practices" class="linkLabel_WmDU">Best Practices</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/pipeline-validation"><span title="Pipeline Validation Extensions - Usage Guide" class="linkLabel_WmDU">Pipeline Validation Extensions - Usage Guide</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/architecture/"><span title="Architecture" class="categoryLinkLabel_W154">Architecture</span></a><button aria-label="Collapse sidebar category &#x27;Architecture&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/core-concepts"><span title="Core Concepts" class="linkLabel_WmDU">Core Concepts</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/component-architecture"><span title="Component Architecture" class="linkLabel_WmDU">Component Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/execution-flow"><span title="Execution Flow" class="linkLabel_WmDU">Execution Flow</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/data-flow"><span title="Data Flow Details" class="linkLabel_WmDU">Data Flow Details</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/dependency-injection"><span title="Dependency Injection Integration" class="linkLabel_WmDU">Dependency Injection Integration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/error-handling-architecture"><span title="Error Handling Architecture" class="linkLabel_WmDU">Error Handling Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/cancellation-model"><span title="Cancellation Model" class="linkLabel_WmDU">Cancellation Model</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/performance-characteristics"><span title="Performance Characteristics" class="linkLabel_WmDU">Performance Characteristics</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/extension-points"><span title="Extension Points" class="linkLabel_WmDU">Extension Points</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/design-principles"><span title="Design Principles" class="linkLabel_WmDU">Design Principles</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/optimization-principles"><span title="Optimization Principles - How NPipeline Achieves High Performance" class="linkLabel_WmDU">Optimization Principles - How NPipeline Achieves High Performance</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/extensions"><span title="Extensions" class="categoryLinkLabel_W154">Extensions</span></a><button aria-label="Expand sidebar category &#x27;Extensions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/connectors"><span title="Connectors" class="categoryLinkLabel_W154">Connectors</span></a><button aria-label="Expand sidebar category &#x27;Connectors&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/advanced-topics"><span title="Advanced Topics" class="categoryLinkLabel_W154">Advanced Topics</span></a><button aria-label="Expand sidebar category &#x27;Advanced Topics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/analyzers/"><span title="Build-Time Analyzers" class="categoryLinkLabel_W154">Build-Time Analyzers</span></a><button aria-label="Expand sidebar category &#x27;Build-Time Analyzers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/samples-guide"><span title="Sample Applications" class="linkLabel_WmDU">Sample Applications</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/reference"><span title="Reference" class="categoryLinkLabel_W154">Reference</span></a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/core-concepts"><span>Core Concepts</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/core-concepts/resilience/"><span>Resilience</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Retry Configuration</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Retry Configuration</h1></header>
<p>Retry configuration in NPipeline allows you to define how the pipeline should respond to transient failures by retrying operations. This is essential for building resilient pipelines that can recover from temporary issues without manual intervention.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" translate="no">​</a></h2>
<p>NPipeline provides configurable retry options that control both individual item retries (for node-level errors) and node restart attempts (for pipeline-level errors). These options can be set globally for the entire pipeline or overridden for specific nodes.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="pipelineretryoptions">PipelineRetryOptions<a href="#pipelineretryoptions" class="hash-link" aria-label="Direct link to PipelineRetryOptions" title="Direct link to PipelineRetryOptions" translate="no">​</a></h2>
<p>The <a class="" href="/docs/src/NPipeline/Configuration/PipelineRetryOptions.cs"><code>PipelineRetryOptions</code></a> record configures retry behavior for items and node restarts.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record PipelineRetryOptions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int MaxItemRetries,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int MaxNodeRestartAttempts,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int MaxSequentialNodeAttempts,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int? MaxMaterializedItems = null) // Null =&gt; unbounded (no cap)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static PipelineRetryOptions Default { get; } = new(0, 3, 5);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public PipelineRetryOptions With(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int? maxItemRetries = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int? maxNodeRestartAttempts = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int? maxSequentialNodeAttempts = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int? maxMaterializedItems = null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new PipelineRetryOptions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            maxItemRetries ?? MaxItemRetries,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            maxNodeRestartAttempts ?? MaxNodeRestartAttempts,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            maxSequentialNodeAttempts ?? MaxSequentialNodeAttempts,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            maxMaterializedItems ?? MaxMaterializedItems);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<ul>
<li class=""><strong><code>MaxItemRetries</code></strong>: The maximum number of times an individual item will be re-processed by a node&#x27;s execution strategy if its <code>INodeErrorHandler</code> returns <code>NodeErrorDecision.Retry</code>.</li>
<li class=""><strong><code>MaxNodeRestartAttempts</code></strong>: The maximum number of times a node&#x27;s entire stream will be re-executed by <code>ResilientExecutionStrategy</code> if <code>IPipelineErrorHandler</code> returns <code>PipelineErrorDecision.RestartNode</code>.</li>
<li class=""><strong><code>MaxSequentialNodeAttempts</code></strong>: (Used by <code>SequentialExecutionStrategy</code> for node restarts) The maximum number of attempts for a node in a sequential pipeline.</li>
<li class=""><strong><code>MaxMaterializedItems</code></strong>: An optional cap on the number of items to materialize (buffer) for replay when using <code>ResilientExecutionStrategy</code>.<!-- -->
<ul>
<li class="">When <code>null</code> (default): Unbounded materialization - all items are buffered</li>
<li class="">When has a value: Limited materialization - only the specified number of items are buffered, after which new items replace the oldest ones</li>
<li class="">This parameter prevents excessive memory consumption in case of large streams and is particularly important for long-running pipelines with high throughput</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="basic-retry-configuration">Basic Retry Configuration<a href="#basic-retry-configuration" class="hash-link" aria-label="Direct link to Basic Retry Configuration" title="Direct link to Basic Retry Configuration" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="global-retry-options">Global Retry Options<a href="#global-retry-options" class="hash-link" aria-label="Direct link to Global Retry Options" title="Direct link to Global Retry Options" translate="no">​</a></h3>
<p>You can set retry options globally for the pipeline:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline.Nodes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline.Pipeline;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed class RetryPipelineDefinition : IPipelineDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void Define(PipelineBuilder builder, PipelineContext context)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var sourceHandle = builder.AddSource&lt;DataSource, string&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var transformHandle = builder.AddTransform&lt;DataTransform, string, string&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var sinkHandle = builder.AddSink&lt;DataSink, string&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(sourceHandle, transformHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(transformHandle, sinkHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Configure retry policy using PipelineRetryOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.WithRetryOptions(new PipelineRetryOptions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MaxItemRetries: 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MaxNodeRestartAttempts: 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MaxSequentialNodeAttempts: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static class Program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static async Task Main(string[] args)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var runner = new PipelineRunner();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await runner.RunAsync&lt;RetryPipelineDefinition&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="per-node-retry-options">Per-Node Retry Options<a href="#per-node-retry-options" class="hash-link" aria-label="Direct link to Per-Node Retry Options" title="Direct link to Per-Node Retry Options" translate="no">​</a></h3>
<p>You can override the global retry options for a specific node using the <code>WithRetryOptions</code> method that accepts a <code>NodeHandle</code>:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline.Nodes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline.Pipeline;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed class PerNodeRetryPipelineDefinition : IPipelineDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void Define(PipelineBuilder builder, PipelineContext context)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var sourceHandle = builder.AddSource&lt;DataSource, string&gt;(&quot;source&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var criticalTransformHandle = builder.AddTransform&lt;CriticalDataTransform, string, string&gt;(&quot;critical-transform&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var normalTransformHandle = builder.AddTransform&lt;NormalDataTransform, string, string&gt;(&quot;normal-transform&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var sinkHandle = builder.AddSink&lt;DataSink, string&gt;(&quot;sink&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(sourceHandle, criticalTransformHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(criticalTransformHandle, normalTransformHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(normalTransformHandle, sinkHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Configure global retry options (default for all nodes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.WithRetryOptions(new PipelineRetryOptions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MaxItemRetries: 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MaxNodeRestartAttempts: 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MaxSequentialNodeAttempts: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Override retry options for the critical transform</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.WithRetryOptions(criticalTransformHandle, new PipelineRetryOptions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MaxItemRetries: 5,              // More retries for critical processing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MaxNodeRestartAttempts: 10,      // More restart attempts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MaxSequentialNodeAttempts: 15,   // Higher total attempt limit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MaxMaterializedItems: 1000       // Higher memory limit for replay</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="use-cases-for-per-node-retry-configuration">Use Cases for Per-Node Retry Configuration<a href="#use-cases-for-per-node-retry-configuration" class="hash-link" aria-label="Direct link to Use Cases for Per-Node Retry Configuration" title="Direct link to Use Cases for Per-Node Retry Configuration" translate="no">​</a></h4>
<p>Per-node retry options are useful in scenarios where different parts of your pipeline have different resilience requirements:</p>
<p><strong>1. External API Calls vs. Internal Processing</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// More aggressive retries for external API calls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.WithRetryOptions(apiTransformHandle, new PipelineRetryOptions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxItemRetries: 5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxNodeRestartAttempts: 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxSequentialNodeAttempts: 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Conservative retries for internal data processing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.WithRetryOptions(internalTransformHandle, new PipelineRetryOptions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxItemRetries: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxNodeRestartAttempts: 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxSequentialNodeAttempts: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">));</span><br></span></code></pre></div></div>
<p><strong>2. Critical vs. Non-Critical Processing</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Maximum resilience for critical business logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.WithRetryOptions(criticalProcessorHandle, new PipelineRetryOptions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxItemRetries: 10,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxNodeRestartAttempts: 5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxSequentialNodeAttempts: 20,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxMaterializedItems: 5000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Best-effort processing for non-critical data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.WithRetryOptions(loggingProcessorHandle, new PipelineRetryOptions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxItemRetries: 0,  // No retries for logging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxNodeRestartAttempts: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxSequentialNodeAttempts: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">));</span><br></span></code></pre></div></div>
<p><strong>3. Resource-Intensive Operations</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Limited retries for memory-intensive operations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.WithRetryOptions(memoryIntensiveHandle, new PipelineRetryOptions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxItemRetries: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxNodeRestartAttempts: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxSequentialNodeAttempts: 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxMaterializedItems: 100  // Strict memory limit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">));</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="precedence-rules">Precedence Rules<a href="#precedence-rules" class="hash-link" aria-label="Direct link to Precedence Rules" title="Direct link to Precedence Rules" translate="no">​</a></h4>
<p>When both global and per-node retry options are configured:</p>
<ol>
<li class=""><strong>Per-node options take precedence</strong> over global options</li>
<li class=""><strong>Unspecified properties</strong> in per-node options inherit from global options</li>
<li class=""><strong>Global options</strong> apply to all nodes without specific overrides</li>
</ol>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Global configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.WithRetryOptions(new PipelineRetryOptions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxItemRetries: 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxNodeRestartAttempts: 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxSequentialNodeAttempts: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Per-node override (only MaxItemRetries is overridden)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">builder.WithRetryOptions(specificNodeHandle, new PipelineRetryOptions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxItemRetries: 5,              // Overridden</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxNodeRestartAttempts: 3,       // Inherited from global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MaxSequentialNodeAttempts: 5      // Inherited from global</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">));</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="integrating-external-retry-libraries">Integrating External Retry Libraries<a href="#integrating-external-retry-libraries" class="hash-link" aria-label="Direct link to Integrating External Retry Libraries" title="Direct link to Integrating External Retry Libraries" translate="no">​</a></h2>
<p>For advanced retry patterns like exponential backoff and jitter, you can integrate external libraries like Polly:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using Polly;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using Polly.Retry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline.ErrorHandling;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class AdvancedRetryHandler : INodeErrorHandler&lt;ITransformNode&lt;string, string&gt;, string&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly AsyncRetryPolicy _retryPolicy;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public AdvancedRetryHandler()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Configure exponential backoff with jitter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _retryPolicy = Policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .Handle&lt;HttpRequestException&gt;() // Retry on network errors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .WaitAndRetryAsync(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                retryCount: 5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sleepDurationProvider: retryAttempt =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    TimeSpan.FromSeconds(Math.Pow(2, retryAttempt)) + // Exponential backoff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    TimeSpan.FromMilliseconds(new Random().Next(0, 1000)), // Add jitter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                onRetry: (outcome, timespan, retryAttempt, context) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Console.WriteLine($&quot;Retry {retryAttempt} after {timespan.TotalSeconds}s due to: {outcome.Exception?.Message}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;NodeErrorDecision&gt; HandleAsync(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ITransformNode&lt;string, string&gt; node,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string failedItem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Exception error,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PipelineContext context,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CancellationToken cancellationToken)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (error is HttpRequestException)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // Execute the retry policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                await _retryPolicy.ExecuteAsync(async () =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // In a real implementation, you would re-execute the node logic here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // This is a simplified example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Console.WriteLine($&quot;Retrying processing of: {failedItem}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    await Task.Delay(100, cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return NodeErrorDecision.Retry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            catch (Exception ex)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Console.WriteLine($&quot;All retries failed: {ex.Message}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return NodeErrorDecision.DeadLetter; // Send to dead-letter after all retries fail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return NodeErrorDecision.Skip; // For other error types, just skip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="retry-strategies">Retry Strategies<a href="#retry-strategies" class="hash-link" aria-label="Direct link to Retry Strategies" title="Direct link to Retry Strategies" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="fixed-delay-retry">Fixed Delay Retry<a href="#fixed-delay-retry" class="hash-link" aria-label="Direct link to Fixed Delay Retry" title="Direct link to Fixed Delay Retry" translate="no">​</a></h3>
<p>The simplest retry strategy uses a fixed delay between attempts:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class FixedDelayRetryHandler : INodeErrorHandler&lt;ITransformNode&lt;string, string&gt;, string&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly TimeSpan _delay = TimeSpan.FromSeconds(2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly ILogger _logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public FixedDelayRetryHandler(ILogger logger)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger = logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;NodeErrorDecision&gt; HandleAsync(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ITransformNode&lt;string, string&gt; node,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string failedItem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Exception error,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PipelineContext context,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CancellationToken cancellationToken)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (IsTransientError(error))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _logger.LogInformation(&quot;Retrying in {Delay}ms for item: {Item}&quot;, _delay.TotalMilliseconds, failedItem);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await Task.Delay(_delay, cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return NodeErrorDecision.Retry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return NodeErrorDecision.Skip;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static bool IsTransientError(Exception error)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return error is TimeoutException or HttpRequestException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="exponential-backoff-with-jitter">Exponential Backoff with Jitter<a href="#exponential-backoff-with-jitter" class="hash-link" aria-label="Direct link to Exponential Backoff with Jitter" title="Direct link to Exponential Backoff with Jitter" translate="no">​</a></h3>
<p>Exponential backoff with jitter is a more sophisticated strategy that helps prevent thundering herd problems:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class ExponentialBackoffRetryHandler : INodeErrorHandler&lt;ITransformNode&lt;string, string&gt;, string&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly TimeSpan _baseDelay = TimeSpan.FromSeconds(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly TimeSpan _maxDelay = TimeSpan.FromMinutes(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly Random _jitter = new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly ILogger _logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ExponentialBackoffRetryHandler(ILogger logger)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger = logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;NodeErrorDecision&gt; HandleAsync(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ITransformNode&lt;string, string&gt; node,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string failedItem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Exception error,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PipelineContext context,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CancellationToken cancellationToken)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (IsTransientError(error))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Get retry count from context (you would need to implement this)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var retryCount = GetRetryCount(context, failedItem);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Calculate exponential delay with jitter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var exponentialDelay = TimeSpan.FromSeconds(Math.Pow(2, retryCount));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var jitter = TimeSpan.FromMilliseconds(_jitter.Next(0, 1000));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var delay = TimeSpan.FromTicks(Math.Min(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                (_baseDelay + exponentialDelay + jitter).Ticks,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                _maxDelay.Ticks));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _logger.LogInformation(&quot;Retrying in {Delay}ms (attempt {RetryCount}) for item: {Item}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                delay.TotalMilliseconds, retryCount + 1, failedItem);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await Task.Delay(delay, cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return NodeErrorDecision.Retry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return NodeErrorDecision.Skip;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static bool IsTransientError(Exception error)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return error is TimeoutException or HttpRequestException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private int GetRetryCount(PipelineContext context, string item)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // In a real implementation, you would track retry count in the context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // This is a simplified example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="context-aware-retry">Context-Aware Retry<a href="#context-aware-retry" class="hash-link" aria-label="Direct link to Context-Aware Retry" title="Direct link to Context-Aware Retry" translate="no">​</a></h2>
<p>Sometimes you want to adjust retry behavior based on the context:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class ContextAwareRetryHandler : INodeErrorHandler&lt;ITransformNode&lt;string, string&gt;, string&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly ILogger _logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly Dictionary&lt;string, RetryPolicy&gt; _policies;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ContextAwareRetryHandler(ILogger logger)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger = logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _policies = new Dictionary&lt;string, RetryPolicy&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [&quot;critical&quot;] = new RetryPolicy(maxRetries: 5, baseDelay: TimeSpan.FromSeconds(1)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [&quot;normal&quot;] = new RetryPolicy(maxRetries: 3, baseDelay: TimeSpan.FromSeconds(2)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [&quot;low&quot;] = new RetryPolicy(maxRetries: 1, baseDelay: TimeSpan.FromSeconds(5))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;NodeErrorDecision&gt; HandleAsync(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ITransformNode&lt;string, string&gt; node,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string failedItem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Exception error,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PipelineContext context,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CancellationToken cancellationToken)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Determine priority from context or item</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var priority = GetPriority(context, failedItem);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var policy = _policies[priority];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (IsTransientError(error) &amp;&amp; policy.CanRetry)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _logger.LogInformation(&quot;Retrying with {Priority} policy (attempt {RetryCount}/{MaxRetries}) for item: {Item}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                priority, policy.CurrentRetry + 1, policy.MaxRetries, failedItem);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await Task.Delay(policy.GetDelay(), cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            policy.IncrementRetry();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return NodeErrorDecision.Retry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return NodeErrorDecision.Skip;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static bool IsTransientError(Exception error)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return error is TimeoutException or HttpRequestException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private string GetPriority(PipelineContext context, string item)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // In a real implementation, you would determine priority from context or item</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // This is a simplified example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return item.Contains(&quot;critical&quot;) ? &quot;critical&quot; :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               item.Contains(&quot;low&quot;) ? &quot;low&quot; : &quot;normal&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private class RetryPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public int MaxRetries { get; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public TimeSpan BaseDelay { get; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public int CurrentRetry { get; private set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public bool CanRetry =&gt; CurrentRetry &lt; MaxRetries;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public RetryPolicy(int maxRetries, TimeSpan baseDelay)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MaxRetries = maxRetries;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            BaseDelay = baseDelay;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public TimeSpan GetDelay()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Simple exponential backoff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return TimeSpan.FromSeconds(Math.Pow(2, CurrentRetry) * BaseDelay.TotalSeconds);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void IncrementRetry()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            CurrentRetry++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices" translate="no">​</a></h2>
<ol>
<li class="">
<p><strong>Differentiate between transient and permanent errors</strong>: Only retry transient errors that might resolve themselves.</p>
</li>
<li class="">
<p><strong>Implement appropriate delays</strong>: Use delays between retries to give the system time to recover.</p>
</li>
<li class="">
<p><strong>Set reasonable retry limits</strong>: Prevent infinite loops by setting maximum retry counts.</p>
</li>
<li class="">
<p><strong>Use jitter in distributed systems</strong>: Add randomness to retry delays to prevent thundering herd problems.</p>
</li>
<li class="">
<p><strong>Monitor retry patterns</strong>: Track retry metrics to identify systemic issues.</p>
</li>
<li class="">
<p><strong>Consider resource constraints</strong>: Be mindful of the resources consumed by retries, especially in high-volume scenarios.</p>
</li>
<li class="">
<p><strong>Implement circuit breakers</strong>: Combine retries with circuit breakers to prevent cascading failures.</p>
</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="production-example">Production Example<a href="#production-example" class="hash-link" aria-label="Direct link to Production Example" title="Direct link to Production Example" translate="no">​</a></h2>
<p>Here&#x27;s a comprehensive example that combines multiple retry strategies:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline.ErrorHandling;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline.Pipeline;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ProductionRetryHandler : INodeErrorHandler&lt;ITransformNode&lt;string, string&gt;, string&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly ILogger _logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly IMetrics _metrics;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly Dictionary&lt;string, RetryState&gt; _retryStates = new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly TimeSpan _baseDelay = TimeSpan.FromSeconds(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly TimeSpan _maxDelay = TimeSpan.FromMinutes(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private readonly Random _jitter = new();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private class RetryState</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public int RetryCount { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public DateTime FirstFailureTime { get; set; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ProductionRetryHandler(ILogger logger, IMetrics metrics)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger = logger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _metrics = metrics;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;NodeErrorDecision&gt; HandleAsync(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ITransformNode&lt;string, string&gt; node,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string failedItem,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Exception error,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PipelineContext context,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CancellationToken cancellationToken)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var itemKey = $&quot;{node.Id}:{failedItem}&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (!_retryStates.TryGetValue(itemKey, out var retryState))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            retryState = new RetryState { FirstFailureTime = DateTime.UtcNow };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _retryStates[itemKey] = retryState;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Record metrics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _metrics.Increment(&quot;item_retries&quot;, new[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new KeyValuePair&lt;string, object&gt;(&quot;node_id&quot;, node.Id),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new KeyValuePair&lt;string, object&gt;(&quot;error_type&quot;, error.GetType().Name),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new KeyValuePair&lt;string, object&gt;(&quot;retry_count&quot;, retryState.RetryCount)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (IsTransientError(error))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Check if we&#x27;ve exceeded the maximum retry count</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (retryState.RetryCount &gt;= 3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                _logger.LogWarning(&quot;Maximum retries exceeded for item {Item} in node {NodeId}&quot;, failedItem, node.Id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                _retryStates.Remove(itemKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return NodeErrorDecision.DeadLetter;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Calculate delay with exponential backoff and jitter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var exponentialDelay = TimeSpan.FromSeconds(Math.Pow(2, retryState.RetryCount));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var jitter = TimeSpan.FromMilliseconds(_jitter.Next(0, 1000));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var delay = TimeSpan.FromTicks(Math.Min(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                (_baseDelay + exponentialDelay + jitter).Ticks,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                _maxDelay.Ticks));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _logger.LogInformation(&quot;Retrying item {Item} in node {NodeId} (attempt {RetryCount}/{MaxRetries}) after {Delay}ms&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                failedItem, node.Id, retryState.RetryCount + 1, 3, delay.TotalMilliseconds);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            retryState.RetryCount++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            await Task.Delay(delay, cancellationToken);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return NodeErrorDecision.Retry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // For non-transient errors, don&#x27;t retry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _logger.LogWarning(&quot;Non-transient error for item {Item} in node {NodeId}: {ErrorType}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            failedItem, node.Id, error.GetType().Name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _retryStates.Remove(itemKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return NodeErrorDecision.Skip;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static bool IsTransientError(Exception error)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return error is TimeoutException or HttpRequestException or OperationCanceledException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<blockquote>
<p>⚠️<!-- --> Materialization Requirements
When configuring retries with <code>MaxMaterializedItems</code>, it&#x27;s important to understand how buffering enables replay functionality. Materialization is critical because it creates a snapshot of input items that can be replayed if a node fails and needs to restart, preventing data loss and ensuring processing continuity. See <a class="" href="/docs/core-concepts/resilience/materialization-and-buffering">Materialization and Buffering</a> in the resilience section for detailed guidance.</p>
</blockquote>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="see-also">See Also<a href="#see-also" class="hash-link" aria-label="Direct link to See Also" title="Direct link to See Also" translate="no">​</a></h2>
<ul>
<li class=""><strong><a class="" href="/docs/core-concepts/resilience/">Resilience Overview</a></strong>: Comprehensive guide to building fault-tolerant pipelines</li>
<li class=""><strong><a class="" href="/docs/core-concepts/resilience/materialization-and-buffering">Materialization and Buffering</a></strong>: Understanding buffer requirements for resilience</li>
<li class=""><strong><a class="" href="/docs/core-concepts/resilience/configuration-guide">Configuration Guide</a></strong>: Practical implementation guidance with code examples</li>
<li class=""><strong><a class="" href="/docs/core-concepts/resilience/troubleshooting">Troubleshooting</a></strong>: Diagnose and resolve common resilience issues</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="related-topics">Related Topics<a href="#related-topics" class="hash-link" aria-label="Direct link to Related Topics" title="Direct link to Related Topics" translate="no">​</a></h2>
<ul>
<li class=""><strong><a class="" href="/docs/core-concepts/resilience/error-handling-guide">Node-level Error Handling</a></strong>: Learn about handling errors for individual items.</li>
<li class=""><strong><a class="" href="/docs/core-concepts/resilience/error-handling-guide">Pipeline-level Error Handling</a></strong>: Learn about handling errors that affect entire node streams.</li>
<li class=""><strong><a class="" href="/docs/core-concepts/resilience/circuit-breaker-configuration">Circuit Breaker Configuration</a></strong>: Configure circuit breaker patterns.</li>
<li class=""><strong><a class="" href="/docs/core-concepts/resilience/dead-letter-queues">Dead-Letter Queues</a></strong>: Implement dead-letter queues for problematic items.</li>
<li class=""><strong><a class="" href="/docs/core-concepts/resilience/error-handling-guide">Error Handling Overview</a></strong>: Return to the error handling overview.</li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/core-concepts/resilience/troubleshooting"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Troubleshooting</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/core-concepts/resilience/circuit-breaker-configuration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Circuit Breaker Configuration</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#pipelineretryoptions" class="table-of-contents__link toc-highlight">PipelineRetryOptions</a></li><li><a href="#basic-retry-configuration" class="table-of-contents__link toc-highlight">Basic Retry Configuration</a><ul><li><a href="#global-retry-options" class="table-of-contents__link toc-highlight">Global Retry Options</a></li><li><a href="#per-node-retry-options" class="table-of-contents__link toc-highlight">Per-Node Retry Options</a></li></ul></li><li><a href="#integrating-external-retry-libraries" class="table-of-contents__link toc-highlight">Integrating External Retry Libraries</a></li><li><a href="#retry-strategies" class="table-of-contents__link toc-highlight">Retry Strategies</a><ul><li><a href="#fixed-delay-retry" class="table-of-contents__link toc-highlight">Fixed Delay Retry</a></li><li><a href="#exponential-backoff-with-jitter" class="table-of-contents__link toc-highlight">Exponential Backoff with Jitter</a></li></ul></li><li><a href="#context-aware-retry" class="table-of-contents__link toc-highlight">Context-Aware Retry</a></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a></li><li><a href="#production-example" class="table-of-contents__link toc-highlight">Production Example</a></li><li><a href="#see-also" class="table-of-contents__link toc-highlight">See Also</a></li><li><a href="#related-topics" class="table-of-contents__link toc-highlight">Related Topics</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/why-npipeline">Why NPipeline?</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/installation">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/quick-start">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/core-concepts">Core Concepts</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/npipeline/npipeline" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">&nbsp;</div></div></div></footer></div>
</body>
</html>