<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-core-concepts/nodes/join" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Join Nodes | NPipeline</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="robots" content="noindex, nofollow"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://npipeline.dev/docs/core-concepts/nodes/join"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Join Nodes | NPipeline"><meta data-rh="true" name="description" content="Merge data from multiple input streams based on common keys or time windows using NPipeline&#x27;s Join Nodes."><meta data-rh="true" property="og:description" content="Merge data from multiple input streams based on common keys or time windows using NPipeline&#x27;s Join Nodes."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://npipeline.dev/docs/core-concepts/nodes/join"><link data-rh="true" rel="alternate" href="https://npipeline.dev/docs/core-concepts/nodes/join" hreflang="en"><link data-rh="true" rel="alternate" href="https://npipeline.dev/docs/core-concepts/nodes/join" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Core Concepts","item":"https://npipeline.dev/docs/core-concepts"},{"@type":"ListItem","position":2,"name":"Nodes","item":"https://npipeline.dev/docs/core-concepts/nodes/"},{"@type":"ListItem","position":3,"name":"Join Nodes","item":"https://npipeline.dev/docs/core-concepts/nodes/join"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="NPipeline RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="NPipeline Atom Feed"><link rel="stylesheet" href="/assets/css/styles.4bb8ba71.css">
<script src="/assets/js/runtime~main.207e1d5b.js" defer="defer"></script>
<script src="/assets/js/main.f8b38daa.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="NPipeline logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="NPipeline logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">NPipeline</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/npipeline/npipeline" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/"><span title="Welcome to NPipeline" class="linkLabel_WmDU">Welcome to NPipeline</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/getting-started"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/docs/core-concepts"><span title="Core Concepts" class="categoryLinkLabel_W154">Core Concepts</span></a><button aria-label="Collapse sidebar category &#x27;Core Concepts&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/grouping-strategies"><span title="Grouping Strategies - Batching vs Aggregation" class="linkLabel_WmDU">Grouping Strategies - Batching vs Aggregation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/ipipeline"><span title="Pipeline" class="linkLabel_WmDU">Pipeline</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/data-pipes"><span title="Data Pipes (IDataPipe)" class="linkLabel_WmDU">Data Pipes (IDataPipe)</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/core-concepts/nodes/"><span title="Nodes" class="categoryLinkLabel_W154">Nodes</span></a><button aria-label="Collapse sidebar category &#x27;Nodes&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/nodes/source-nodes"><span title="Source Nodes" class="linkLabel_WmDU">Source Nodes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/nodes/batching"><span title="Batching Nodes" class="linkLabel_WmDU">Batching Nodes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/nodes/transform-nodes"><span title="Transform Nodes" class="linkLabel_WmDU">Transform Nodes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/core-concepts/nodes/join"><span title="Join Nodes" class="linkLabel_WmDU">Join Nodes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/nodes/sink-nodes"><span title="Sink Nodes" class="linkLabel_WmDU">Sink Nodes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/nodes/lookup"><span title="Lookup Nodes" class="linkLabel_WmDU">Lookup Nodes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/nodes/branch"><span title="Branch Nodes" class="linkLabel_WmDU">Branch Nodes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/nodes/tap"><span title="Tap Nodes" class="linkLabel_WmDU">Tap Nodes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/nodes/aggregation"><span title="Aggregation Nodes" class="linkLabel_WmDU">Aggregation Nodes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/nodes/time-windowed-join"><span title="Time-Windowed Joins" class="linkLabel_WmDU">Time-Windowed Joins</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/core-concepts/resilience/"><span title="Resilience" class="categoryLinkLabel_W154">Resilience</span></a><button aria-label="Expand sidebar category &#x27;Resilience&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/defining-pipelines"><span title="Defining Pipelines" class="linkLabel_WmDU">Defining Pipelines</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/pipeline-definition"><span title="Pipeline Definition (IPipelineDefinition, PipelineBuilder)" class="linkLabel_WmDU">Pipeline Definition (IPipelineDefinition, PipelineBuilder)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/pipelinebuilder"><span title="PipelineBuilder" class="linkLabel_WmDU">PipelineBuilder</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/node-definition"><span title="Node Definition Structure" class="linkLabel_WmDU">Node Definition Structure</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/core-concepts/pipeline-execution"><span title="Pipeline Execution" class="categoryLinkLabel_W154">Pipeline Execution</span></a><button aria-label="Expand sidebar category &#x27;Pipeline Execution&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/lambda-nodes"><span title="Lambda-Based Node Syntax" class="linkLabel_WmDU">Lambda-Based Node Syntax</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/pipeline-context"><span title="Pipeline Context (PipelineContext)" class="linkLabel_WmDU">Pipeline Context (PipelineContext)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/common-patterns"><span title="Common Patterns" class="linkLabel_WmDU">Common Patterns</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/streaming-vs-buffering"><span title="Streaming vs. Buffering" class="linkLabel_WmDU">Streaming vs. Buffering</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/best-practices"><span title="Best Practices" class="linkLabel_WmDU">Best Practices</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/pipeline-validation"><span title="Pipeline Validation Extensions - Usage Guide" class="linkLabel_WmDU">Pipeline Validation Extensions - Usage Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-concepts/thread-safety"><span title="Thread Safety Guidelines" class="linkLabel_WmDU">Thread Safety Guidelines</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/architecture/"><span title="Architecture" class="categoryLinkLabel_W154">Architecture</span></a><button aria-label="Collapse sidebar category &#x27;Architecture&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/architectural-foundations"><span title="Architectural Foundations" class="linkLabel_WmDU">Architectural Foundations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/component-architecture"><span title="Component Architecture" class="linkLabel_WmDU">Component Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/execution-flow"><span title="Execution Flow" class="linkLabel_WmDU">Execution Flow</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/data-flow"><span title="Data Flow Details" class="linkLabel_WmDU">Data Flow Details</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/dependency-injection"><span title="Dependency Injection Integration" class="linkLabel_WmDU">Dependency Injection Integration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/node-instantiation"><span title="Node Instantiation" class="linkLabel_WmDU">Node Instantiation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/error-handling-architecture"><span title="Error Handling Architecture" class="linkLabel_WmDU">Error Handling Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/cancellation-model"><span title="Cancellation Model" class="linkLabel_WmDU">Cancellation Model</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/performance-characteristics"><span title="Performance Characteristics" class="linkLabel_WmDU">Performance Characteristics</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/retry-delay-architecture"><span title="Retry Delay Strategies Architecture" class="linkLabel_WmDU">Retry Delay Strategies Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/extension-points"><span title="Extension Points" class="linkLabel_WmDU">Extension Points</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/design-principles"><span title="Design Principles" class="linkLabel_WmDU">Design Principles</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/optimization-principles"><span title="Optimization Principles - How NPipeline Achieves High Performance" class="linkLabel_WmDU">Optimization Principles - How NPipeline Achieves High Performance</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/execution-plan-caching"><span title="Execution Plan Caching" class="linkLabel_WmDU">Execution Plan Caching</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/extensions"><span title="Extensions" class="categoryLinkLabel_W154">Extensions</span></a><button aria-label="Expand sidebar category &#x27;Extensions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/connectors"><span title="Connectors" class="categoryLinkLabel_W154">Connectors</span></a><button aria-label="Expand sidebar category &#x27;Connectors&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/advanced-topics"><span title="Advanced Topics" class="categoryLinkLabel_W154">Advanced Topics</span></a><button aria-label="Expand sidebar category &#x27;Advanced Topics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/analyzers/"><span title="Build-Time Analyzers" class="categoryLinkLabel_W154">Build-Time Analyzers</span></a><button aria-label="Expand sidebar category &#x27;Build-Time Analyzers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/samples/"><span title="Samples" class="categoryLinkLabel_W154">Samples</span></a><button aria-label="Expand sidebar category &#x27;Samples&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/reference"><span title="Reference" class="categoryLinkLabel_W154">Reference</span></a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/core-concepts"><span>Core Concepts</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/core-concepts/nodes/"><span>Nodes</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Join Nodes</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Join Nodes</h1></header>
<p>Join nodes in NPipeline allow you to combine data from two or more independent input streams into a single output stream. This is a common operation in data processing, enabling the enrichment of data or the correlation of related events.</p>
<p>NPipeline offers different types of join nodes to cater to various joining strategies, including keyed joins and time-windowed joins.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="ijoinnode"><code>IJoinNode</code><a href="#ijoinnode" class="hash-link" aria-label="Direct link to ijoinnode" title="Direct link to ijoinnode" translate="no">​</a></h2>
<p>The <a class="" href="/docs/core-concepts/nodes/src/NPipeline/Interfaces/IJoinNode.cs"><code>IJoinNode</code></a> interface represents the contract for any node that performs a join operation. Implementations will typically take multiple input streams and produce a single output stream containing the combined data.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="keyed-join-nodes">Keyed Join Nodes<a href="#keyed-join-nodes" class="hash-link" aria-label="Direct link to Keyed Join Nodes" title="Direct link to Keyed Join Nodes" translate="no">​</a></h2>
<p>Keyed join nodes merge items from different streams based on a common key. When an item arrives on any input stream, it is matched with existing items from other streams that share the same key.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="keyedjoinnodetkey-tin1-tin2-tout"><code>KeyedJoinNode&lt;TKey, TIn1, TIn2, TOut&gt;</code><a href="#keyedjoinnodetkey-tin1-tin2-tout" class="hash-link" aria-label="Direct link to keyedjoinnodetkey-tin1-tin2-tout" title="Direct link to keyedjoinnodetkey-tin1-tin2-tout" translate="no">​</a></h3>
<p>This node performs a join based on a key selector and extends the <a class="" href="/docs/core-concepts/nodes/src/NPipeline/Nodes/Join/BaseJoinNode.cs"><code>BaseJoinNode&lt;TKey, TIn1, TIn2, TOut&gt;</code></a> abstract base class, which provides common functionality for processing two input streams. You need to define how to extract the key from the left and right input items.</p>
<ul>
<li class=""><code>TKey</code>: The type of the join key.</li>
<li class=""><code>TIn1</code>: The type of items from the first input stream.</li>
<li class=""><code>TIn2</code>: The type of items from the second input stream.</li>
<li class=""><code>TOut</code>: The type of the combined output item.</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="required-method-overrides">Required Method Overrides<a href="#required-method-overrides" class="hash-link" aria-label="Direct link to Required Method Overrides" title="Direct link to Required Method Overrides" translate="no">​</a></h4>
<p>To implement a custom keyed join, you must override the following methods:</p>
<ol>
<li class="">
<p><strong><code>CreateOutput(TLeft leftItem, TRight rightItem)</code></strong>: Creates the output item when a match is found between left and right items.</p>
<ul>
<li class=""><strong>Purpose</strong>: Defines how to combine matching items from both streams into a single output item.</li>
<li class=""><strong>Called when</strong>: A matching pair of items (one from each stream with the same key) is found.</li>
<li class=""><strong>Returns</strong>: The combined output item.</li>
</ul>
</li>
<li class="">
<p><strong><code>CreateOutputFromLeft(TLeft leftItem)</code></strong> (Optional override): Creates an output item when there&#x27;s no matching right item.</p>
<ul>
<li class=""><strong>Purpose</strong>: Handles unmatched items from the left stream in left outer and full outer joins.</li>
<li class=""><strong>Called when</strong>: The stream ends and there are still unmatched left items.</li>
<li class=""><strong>Default behavior</strong>: Attempts to automatically project the left item to the output type, but may throw <code>NotSupportedException</code> if unable to do so.</li>
<li class=""><strong>Returns</strong>: An output item based solely on the left item.</li>
</ul>
</li>
<li class="">
<p><strong><code>CreateOutputFromRight(TRight rightItem)</code></strong> (Optional override): Creates an output item when there&#x27;s no matching left item.</p>
<ul>
<li class=""><strong>Purpose</strong>: Handles unmatched items from the right stream in right outer and full outer joins.</li>
<li class=""><strong>Called when</strong>: The stream ends and there are still unmatched right items.</li>
<li class=""><strong>Default behavior</strong>: Attempts to automatically project the right item to the output type, but may throw <code>NotSupportedException</code> if unable to do so.</li>
<li class=""><strong>Returns</strong>: An output item based solely on the right item.</li>
</ul>
</li>
</ol>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="key-selection">Key Selection<a href="#key-selection" class="hash-link" aria-label="Direct link to Key Selection" title="Direct link to Key Selection" translate="no">​</a></h4>
<p>Key extraction for the join can be defined in two ways:</p>
<ol>
<li class="">
<p><strong>Using KeySelectorAttribute</strong> (Recommended): Apply the <a class="" href="/docs/core-concepts/nodes/src/NPipeline/Attributes/Nodes/KeySelectorAttribute.cs"><code>KeySelectorAttribute</code></a> to your join class to specify which properties to use as keys for each input type.</p>
</li>
<li class="">
<p><strong>Custom key extraction</strong>: For more complex key extraction logic, you can override the key selection process.</p>
</li>
</ol>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="join-types">Join Types<a href="#join-types" class="hash-link" aria-label="Direct link to Join Types" title="Direct link to Join Types" translate="no">​</a></h4>
<p>The <a class="" href="/docs/core-concepts/nodes/src/NPipeline/Nodes/Join/JoinType.cs"><code>JoinType</code></a> property controls how unmatched items are handled:</p>
<ul>
<li class=""><code>Inner</code>: Only produces output when there&#x27;s a match in both streams (default).</li>
<li class=""><code>LeftOuter</code>: Produces all left items, with matching right items when available.</li>
<li class=""><code>RightOuter</code>: Produces all right items, with matching left items when available.</li>
<li class=""><code>FullOuter</code>: Produces all items from both streams, matching when possible.</li>
</ul>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="inner-join">Inner Join<a href="#inner-join" class="hash-link" aria-label="Direct link to Inner Join" title="Direct link to Inner Join" translate="no">​</a></h5>
<!-- -->
<p><em>Figure: Inner join produces output only when there&#x27;s a match in both streams.</em></p>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="left-outer-join">Left Outer Join<a href="#left-outer-join" class="hash-link" aria-label="Direct link to Left Outer Join" title="Direct link to Left Outer Join" translate="no">​</a></h5>
<!-- -->
<p><em>Figure: Left outer join produces all left items, with matching right items when available.</em></p>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="right-outer-join">Right Outer Join<a href="#right-outer-join" class="hash-link" aria-label="Direct link to Right Outer Join" title="Direct link to Right Outer Join" translate="no">​</a></h5>
<!-- -->
<p><em>Figure: Right outer join produces all right items, with matching left items when available.</em></p>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="full-outer-join">Full Outer Join<a href="#full-outer-join" class="hash-link" aria-label="Direct link to Full Outer Join" title="Direct link to Full Outer Join" translate="no">​</a></h5>
<!-- -->
<p><em>Figure: Full outer join produces all items from both streams, matching when possible.</em></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="example-joining-orders-with-customer-data">Example: Joining Orders with Customer Data<a href="#example-joining-orders-with-customer-data" class="hash-link" aria-label="Direct link to Example: Joining Orders with Customer Data" title="Direct link to Example: Joining Orders with Customer Data" translate="no">​</a></h3>
<p>Let&#x27;s imagine we have a stream of <code>Order</code> items and a separate stream of <code>Customer</code> items. We want to enrich the <code>Order</code> with <code>Customer</code> details.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline.Nodes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Define input data structures</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record Order(int OrderId, int CustomerId, decimal Amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record Customer(int CustomerId, string Name, string Email);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record EnrichedOrder(int OrderId, int CustomerId, string CustomerName, decimal Amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Define the join node with KeySelectorAttributes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[KeySelector(typeof(Order), nameof(Order.CustomerId))]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[KeySelector(typeof(Customer), nameof(Customer.CustomerId))]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed class CustomerOrderJoinNode : KeyedJoinNode&lt;int, Order, Customer, EnrichedOrder&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Required: Combine matching items</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected override EnrichedOrder CreateOutput(Order leftItem, Customer rightItem)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new EnrichedOrder(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.OrderId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.CustomerId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightItem.Name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.Amount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Optional: Handle unmatched orders (for left outer or full outer joins)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected override EnrichedOrder CreateOutputFromLeft(Order leftItem)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Create an enriched order with placeholder customer data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new EnrichedOrder(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.OrderId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.CustomerId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Unknown Customer&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.Amount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Optional: Handle unmatched customers (for right outer or full outer joins)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected override EnrichedOrder CreateOutputFromRight(Customer rightItem)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Create a placeholder order with just the customer information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new EnrichedOrder(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            0, // No OrderId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightItem.CustomerId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightItem.Name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            0m // No amount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static class Program</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static async Task Main(string[] args)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var orderSource = new InMemorySourceNode&lt;Order&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new Order(101, 1, 100.00m),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new Order(102, 2, 250.00m),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new Order(103, 1, 50.00m),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new Order(104, 3, 75.00m) // This customer doesn&#x27;t exist in our data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var customerSource = new InMemorySourceNode&lt;Customer&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new Customer(1, &quot;Alice&quot;, &quot;alice@example.com&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new Customer(2, &quot;Bob&quot;, &quot;bob@example.com&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // Note: Customer 3 is missing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Example with inner join (default)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var innerJoinContext = PipelineContext.Default;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var innerJoinRunner = PipelineRunner.Create();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Console.WriteLine(&quot;Running inner join pipeline...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await innerJoinRunner.RunAsync&lt;InnerJoinPipelineDefinition&gt;(innerJoinContext);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Example with left outer join</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var leftOuterContext = PipelineContext.Default;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var leftOuterRunner = PipelineRunner.Create();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Console.WriteLine(&quot;\nRunning left outer join pipeline...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await leftOuterRunner.RunAsync&lt;LeftOuterJoinPipelineDefinition&gt;(leftOuterContext);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Example with full outer join</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var fullOuterContext = PipelineContext.Default;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var fullOuterRunner = PipelineRunner.Create();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Console.WriteLine(&quot;\nRunning full outer join pipeline...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await fullOuterRunner.RunAsync&lt;FullOuterJoinPipelineDefinition&gt;(fullOuterContext);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed class InnerJoinPipelineDefinition : IPipelineDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void Define(PipelineBuilder builder, PipelineContext context)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var orderSourceHandle = builder.AddSource&lt;InMemorySourceNode&lt;Order&gt;, Order&gt;(&quot;orderSource&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var customerSourceHandle = builder.AddSource&lt;InMemorySourceNode&lt;Customer&gt;, Customer&gt;(&quot;customerSource&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var joinHandle = builder.AddJoin&lt;CustomerOrderJoinNode, Order, Customer, EnrichedOrder&gt;(&quot;correlator&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var sinkHandle = builder.AddSink&lt;ConsoleSink&lt;EnrichedOrder&gt;, EnrichedOrder&gt;(&quot;sink&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(orderSourceHandle, joinHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(customerSourceHandle, joinHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(joinHandle, sinkHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed class LeftOuterJoinPipelineDefinition : IPipelineDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void Define(PipelineBuilder builder, PipelineContext context)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var orderSourceHandle = builder.AddSource&lt;InMemorySourceNode&lt;Order&gt;, Order&gt;(&quot;orderSource&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var customerSourceHandle = builder.AddSource&lt;InMemorySourceNode&lt;Customer&gt;, Customer&gt;(&quot;customerSource&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var joinHandle = builder.AddJoin&lt;CustomerOrderJoinNode, Order, Customer, EnrichedOrder&gt;(&quot;correlator&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var sinkHandle = builder.AddSink&lt;ConsoleSink&lt;EnrichedOrder&gt;, EnrichedOrder&gt;(&quot;sink&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(orderSourceHandle, joinHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(customerSourceHandle, joinHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(joinHandle, sinkHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed class FullOuterJoinPipelineDefinition : IPipelineDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void Define(PipelineBuilder builder, PipelineContext context)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var orderSourceHandle = builder.AddSource&lt;InMemorySourceNode&lt;Order&gt;, Order&gt;(&quot;orderSource&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var customerSourceHandle = builder.AddSource&lt;InMemorySourceNode&lt;Customer&gt;, Customer&gt;(&quot;customerSource&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var joinHandle = builder.AddJoin&lt;CustomerOrderJoinNode, Order, Customer, EnrichedOrder&gt;(&quot;correlator&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var sinkHandle = builder.AddSink&lt;ConsoleSink&lt;EnrichedOrder&gt;, EnrichedOrder&gt;(&quot;sink&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(orderSourceHandle, joinHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(customerSourceHandle, joinHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(joinHandle, sinkHandle);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Expected Output:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Running inner join pipeline...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sink received: EnrichedOrder { OrderId = 101, CustomerId = 1, CustomerName = &quot;Alice&quot;, Amount = 100.00 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sink received: EnrichedOrder { OrderId = 102, CustomerId = 2, CustomerName = &quot;Bob&quot;, Amount = 250.00 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sink received: EnrichedOrder { OrderId = 103, CustomerId = 1, CustomerName = &quot;Alice&quot;, Amount = 50.00 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running left outer join pipeline...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sink received: EnrichedOrder { OrderId = 101, CustomerId = 1, CustomerName = &quot;Alice&quot;, Amount = 100.00 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sink received: EnrichedOrder { OrderId = 102, CustomerId = 2, CustomerName = &quot;Bob&quot;, Amount = 250.00 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sink received: EnrichedOrder { OrderId = 103, CustomerId = 1, CustomerName = &quot;Alice&quot;, Amount = 50.00 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sink received: EnrichedOrder { OrderId = 104, CustomerId = 3, CustomerName = &quot;Unknown Customer&quot;, Amount = 75.00 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Running full outer join pipeline...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sink received: EnrichedOrder { OrderId = 101, CustomerId = 1, CustomerName = &quot;Alice&quot;, Amount = 100.00 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sink received: EnrichedOrder { OrderId = 102, CustomerId = 2, CustomerName = &quot;Bob&quot;, Amount = 250.00 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sink received: EnrichedOrder { OrderId = 103, CustomerId = 1, CustomerName = &quot;Alice&quot;, Amount = 50.00 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sink received: EnrichedOrder { OrderId = 104, CustomerId = 3, CustomerName = &quot;Unknown Customer&quot;, Amount = 75.00 }</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="example-composite-key-join">Example: Composite Key Join<a href="#example-composite-key-join" class="hash-link" aria-label="Direct link to Example: Composite Key Join" title="Direct link to Example: Composite Key Join" translate="no">​</a></h3>
<p>For more complex scenarios, you can use composite keys:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline.Nodes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Define input data structures with composite keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record OrderItem(int OrderId, string ProductCode, int Quantity, decimal Price);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record Product(string ProductCode, string Category, string Name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record EnrichedOrderItem(int OrderId, string ProductCode, string ProductName, string Category, int Quantity, decimal Price);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Define a composite key type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record OrderProductKey(int OrderId, string ProductCode);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Define the join node with composite key selectors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[KeySelector(typeof(OrderItem), nameof(OrderItem.OrderId), nameof(OrderItem.ProductCode))]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[KeySelector(typeof(Product), nameof(Product.ProductCode))]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed class OrderItemProductJoinNode : KeyedJoinNode&lt;(int, string), OrderItem, Product, EnrichedOrderItem&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected override EnrichedOrderItem CreateOutput(OrderItem leftItem, Product rightItem)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new EnrichedOrderItem(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.OrderId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.ProductCode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightItem.Name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightItem.Category,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.Quantity,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.Price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected override EnrichedOrderItem CreateOutputFromLeft(OrderItem leftItem)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Handle order items with unknown products</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new EnrichedOrderItem(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.OrderId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.ProductCode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Unknown Product&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Unknown Category&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.Quantity,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.Price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Alternative using ValueTuple for composite key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[KeySelector(typeof(OrderItem), nameof(OrderItem.OrderId), nameof(OrderItem.ProductCode))]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[KeySelector(typeof(Product), nameof(Product.ProductCode))]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed class OrderItemProductJoinNodeWithTuple : KeyedJoinNode&lt;(int OrderId, string ProductCode), OrderItem, Product, EnrichedOrderItem&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected override EnrichedOrderItem CreateOutput(OrderItem leftItem, Product rightItem)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new EnrichedOrderItem(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.OrderId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.ProductCode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightItem.Name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightItem.Category,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.Quantity,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.Price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="time-windowed-join-nodes">Time-Windowed Join Nodes<a href="#time-windowed-join-nodes" class="hash-link" aria-label="Direct link to Time-Windowed Join Nodes" title="Direct link to Time-Windowed Join Nodes" translate="no">​</a></h2>
<p>Time-windowed join nodes combine items from different streams that occur within a specified time window. This is common in real-time stream processing where events need to be correlated based on their temporal proximity.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="timewindowedjoinnodetleft-tright-tkey-toutput"><code>TimeWindowedJoinNode&lt;TLeft, TRight, TKey, TOutput&gt;</code><a href="#timewindowedjoinnodetleft-tright-tkey-toutput" class="hash-link" aria-label="Direct link to timewindowedjoinnodetleft-tright-tkey-toutput" title="Direct link to timewindowedjoinnodetleft-tright-tkey-toutput" translate="no">​</a></h3>
<p>This node extends <a class="" href="/docs/core-concepts/nodes/src/NPipeline/Nodes/Join/KeyedJoinNode.cs"><code>KeyedJoinNode</code></a> by adding a time window constraint. Items are considered for joining only if their timestamps fall within the defined window and their keys match.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="example-correlating-events-within-a-time-window">Example: Correlating Events within a Time Window<a href="#example-correlating-events-within-a-time-window" class="hash-link" aria-label="Direct link to Example: Correlating Events within a Time Window" title="Direct link to Example: Correlating Events within a Time Window" translate="no">​</a></h3>
<p>The repository includes time-windowed join support (see <code>TimeWindowedJoinNode</code> and windowing primitives such as <code>WindowAssigner</code>). Higher-level extension packages may provide convenience helpers in the future, but basic time-windowed join patterns are available in core today.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Assuming EventA and EventB have a Timestamp property and a common CorrelationId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record EventA(Guid CorrelationId, DateTime Timestamp, string DataA);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record EventB(Guid CorrelationId, DateTime Timestamp, string DataB);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record CorrelatedEvent(Guid CorrelationId, DateTime Timestamp, string DataA, string DataB);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed class EventCorrelationJoinNode : TimeWindowedJoinNode&lt;EventA, EventB, Guid, CorrelatedEvent&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public EventCorrelationJoinNode(TimeSpan windowSize) : base(windowSize) { }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected override Guid GetLeftKey(EventA leftItem) =&gt; leftItem.CorrelationId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected override DateTime GetLeftTimestamp(EventA leftItem) =&gt; leftItem.Timestamp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected override Guid GetRightKey(EventB rightItem) =&gt; rightItem.CorrelationId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected override DateTime GetRightTimestamp(EventB rightItem) =&gt; rightItem.Timestamp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected override CorrelatedEvent JoinItems(EventA leftItem, EventB rightItem)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new CorrelatedEvent(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.CorrelationId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.Timestamp, // or rightItem.Timestamp, depending on logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftItem.DataA,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightItem.DataB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Pipeline construction would involve adding sources and a join node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// var pipeline = new PipelineBuilder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//     .AddSource(new EventASource())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//     .AddSource(new EventBSource())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//     .Join(new EventCorrelationJoinNode(TimeSpan.FromSeconds(5))) // Join events within 5 seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//     .AddSink(new ConsoleSink&lt;CorrelatedEvent&gt;())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//     .Build();</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="self-join">Self-Join<a href="#self-join" class="hash-link" aria-label="Direct link to Self-Join" title="Direct link to Self-Join" translate="no">​</a></h2>
<p>Self-join enables joining two streams containing items of the same type from different sources. This is particularly useful when you need to correlate items of identical types but from distinct data sources, such as comparing orders from different regions, events from different time periods, or matching records from multiple databases.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-self-join-is-needed">Why Self-Join is Needed<a href="#why-self-join-is-needed" class="hash-link" aria-label="Direct link to Why Self-Join is Needed" title="Direct link to Why Self-Join is Needed" translate="no">​</a></h3>
<p>The standard <a class="" href="/docs/core-concepts/nodes/src/NPipeline/Nodes/Join/KeyedJoinNode.cs"><code>KeyedJoinNode&lt;TKey, TIn1, TIn2, TOut&gt;</code></a> uses runtime type checking (<code>item is TIn1</code>, <code>item is TIn2</code>) to distinguish between items from the left and right input streams. When <code>TIn1</code> and <code>TIn2</code> are the same type, this type checking fails because items from both streams are indistinguishable at runtime. This is known as the &quot;BaseJoinNode Secondary Input Type Erasure&quot; issue.</p>
<p>The <a class="" href="/docs/core-concepts/nodes/src/NPipeline/SelfJoinExtensions.cs"><code>AddSelfJoin</code></a> extension method solves this by internally wrapping items from each stream with distinct wrapper types (<a class="" href="/docs/core-concepts/nodes/src/NPipeline/Nodes/Internal/SelfJoinTransform.cs"><code>LeftWrapper&lt;T&gt;</code></a> and <a class="" href="/docs/core-concepts/nodes/src/NPipeline/Nodes/Internal/SelfJoinTransform.cs"><code>RightWrapper&lt;T&gt;</code></a>), allowing the join node to differentiate between items from the left and right streams even though they have the same underlying type. The join node unwraps items before applying your output factory, so you work with the original unwrapped items.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="when-to-use-self-join">When to Use Self-Join<a href="#when-to-use-self-join" class="hash-link" aria-label="Direct link to When to Use Self-Join" title="Direct link to When to Use Self-Join" translate="no">​</a></h3>
<p>Common use cases for self-joins include:</p>
<ul>
<li class=""><strong>Time-based comparisons</strong>: Comparing data from different time periods (e.g., year-over-year sales analysis)</li>
<li class=""><strong>Multi-source aggregation</strong>: Combining data from different regions, systems, or databases</li>
<li class=""><strong>Change detection</strong>: Identifying differences between current and historical data</li>
<li class=""><strong>Cross-reference validation</strong>: Validating data integrity across multiple sources</li>
<li class=""><strong>Pattern matching</strong>: Finding correlations in similar data streams</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="addselfjoin-extension-method"><code>AddSelfJoin</code> Extension Method<a href="#addselfjoin-extension-method" class="hash-link" aria-label="Direct link to addselfjoin-extension-method" title="Direct link to addselfjoin-extension-method" translate="no">​</a></h3>
<p>The <a class="" href="/docs/core-concepts/nodes/src/NPipeline/SelfJoinExtensions.cs"><code>AddSelfJoin</code></a> extension method provides a convenient way to add self-join nodes to your pipeline without manually creating wrapper types.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="method-signature">Method Signature<a href="#method-signature" class="hash-link" aria-label="Direct link to Method Signature" title="Direct link to Method Signature" translate="no">​</a></h4>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public static IOutputNodeHandle&lt;TOut&gt; AddSelfJoin&lt;TItem, TKey, TOut&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this PipelineBuilder builder,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IOutputNodeHandle&lt;TItem&gt; leftSource,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IOutputNodeHandle&lt;TItem&gt; rightSource,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string nodeName,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Func&lt;TItem, TItem, TOut&gt; outputFactory,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Func&lt;TItem, TKey&gt; leftKeySelector,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Func&lt;TItem, TKey&gt;? rightKeySelector = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JoinType joinType = JoinType.Inner,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Func&lt;TItem, TOut&gt;? leftFallback = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Func&lt;TItem, TOut&gt;? rightFallback = null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    where TKey : notnull</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="parameters">Parameters<a href="#parameters" class="hash-link" aria-label="Direct link to Parameters" title="Direct link to Parameters" translate="no">​</a></h4>
<ul>
<li class=""><strong><code>builder</code></strong>: The pipeline builder instance.</li>
<li class=""><strong><code>leftSource</code></strong>: Handle to the left source node.</li>
<li class=""><strong><code>rightSource</code></strong>: Handle to the right source node.</li>
<li class=""><strong><code>nodeName</code></strong>: Name for the join node.</li>
<li class=""><strong><code>outputFactory</code></strong>: Function that creates an output item from matched left and right items. Receives the original unwrapped items.</li>
<li class=""><strong><code>leftKeySelector</code></strong>: Function to extract the join key from left stream items.</li>
<li class=""><strong><code>rightKeySelector</code></strong>: Optional function to extract the join key from right stream items. If null, uses the same selector as the left stream.</li>
<li class=""><strong><code>joinType</code></strong>: Type of join to perform. Defaults to <code>JoinType.Inner</code>. Supports all join types: <code>Inner</code>, <code>LeftOuter</code>, <code>RightOuter</code>, <code>FullOuter</code>.</li>
<li class=""><strong><code>leftFallback</code></strong>: Optional function to create output from unmatched left items. Used for left outer and full outer joins.</li>
<li class=""><strong><code>rightFallback</code></strong>: Optional function to create output from unmatched right items. Used for right outer and full outer joins.</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="return-type">Return Type<a href="#return-type" class="hash-link" aria-label="Direct link to Return Type" title="Direct link to Return Type" translate="no">​</a></h4>
<p>Returns an <a class="" href="/docs/core-concepts/nodes/src/NPipeline/Graph/IOutputNodeHandle.cs"><code>IOutputNodeHandle&lt;TOut&gt;</code></a> to the newly added join node, which can be connected to downstream nodes.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="how-self-join-works">How Self-Join Works<a href="#how-self-join-works" class="hash-link" aria-label="Direct link to How Self-Join Works" title="Direct link to How Self-Join Works" translate="no">​</a></h4>
<!-- -->
<p><em>Figure: Self-join uses wrapper types to distinguish items from the left and right streams before joining.</em></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="example-1-simple-inner-join-with-same-key-selector">Example 1: Simple Inner Join with Same Key Selector<a href="#example-1-simple-inner-join-with-same-key-selector" class="hash-link" aria-label="Direct link to Example 1: Simple Inner Join with Same Key Selector" title="Direct link to Example 1: Simple Inner Join with Same Key Selector" translate="no">​</a></h3>
<p>Join orders from two different years by customer ID to analyze year-over-year growth:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline.Nodes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Define the order type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record Order(int OrderId, int CustomerId, decimal Amount, int Year);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Define the output type for year-over-year comparison</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record OrderComparison(int CustomerId, decimal Amount2024, decimal Amount2023, decimal Growth);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed class YearOverYearComparisonPipeline : IPipelineDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void Define(PipelineBuilder builder, PipelineContext context)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Orders from 2024</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var orders2024 = builder.AddInMemorySource(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new Order(1, 101, 1000.00m, 2024),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new Order(2, 102, 1500.00m, 2024),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new Order(3, 103, 2000.00m, 2024)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;orders_2024&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Orders from 2023</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var orders2023 = builder.AddInMemorySource(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new Order(4, 101, 800.00m, 2023),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new Order(5, 102, 1200.00m, 2023),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new Order(6, 104, 900.00m, 2023) // Customer 104 not in 2024</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;orders_2023&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Join orders from both years by customer ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var comparison = builder.AddSelfJoin(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftSource: orders2024,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightSource: orders2023,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            nodeName: &quot;yoy_comparison&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            outputFactory: (order2024, order2023) =&gt; new OrderComparison(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                order2024.CustomerId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                order2024.Amount,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                order2023.Amount,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                order2024.Amount - order2023.Amount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftKeySelector: order =&gt; order.CustomerId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightKeySelector: order =&gt; order.CustomerId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            joinType: JoinType.Inner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var sink = builder.AddSink&lt;ConsoleSink&lt;OrderComparison&gt;, OrderComparison&gt;(&quot;output&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(comparison, sink);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Expected Output:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">OrderComparison { CustomerId = 101, Amount2024 = 1000.00, Amount2023 = 800.00, Growth = 200.00 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OrderComparison { CustomerId = 102, Amount2024 = 1500.00, Amount2023 = 1200.00, Growth = 300.00 }</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="example-2-left-outer-join-with-fallback">Example 2: Left Outer Join with Fallback<a href="#example-2-left-outer-join-with-fallback" class="hash-link" aria-label="Direct link to Example 2: Left Outer Join with Fallback" title="Direct link to Example 2: Left Outer Join with Fallback" translate="no">​</a></h3>
<p>Compare product prices between two catalogs, including products that only exist in the primary catalog:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline.Nodes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Define the product type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record Product(string ProductCode, string Name, decimal Price);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Define the output type for price comparison</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record PriceComparison(string ProductCode, string Name, decimal PrimaryPrice, decimal? SecondaryPrice, decimal? Difference);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed class PriceComparisonPipeline : IPipelineDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void Define(PipelineBuilder builder, PipelineContext context)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Primary catalog products</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var primaryCatalog = builder.AddInMemorySource(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new Product(&quot;P001&quot;, &quot;Widget A&quot;, 10.00m),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new Product(&quot;P002&quot;, &quot;Widget B&quot;, 20.00m),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new Product(&quot;P003&quot;, &quot;Widget C&quot;, 30.00m)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;primary_catalog&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Secondary catalog products</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var secondaryCatalog = builder.AddInMemorySource(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new Product(&quot;P001&quot;, &quot;Widget A&quot;, 12.00m),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new Product(&quot;P002&quot;, &quot;Widget B&quot;, 18.00m),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new Product(&quot;P004&quot;, &quot;Widget D&quot;, 25.00m) // Not in primary catalog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;secondary_catalog&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Compare prices with left outer join to include all primary products</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var priceComparison = builder.AddSelfJoin(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftSource: primaryCatalog,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightSource: secondaryCatalog,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            nodeName: &quot;price_comparison&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            outputFactory: (primary, secondary) =&gt; new PriceComparison(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                primary.ProductCode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                primary.Name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                primary.Price,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                secondary.Price,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                secondary.Price - primary.Price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftKeySelector: product =&gt; product.ProductCode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightKeySelector: product =&gt; product.ProductCode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            joinType: JoinType.LeftOuter,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftFallback: primary =&gt; new PriceComparison(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                primary.ProductCode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                primary.Name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                primary.Price,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var sink = builder.AddSink&lt;ConsoleSink&lt;PriceComparison&gt;, PriceComparison&gt;(&quot;output&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(priceComparison, sink);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Expected Output:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PriceComparison { ProductCode = &quot;P001&quot;, Name = &quot;Widget A&quot;, PrimaryPrice = 10.00, SecondaryPrice = 12.00, Difference = 2.00 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PriceComparison { ProductCode = &quot;P002&quot;, Name = &quot;Widget B&quot;, PrimaryPrice = 20.00, SecondaryPrice = 18.00, Difference = -2.00 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PriceComparison { ProductCode = &quot;P003&quot;, Name = &quot;Widget C&quot;, PrimaryPrice = 30.00, SecondaryPrice = null, Difference = null }</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="example-3-different-key-selectors">Example 3: Different Key Selectors<a href="#example-3-different-key-selectors" class="hash-link" aria-label="Direct link to Example 3: Different Key Selectors" title="Direct link to Example 3: Different Key Selectors" translate="no">​</a></h3>
<p>Match events from different systems using different key properties:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline.Nodes;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Define the event type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record SystemEvent(string EventId, string CorrelationId, DateTime Timestamp, string System, string Data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Define the output type for event correlation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed record CorrelatedEvents(string CorrelationId, DateTime Timestamp, string SystemAData, string SystemBData, TimeSpan TimeDifference);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public sealed class EventCorrelationPipeline : IPipelineDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void Define(PipelineBuilder builder, PipelineContext context)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Events from System A (using EventId as key)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var systemAEvents = builder.AddInMemorySource(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new SystemEvent(&quot;E001&quot;, &quot;CORR-001&quot;, DateTime.Parse(&quot;2024-01-01T10:00:00Z&quot;), &quot;SystemA&quot;, &quot;Data from A&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new SystemEvent(&quot;E002&quot;, &quot;CORR-002&quot;, DateTime.Parse(&quot;2024-01-01T10:05:00Z&quot;), &quot;SystemA&quot;, &quot;More data from A&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;system_a_events&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Events from System B (using CorrelationId as key)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var systemBEvents = builder.AddInMemorySource(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new SystemEvent(&quot;E101&quot;, &quot;CORR-001&quot;, DateTime.Parse(&quot;2024-01-01T10:00:05Z&quot;), &quot;SystemB&quot;, &quot;Data from B&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new SystemEvent(&quot;E102&quot;, &quot;CORR-003&quot;, DateTime.Parse(&quot;2024-01-01T10:10:00Z&quot;), &quot;SystemB&quot;, &quot;Unmatched data&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;system_b_events&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Correlate events using different key selectors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var correlatedEvents = builder.AddSelfJoin(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftSource: systemAEvents,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightSource: systemBEvents,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            nodeName: &quot;event_correlation&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            outputFactory: (eventA, eventB) =&gt; new CorrelatedEvents(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                eventA.CorrelationId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                eventA.Timestamp,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                eventA.Data,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                eventB.Data,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                eventB.Timestamp - eventA.Timestamp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            leftKeySelector: evt =&gt; evt.EventId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rightKeySelector: evt =&gt; evt.CorrelationId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            joinType: JoinType.Inner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var sink = builder.AddSink&lt;ConsoleSink&lt;CorrelatedEvents&gt;, CorrelatedEvents&gt;(&quot;output&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        builder.Connect(correlatedEvents, sink);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Expected Output:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CorrelatedEvents { CorrelationId = &quot;CORR-001&quot;, Timestamp = 2024-01-01T10:00:00Z, SystemAData = &quot;Data from A&quot;, SystemBData = &quot;Data from B&quot;, TimeDifference = 00:00:05 }</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="when-to-use-self-join-vs-regular-join">When to Use Self-Join vs Regular Join<a href="#when-to-use-self-join-vs-regular-join" class="hash-link" aria-label="Direct link to When to Use Self-Join vs Regular Join" title="Direct link to When to Use Self-Join vs Regular Join" translate="no">​</a></h4>
<ul>
<li class=""><strong>Use Self-Join</strong> when both input streams contain items of the same type but from different sources. This is the only way to correctly join same-type items due to the type erasure issue.</li>
<li class=""><strong>Use Regular Join</strong> (<a class="" href="/docs/core-concepts/nodes/src/NPipeline/Nodes/Join/KeyedJoinNode.cs"><code>KeyedJoinNode</code></a>) when joining items of different types, such as joining <code>Order</code> with <code>Customer</code> or <code>Product</code> with <code>Category</code>.</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="performance-considerations">Performance Considerations<a href="#performance-considerations" class="hash-link" aria-label="Direct link to Performance Considerations" title="Direct link to Performance Considerations" translate="no">​</a></h4>
<ul>
<li class=""><strong>Memory Usage</strong>: Like all keyed joins, self-joins maintain waiting lists for unmatched items. For unbalanced streams, consider using time-windowed joins or implementing capacity limits to prevent unbounded memory growth.</li>
<li class=""><strong>Key Selector Complexity</strong>: Keep key selectors simple and efficient, as they are called for every item. Avoid complex computations or I/O operations in key selectors.</li>
<li class=""><strong>Multiple Matches</strong>: If multiple items in both streams share the same key, the join produces all possible combinations (Cartesian product for that key). Be aware of this behavior when designing your data model.</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="common-pitfalls">Common Pitfalls<a href="#common-pitfalls" class="hash-link" aria-label="Direct link to Common Pitfalls" title="Direct link to Common Pitfalls" translate="no">​</a></h4>
<ul>
<li class=""><strong>Forgetting Fallback Functions</strong>: When using outer joins (<code>LeftOuter</code>, <code>RightOuter</code>, <code>FullOuter</code>), always provide appropriate fallback functions to handle unmatched items. Without fallbacks, the join may throw exceptions or produce unexpected results.</li>
<li class=""><strong>Key Selector Mismatch</strong>: Ensure that key selectors return compatible types. If using different key selectors, verify that the keys can be correctly compared and matched.</li>
<li class=""><strong>Null Key Handling</strong>: The key type <code>TKey</code> is constrained to be non-null (<code>where TKey : notnull</code>). Ensure your key selectors never return null values, as this will cause runtime exceptions.</li>
<li class=""><strong>Stream Ordering</strong>: Self-joins process items as they arrive. If ordering matters for your use case, ensure streams are properly ordered before the join or implement additional logic to handle ordering requirements.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="key-configuration-with-keyselectorattribute">Key Configuration with <a class="" href="/docs/core-concepts/nodes/src/NPipeline/Attributes/Nodes/KeySelectorAttribute.cs"><code>KeySelectorAttribute</code></a><a href="#key-configuration-with-keyselectorattribute" class="hash-link" aria-label="Direct link to key-configuration-with-keyselectorattribute" title="Direct link to key-configuration-with-keyselectorattribute" translate="no">​</a></h2>
<p>Some join nodes may utilize the <code>KeySelectorAttribute</code> to automatically infer key extraction logic based on property names or custom functions. This provides a declarative way to specify join keys.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="delegate-types">Delegate Types<a href="#delegate-types" class="hash-link" aria-label="Direct link to Delegate Types" title="Direct link to Delegate Types" translate="no">​</a></h2>
<p>Join operations use the following delegate types located in the <code>NPipeline.Graph.PipelineDelegates</code> namespace:</p>
<ul>
<li class=""><code>CustomMergeDelegate</code>: For custom merge logic in join nodes</li>
<li class=""><code>JoinKeySelectorDelegate</code>: For extracting join keys</li>
</ul>
<p>When using these delegates, ensure you import the correct namespace:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using NPipeline.Graph.PipelineDelegates;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Use the delegates in your join implementation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CustomMergeDelegate? myCustomMerge = (node, dataPipes, cancellationToken) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Custom merge implementation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return mergedDataPipe;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="next-steps">Next Steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next Steps" title="Direct link to Next Steps" translate="no">​</a></h2>
<ul>
<li class=""><strong><a class="" href="/docs/core-concepts/nodes/lookup">Lookup Nodes</a></strong>: Discover how to enrich data by querying external sources.</li>
<li class=""><strong><a class="" href="/docs/core-concepts/nodes/branch">Branch Nodes</a></strong>: Learn about duplicating data streams to multiple downstream paths.</li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/core-concepts/nodes/transform-nodes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Transform Nodes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/core-concepts/nodes/sink-nodes"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Sink Nodes</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ijoinnode" class="table-of-contents__link toc-highlight"><code>IJoinNode</code></a></li><li><a href="#keyed-join-nodes" class="table-of-contents__link toc-highlight">Keyed Join Nodes</a><ul><li><a href="#keyedjoinnodetkey-tin1-tin2-tout" class="table-of-contents__link toc-highlight"><code>KeyedJoinNode&lt;TKey, TIn1, TIn2, TOut&gt;</code></a></li><li><a href="#example-joining-orders-with-customer-data" class="table-of-contents__link toc-highlight">Example: Joining Orders with Customer Data</a></li><li><a href="#example-composite-key-join" class="table-of-contents__link toc-highlight">Example: Composite Key Join</a></li></ul></li><li><a href="#time-windowed-join-nodes" class="table-of-contents__link toc-highlight">Time-Windowed Join Nodes</a><ul><li><a href="#timewindowedjoinnodetleft-tright-tkey-toutput" class="table-of-contents__link toc-highlight"><code>TimeWindowedJoinNode&lt;TLeft, TRight, TKey, TOutput&gt;</code></a></li><li><a href="#example-correlating-events-within-a-time-window" class="table-of-contents__link toc-highlight">Example: Correlating Events within a Time Window</a></li></ul></li><li><a href="#self-join" class="table-of-contents__link toc-highlight">Self-Join</a><ul><li><a href="#why-self-join-is-needed" class="table-of-contents__link toc-highlight">Why Self-Join is Needed</a></li><li><a href="#when-to-use-self-join" class="table-of-contents__link toc-highlight">When to Use Self-Join</a></li><li><a href="#addselfjoin-extension-method" class="table-of-contents__link toc-highlight"><code>AddSelfJoin</code> Extension Method</a></li><li><a href="#example-1-simple-inner-join-with-same-key-selector" class="table-of-contents__link toc-highlight">Example 1: Simple Inner Join with Same Key Selector</a></li><li><a href="#example-2-left-outer-join-with-fallback" class="table-of-contents__link toc-highlight">Example 2: Left Outer Join with Fallback</a></li><li><a href="#example-3-different-key-selectors" class="table-of-contents__link toc-highlight">Example 3: Different Key Selectors</a></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a></li></ul></li><li><a href="#key-configuration-with-keyselectorattribute" class="table-of-contents__link toc-highlight">Key Configuration with <code>KeySelectorAttribute</code></a></li><li><a href="#delegate-types" class="table-of-contents__link toc-highlight">Delegate Types</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/why-npipeline">Why NPipeline?</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/installation">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/quick-start">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/core-concepts">Core Concepts</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/npipeline/npipeline" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">&nbsp;</div></div></div></footer></div>
</body>
</html>